// Given a group title and scaling factor, adds a new group to the dataset
function addGroup(t,e){var n=Object.assign({},syllabus);for(var i in n.x=t,categories)n[categories[i]]*=e;theData.push(n),groups.push(t)}function removeGroup(){theData.pop(),groups.pop()}
// Update attributes
function updateComponent(t,e,n){
// adjust the text on the range slider
d3.select(".hyp"+t+" #"+e+"-value").text(makeValueText(e,n)),d3.select(".hyp"+t+" #"+e).property("value",n),theData[t][e]=n,chart.load({json:theData,keys:{value:categories}})}
// return the key/value pairs for everything except the group name
function groupData(t){return d3.entries(theData[0]).filter(function(t){return"x"!==t.key})}function makeValueText(t,e){return Math.round(100*e/theData[0][t])+"%"}
// makes HTML of an individual slider
function makeSlide(t,e){return'<label for="'+t+'" > '+t+': <span id="'+t+'-value">â€¦</span></label> <input type="range" min="0" max="'+e+'" step="0.1" id="'+t+'">'}function addSliders(e){newGroup=d3.select("#sliders").append("div").attr("class","sliderGroup group-"+e),newGroup.append("div").attr("class","sliderGroup-title").text("Hypothetical "+e),newGroup.selectAll(".hyp"+e).data(groupData(0)).enter().append("div").attr("class","hyp"+e).html(function(t){return makeSlide(t.key,t.value)}),
// read a change in the input
categories.forEach(function(t){d3.select(".hyp"+e+" #"+t).on("input",function(){updateComponent(e,t,+this.value)})})}function removeSliders(t){d3.select("#sliders").selectAll(".group-"+t).remove()}function getCompName(t){return t.selectAll("input").attr("id")}!function(){function s(t){return t&&(t.ownerDocument||t.document||t).documentElement}function R(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}function o(t,e){return t<e?-1:e<t?1:e<=t?0:NaN}function c(t){return null===t?NaN:+t}function l(t){return!isNaN(t)}function t(a){return{left:function(t,e,n,i){for(arguments.length<3&&(n=0),arguments.length<4&&(i=t.length);n<i;){var r=n+i>>>1;a(t[r],e)<0?n=r+1:i=r}return n},right:function(t,e,n,i){for(arguments.length<3&&(n=0),arguments.length<4&&(i=t.length);n<i;){var r=n+i>>>1;0<a(t[r],e)?i=r:n=r+1}return n}}}function u(t){return t.length}function h(t){for(var e=1;t*e%1;)e*=10;return e}function e(t,e){for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}function v(){this._=Object.create(null)}function n(t){return(t+="")===yo||t[0]===mo?mo+t:t}function i(t){return(t+="")[0]===mo?t.slice(1):t}function r(t){return n(t)in this._}function a(t){return(t=n(t))in this._&&delete this._[t]}function d(){var t=[];for(var e in this._)t.push(i(e));return t}function f(){var t=0;for(var e in this._)++t;return t}function g(){for(var t in this._)return!1;return!0}function p(){this._=Object.create(null)}function O(t){return t}function x(e,n,i){return function(){var t=i.apply(n,arguments);return t===n?e:t}}function _(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.slice(1);for(var n=0,i=wo.length;n<i;++n){var r=wo[n]+e;if(r in t)return r}}function m(){}function y(){}function w(r){function t(){for(var t=a,e=-1,n=t.length,i;++e<n;)(i=t[e].on)&&i.apply(this,arguments);return r}var a=[],o=new v;return t.on=function(t,e){var n=o.get(t),i;return arguments.length<2?n&&n.on:(n&&(n.on=null,a=a.slice(0,i=a.indexOf(n)).concat(a.slice(i+1)),o.remove(t)),e&&a.push(o.set(t,{on:e})),r)},t}function I(){so.event.preventDefault()}function S(){for(var t=so.event,e;e=t.sourceEvent;)t=e;return t}function D(r){for(var a=new y,t=0,e=arguments.length;++t<e;)a[arguments[t]]=w(a);return a.of=function(n,i){return function(t){try{var e=t.sourceEvent=so.event;t.target=r,so.event=t,a[t.type].apply(n,i)}finally{so.event=e}}},a}function b(t){return bo(t,Co),t}function A(t){return"function"==typeof t?t:function(){return Ao(t,this)}}function T(t){return"function"==typeof t?t:function(){return To(t,this)}}function P(e,n){function t(){this.removeAttribute(e)}function i(){this.removeAttributeNS(e.space,e.local)}function r(){this.setAttribute(e,n)}function a(){this.setAttributeNS(e.space,e.local,n)}function o(){var t=n.apply(this,arguments);null==t?this.removeAttribute(e):this.setAttribute(e,t)}function s(){var t=n.apply(this,arguments);null==t?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}return e=so.ns.qualify(e),null==n?e.local?i:t:"function"==typeof n?e.local?s:o:e.local?a:r}function C(t){return t.trim().replace(/\s+/g," ")}function L(t){return new RegExp("(?:^|\\s+)"+so.requote(t)+"(?:\\s+|$)","g")}function M(t){return(t+"").trim().split(/^|\s+/)}function E(n,i){function t(){for(var t=-1;++t<r;)n[t](this,i)}function e(){for(var t=-1,e=i.apply(this,arguments);++t<r;)n[t](this,e)}var r=(n=M(n).map(V)).length;return"function"==typeof i?e:t}function V(i){var r=L(i);return function(t,e){if(n=t.classList)return e?n.add(i):n.remove(i);var n=t.getAttribute("class")||"";e?(r.lastIndex=0,r.test(n)||t.setAttribute("class",C(n+" "+i))):t.setAttribute("class",C(n.replace(r," ")))}}function G(e,n,i){function t(){this.style.removeProperty(e)}function r(){this.style.setProperty(e,n,i)}function a(){var t=n.apply(this,arguments);null==t?this.style.removeProperty(e):this.style.setProperty(e,t,i)}return null==n?t:"function"==typeof n?a:r}function k(e,n){function t(){delete this[e]}function i(){this[e]=n}function r(){var t=n.apply(this,arguments);null==t?delete this[e]:this[e]=t}return null==n?t:"function"==typeof n?r:i}function N(n){function t(){var t=this.ownerDocument,e=this.namespaceURI;return e===Lo&&t.documentElement.namespaceURI===Lo?t.createElement(n):t.createElementNS(e,n)}function e(){return this.ownerDocument.createElementNS(n.space,n.local)}return"function"==typeof n?n:(n=so.ns.qualify(n)).local?e:t}function F(){var t=this.parentNode;t&&t.removeChild(this)}function z(t){return{__data__:t}}function X(t){return function(){return Po(this,t)}}function H(n){return arguments.length||(n=o),function(t,e){return t&&e?n(t.__data__,e.__data__):!t-!e}}function Y(t,e){for(var n=0,i=t.length;n<i;n++)for(var r=t[n],a=0,o=r.length,s;a<o;a++)(s=r[a])&&e(s,a,n);return t}function B(t){return bo(t,Eo),t}function j(o){var s,u;return function(t,e,n){var i=o[n].update,r=i.length,a;for(n!=u&&(u=n,s=0),s<=e&&(s=e+1);!(a=i[s])&&++s<r;);return a}}function U(r,e,n){function i(){var t=this[o];t&&(this.removeEventListener(r,t,t.$),delete this[o])}function t(){var t=u(e,co(arguments));i.call(this),this.addEventListener(r,this[o]=t,t.$=n),t._=e}function a(){var t=new RegExp("^__on([^.]+)"+so.requote(r)+"$"),e;for(var n in this)if(e=n.match(t)){var i=this[n];this.removeEventListener(e[1],i,i.$),delete this[n]}}var o="__on"+r,s=r.indexOf("."),u=q;0<s&&(r=r.slice(0,s));var c=Vo.get(r);return c&&(r=c,u=W),s?e?t:i:e?m:a}function q(n,i){return function(t){var e=so.event;so.event=t,i[0]=this.__data__;try{n.apply(this,i)}finally{so.event=e}}}function W(t,e){var i=q(t,e);return function(t){var e=this,n=t.relatedTarget;n&&(n===e||8&n.compareDocumentPosition(e))||i.call(e,t)}}function Q(t){var n=".dragsuppress-"+ ++ko,i="click"+n,r=so.select(R(t)).on("touchmove"+n,I).on("dragstart"+n,I).on("selectstart"+n,I);if(null==Go&&(Go=!("onselectstart"in t)&&_(t.style,"userSelect")),Go){var a=s(t).style,o=a[Go];a[Go]="none"}return function(t){if(r.on(n,null),Go&&(a[Go]=o),t){var e=function(){r.on(i,null)};r.on(i,function(){I(),e()},!0),setTimeout(e,0)}}}function Z(t,e){e.changedTouches&&(e=e.changedTouches[0]);var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();if(Ro<0){var r=R(t);if(r.scrollX||r.scrollY){var a=(n=so.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();Ro=!(a.f||a.e),n.remove()}}return i.y=Ro?(i.x=e.pageX,e.pageY):(i.x=e.clientX,e.clientY),[(i=i.matrixTransform(t.getScreenCTM().inverse())).x,i.y]}var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}function K(){return so.event.changedTouches[0].identifier}function $(t){return 0<t?1:t<0?-1:0}function J(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function tt(t){return 1<t?0:t<-1?Do:Math.acos(t)}function et(t){return 1<t?zo:t<-1?-zo:Math.asin(t)}function nt(t){return((t=Math.exp(t))-1/t)/2}function it(t){return((t=Math.exp(t))+1/t)/2}function rt(t){return((t=Math.exp(2*t))-1)/(t+1)}function at(t){return(t=Math.sin(t/2))*t}function ot(){}function st(t,e,n){return this instanceof st?(this.h=+t,this.s=+e,void(this.l=+n)):arguments.length<2?t instanceof st?new st(t.h,t.s,t.l):wt(""+t,St,st):new st(t,e,n)}function ut(t,e,n){function i(t){return 360<t?t-=360:t<0&&(t+=360),t<60?a+(o-a)*t/60:t<180?o:t<240?a+(o-a)*(240-t)/60:a}function r(t){return Math.round(255*i(t))}var a,o;return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:e<0?0:1<e?1:e,a=2*(n=n<0?0:1<n?1:n)-(o=n<=.5?n*(1+e):n+e-n*e),new _t(r(t+120),r(t),r(t-120))}function ct(t,e,n){return this instanceof ct?(this.h=+t,this.c=+e,void(this.l=+n)):arguments.length<2?t instanceof ct?new ct(t.h,t.c,t.l):ft(t instanceof ht?t.l:(t=bt((t=so.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new ct(t,e,n)}function lt(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new ht(n,Math.cos(t*=Xo)*e,Math.sin(t)*e)}function ht(t,e,n){return this instanceof ht?(this.l=+t,this.a=+e,void(this.b=+n)):arguments.length<2?t instanceof ht?new ht(t.l,t.a,t.b):t instanceof ct?lt(t.h,t.c,t.l):bt((t=_t(t)).r,t.g,t.b):new ht(t,e,n)}function dt(t,e,n){var i=(t+16)/116,r=i+e/500,a=i-n/200;return new _t(xt(3.2404542*(r=gt(r)*$o)-1.5371385*(i=gt(i)*Jo)-.4985314*(a=gt(a)*ts)),xt(-.969266*r+1.8760108*i+.041556*a),xt(.0556434*r-.2040259*i+1.0572252*a))}function ft(t,e,n){return 0<t?new ct(Math.atan2(n,e)*Ho,Math.sqrt(e*e+n*n),t):new ct(NaN,NaN,t)}function gt(t){return.206893034<t?t*t*t:(t-4/29)/7.787037}function pt(t){return.008856<t?Math.pow(t,1/3):7.787037*t+4/29}function xt(t){return Math.round(255*(t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function _t(t,e,n){return this instanceof _t?(this.r=~~t,this.g=~~e,void(this.b=~~n)):arguments.length<2?t instanceof _t?new _t(t.r,t.g,t.b):wt(""+t,_t,ut):new _t(t,e,n)}function vt(t){return new _t(t>>16,t>>8&255,255&t)}function yt(t){return vt(t)+""}function mt(t){return t<16?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function wt(t,e,n){var i=0,r=0,a=0,o,s,u;if(o=/([a-z]+)\((.*)\)/.exec(t=t.toLowerCase()))switch(s=o[2].split(","),o[1]){case"hsl":return n(parseFloat(s[0]),parseFloat(s[1])/100,parseFloat(s[2])/100);case"rgb":return e(Tt(s[0]),Tt(s[1]),Tt(s[2]))}return(u=is.get(t))?e(u.r,u.g,u.b):(null==t||"#"!==t.charAt(0)||isNaN(u=parseInt(t.slice(1),16))||(4===t.length?(i=(3840&u)>>4,i|=i>>4,r=240&u,r|=r>>4,a=15&u,a|=a<<4):7===t.length&&(i=(16711680&u)>>16,r=(65280&u)>>8,a=255&u)),e(i,r,a))}function St(t,e,n){var i=Math.min(t/=255,e/=255,n/=255),r=Math.max(t,e,n),a=r-i,o,s,u=(r+i)/2;return a?(s=u<.5?a/(r+i):a/(2-r-i),o=t==r?(e-n)/a+(e<n?6:0):e==r?(n-t)/a+2:(t-e)/a+4,o*=60):(o=NaN,s=0<u&&u<1?0:o),new st(o,s,u)}function bt(t,e,n){var i=pt((.4124564*(t=At(t))+.3575761*(e=At(e))+.1804375*(n=At(n)))/$o),r=pt((.2126729*t+.7151522*e+.072175*n)/Jo),a;return ht(116*r-16,500*(i-r),200*(r-pt((.0193339*t+.119192*e+.9503041*n)/ts)))}function At(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Tt(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}function Pt(t){return"function"==typeof t?t:function(){return t}}function Ct(i){return function(t,e,n){return 2===arguments.length&&"function"==typeof e&&(n=e,e=null),Lt(t,e,i,n)}}function Lt(r,a,n,t){function e(){var t=c.status,e;if(!t&&Et(c)||200<=t&&t<300||304===t){try{e=n.call(o,c)}catch(t){return void s.error.call(o,t)}s.load.call(o,e)}else s.error.call(o,c)}var o={},s=so.dispatch("beforesend","progress","load","error"),u={},c=new XMLHttpRequest,l=null;return!this.XDomainRequest||"withCredentials"in c||!/^(http(s)?:)?\/\//.test(r)||(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=e:c.onreadystatechange=function(){3<c.readyState&&e()},c.onprogress=function(t){var e=so.event;so.event=t;try{s.progress.call(o,c)}finally{so.event=e}},o.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?u[t]:(null==e?delete u[t]:u[t]=e+"",o)},o.mimeType=function(t){return arguments.length?(a=null==t?null:t+"",o):a},o.responseType=function(t){return arguments.length?(l=t,o):l},o.response=function(t){return n=t,o},["get","post"].forEach(function(t){o[t]=function(){return o.send.apply(o,[t].concat(co(arguments)))}}),o.send=function(t,e,n){if(2===arguments.length&&"function"==typeof e&&(n=e,e=null),c.open(t,r,!0),null==a||"accept"in u||(u.accept=a+",*/*"),c.setRequestHeader)for(var i in u)c.setRequestHeader(i,u[i]);return null!=a&&c.overrideMimeType&&c.overrideMimeType(a),null!=l&&(c.responseType=l),null!=n&&o.on("error",n).on("load",function(t){n(null,t)}),s.beforesend.call(o,c),c.send(null==e?null:e),o},o.abort=function(){return c.abort(),o},so.rebind(o,s,"on"),null==t?o:o.get(Mt(t))}function Mt(n){return 1===n.length?function(t,e){n(null==t?e:null)}:n}function Et(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}function Vt(t,e,n){var i=arguments.length;i<2&&(e=0),i<3&&(n=Date.now());var r,a={c:t,t:n+e,n:null};return as?as.n=a:rs=a,as=a,os||(ss=clearTimeout(ss),os=1,us(Gt)),a}function Gt(){var t=kt(),e=Rt()-t;24<e?(isFinite(e)&&(clearTimeout(ss),ss=setTimeout(Gt,e)),os=0):(os=1,us(Gt))}function kt(){for(var t=Date.now(),e=rs;e;)t>=e.t&&e.c(t-e.t)&&(e.c=null),e=e.n;return t}function Rt(){for(var t,e=rs,n=1/0;e;)e=e.c?(e.t<n&&(n=e.t),(t=e).n):t?t.n=e.n:rs=e.n;return as=t,n}function Ot(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function It(t,e){var n=Math.pow(10,3*vo(8-e));return{scale:8<e?function(t){return t/n}:function(t){return t*n},symbol:t}}function Dt(t){var A=t.decimal,s=t.thousands,u=t.grouping,i=t.currency,T=u&&s?function(t,e){for(var n=t.length,i=[],r=0,a=u[0],o=0;0<n&&0<a&&(e<o+a+1&&(a=Math.max(1,e-o)),i.push(t.substring(n-=a,n+a)),!((o+=a+1)>e));)a=u[r=(r+1)%u.length];return i.reverse().join(s)}:O;return function(t){var e=ls.exec(t),l=e[1]||" ",h=e[2]||">",d=e[3]||"-",n=e[4]||"",f=e[5],g=+e[6],p=e[7],x=e[8],_=e[9],v=1,y="",m="",w=!1,S=!0;switch(x&&(x=+x.substring(1)),(f||"0"===l&&"="===h)&&(f=l="0",h="="),_){case"n":p=!0,_="g";break;case"%":v=100,m="%",_="f";break;case"p":v=100,m="%",_="r";break;case"b":case"o":case"x":case"X":"#"===n&&(y="0"+_.toLowerCase());case"c":S=!1;case"d":w=!0,x=0;break;case"s":v=-1,_="r";break}"$"===n&&(y=i[0],m=i[1]),"r"!=_||x||(_="g"),null!=x&&("g"==_?x=Math.max(1,Math.min(21,x)):"e"!=_&&"f"!=_||(x=Math.max(0,Math.min(20,x)))),_=hs.get(_)||Nt;var b=f&&p;return function(t){var e=m;if(w&&t%1)return"";var n=t<0||0===t&&1/t<0?(t=-t,"-"):"-"===d?"":d;if(v<0){var i=so.formatPrefix(t,x);t=i.scale(t),e=i.symbol+m}else t*=v;var r=(t=_(t,x)).lastIndexOf("."),a,o;if(r<0){var s=S?t.lastIndexOf("e"):-1;o=s<0?(a=t,""):(a=t.substring(0,s),t.substring(s))}else a=t.substring(0,r),o=A+t.substring(r+1);!f&&p&&(a=T(a,1/0));var u=y.length+a.length+o.length+(b?0:n.length),c=u<g?new Array(u=g-u+1).join(l):"";return b&&(a=T(c+a,c.length?g-o.length:1/0)),n+=y,t=a+o,("<"===h?n+t+c:">"===h?c+n+t:"^"===h?c.substring(0,u>>=1)+n+t+c.substring(u):n+(b?t:c+t))+e}}}function Nt(t){return t+""}function Ft(t){this._=new Date(1<arguments.length?Date.UTC.apply(this,arguments):t)}function zt(i,a,o){function t(t){var e=i(t),n=r(e,1);return t-e<n-t?e:n}function s(t){return a(t=i(new fs(t-1)),1),t}function r(t,e){return a(t=new fs(+t),e),t}function u(t,e,n){var i=s(t),r=[];if(1<n)for(;i<e;)o(i)%n||r.push(new Date(+i)),a(i,1);else for(;i<e;)r.push(new Date(+i)),a(i,1);return r}function e(t,e,n){try{var i=new(fs=Ft);return i._=t,u(i,e,n)}finally{fs=Date}}(i.floor=i).round=t,i.ceil=s,i.offset=r,i.range=u;var n=i.utc=Xt(i);return(n.floor=n).round=Xt(t),n.ceil=Xt(s),n.offset=Xt(r),n.range=e,i}function Xt(i){return function(t,e){try{var n=new(fs=Ft);return n._=t,i(n,e)._}finally{fs=Date}}}function Ht(t){function i(s){function t(t){for(var e=[],n=-1,i=0,r,a,o;++n<u;)37===s.charCodeAt(n)&&(e.push(s.slice(i,n)),null!=(a=ps[r=s.charAt(++n)])&&(r=s.charAt(++n)),(o=L[r])&&(r=o(t,null==a?"e"===r?" ":"0":a)),e.push(r),i=n+1);return e.push(s.slice(i,n)),e.join("")}var u=s.length;return t.parse=function(t){var e={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},n;if(a(e,s,t,0)!=t.length)return null;"p"in e&&(e.H=e.H%12+12*e.p);var i=null!=e.Z&&fs!==Ft,r=new(i?Ft:fs);return"j"in e?r.setFullYear(e.y,0,e.j):"W"in e||"U"in e?("w"in e||(e.w="W"in e?1:0),r.setFullYear(e.y,0,1),r.setFullYear(e.y,0,"W"in e?(e.w+6)%7+7*e.W-(r.getDay()+5)%7:e.w+7*e.U-(r.getDay()+6)%7)):r.setFullYear(e.y,e.m,e.d),r.setHours(e.H+(e.Z/100|0),e.M+e.Z%100,e.S,e.L),i?r._:r},t.toString=function(){return s},t}function a(t,e,n,i){for(var r,a,o,s=0,u=e.length,c=n.length;s<u;){if(c<=i)return-1;if(37===(r=e.charCodeAt(s++))){if(o=e.charAt(s++),!(a=M[o in ps?e.charAt(s++):o])||(i=a(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}function e(t,e,n){S.lastIndex=0;var i=S.exec(e.slice(n));return i?(t.w=b.get(i[0].toLowerCase()),n+i[0].length):-1}function n(t,e,n){m.lastIndex=0;var i=m.exec(e.slice(n));return i?(t.w=w.get(i[0].toLowerCase()),n+i[0].length):-1}function r(t,e,n){P.lastIndex=0;var i=P.exec(e.slice(n));return i?(t.m=C.get(i[0].toLowerCase()),n+i[0].length):-1}function o(t,e,n){A.lastIndex=0;var i=A.exec(e.slice(n));return i?(t.m=T.get(i[0].toLowerCase()),n+i[0].length):-1}function s(t,e,n){return a(t,L.c.toString(),e,n)}function u(t,e,n){return a(t,L.x.toString(),e,n)}function c(t,e,n){return a(t,L.X.toString(),e,n)}function l(t,e,n){var i=y.get(e.slice(n,n+=2).toLowerCase());return null==i?-1:(t.p=i,n)}var h=t.dateTime,d=t.date,f=t.time,g=t.periods,p=t.days,x=t.shortDays,_=t.months,v=t.shortMonths;i.utc=function(t){function e(t){try{var e=new(fs=Ft);return e._=t,n(e)}finally{fs=Date}}var n=i(t);return e.parse=function(t){try{fs=Ft;var e=n.parse(t);return e&&e._}finally{fs=Date}},e.toString=n.toString,e},i.multi=i.utc.multi=ue;var y=so.map(),m=Bt(p),w=jt(p),S=Bt(x),b=jt(x),A=Bt(_),T=jt(_),P=Bt(v),C=jt(v);g.forEach(function(t,e){y.set(t.toLowerCase(),e)});var L={a:function(t){return x[t.getDay()]},A:function(t){return p[t.getDay()]},b:function(t){return v[t.getMonth()]},B:function(t){return _[t.getMonth()]},c:i(h),d:function(t,e){return Yt(t.getDate(),e,2)},e:function(t,e){return Yt(t.getDate(),e,2)},H:function(t,e){return Yt(t.getHours(),e,2)},I:function(t,e){return Yt(t.getHours()%12||12,e,2)},j:function(t,e){return Yt(1+ds.dayOfYear(t),e,3)},L:function(t,e){return Yt(t.getMilliseconds(),e,3)},m:function(t,e){return Yt(t.getMonth()+1,e,2)},M:function(t,e){return Yt(t.getMinutes(),e,2)},p:function(t){return g[+(12<=t.getHours())]},S:function(t,e){return Yt(t.getSeconds(),e,2)},U:function(t,e){return Yt(ds.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return Yt(ds.mondayOfYear(t),e,2)},x:i(d),X:i(f),y:function(t,e){return Yt(t.getFullYear()%100,e,2)},Y:function(t,e){return Yt(t.getFullYear()%1e4,e,4)},Z:oe,"%":function(){return"%"}},M={a:e,A:n,b:r,B:o,c:s,d:te,e:te,H:ne,I:ne,j:ee,L:ae,m:Jt,M:ie,p:l,S:re,U:qt,w:Ut,W:Wt,x:u,X:c,y:Zt,Y:Qt,Z:Kt,"%":se};return i}function Yt(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",a=r.length;return i+(a<n?new Array(n-a+1).join(e)+r:r)}function Bt(t){return new RegExp("^(?:"+t.map(so.requote).join("|")+")","i")}function jt(t){for(var e=new v,n=-1,i=t.length;++n<i;)e.set(t[n].toLowerCase(),n);return e}function Ut(t,e,n){xs.lastIndex=0;var i=xs.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function qt(t,e,n){xs.lastIndex=0;var i=xs.exec(e.slice(n));return i?(t.U=+i[0],n+i[0].length):-1}function Wt(t,e,n){xs.lastIndex=0;var i=xs.exec(e.slice(n));return i?(t.W=+i[0],n+i[0].length):-1}function Qt(t,e,n){xs.lastIndex=0;var i=xs.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function Zt(t,e,n){xs.lastIndex=0;var i=xs.exec(e.slice(n,n+2));return i?(t.y=$t(+i[0]),n+i[0].length):-1}function Kt(t,e,n){return/^[+-]\d{4}$/.test(e=e.slice(n,n+5))?(t.Z=-e,n+5):-1}function $t(t){return t+(68<t?1900:2e3)}function Jt(t,e,n){xs.lastIndex=0;var i=xs.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function te(t,e,n){xs.lastIndex=0;var i=xs.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function ee(t,e,n){xs.lastIndex=0;var i=xs.exec(e.slice(n,n+3));return i?(t.j=+i[0],n+i[0].length):-1}function ne(t,e,n){xs.lastIndex=0;var i=xs.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function ie(t,e,n){xs.lastIndex=0;var i=xs.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function re(t,e,n){xs.lastIndex=0;var i=xs.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function ae(t,e,n){xs.lastIndex=0;var i=xs.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function oe(t){var e=t.getTimezoneOffset(),n=0<e?"-":"+",i=vo(e)/60|0,r=vo(e)%60;return n+Yt(i,"0",2)+Yt(r,"0",2)}function se(t,e,n){_s.lastIndex=0;var i=_s.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function ue(i){for(var t=i.length,e=-1;++e<t;)i[e][0]=this(i[e][0]);return function(t){for(var e=0,n=i[e];!n[1](t);)n=i[++e];return n[0](t)}}function ce(){}function le(t,e,n){var i=n.s=t+e,r=i-t,a=i-r;n.t=t-a+(e-r)}function he(t,e){t&&ws.hasOwnProperty(t.type)&&ws[t.type](t,e)}function de(t,e,n){var i=-1,r=t.length-n,a;for(e.lineStart();++i<r;)a=t[i],e.point(a[0],a[1],a[2]);e.lineEnd()}function fe(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)de(t[n],e,1);e.polygonEnd()}function ge(){function n(t,e){e=e*Xo/2+Do/4;var n=(t*=Xo)-l,i=0<=n?1:-1,r=i*n,a=Math.cos(e),o=Math.sin(e),s=d*o,u=h*a+s*Math.cos(r),c=s*i*Math.sin(r);bs.add(Math.atan2(c,u)),l=t,h=a,d=o}var i,r,l,h,d;As.point=function(t,e){As.point=n,l=(i=t)*Xo,h=Math.cos(e=(r=e)*Xo/2+Do/4),d=Math.sin(e)},As.lineEnd=function(){n(i,r)}}function pe(t){var e=t[0],n=t[1],i=Math.cos(n);return[i*Math.cos(e),i*Math.sin(e),Math.sin(n)]}function xe(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function _e(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function ve(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function ye(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function me(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function we(t){return[Math.atan2(t[1],t[0]),et(t[2])]}function Se(t,e){return vo(t[0]-e[0])<Oo&&vo(t[1]-e[1])<Oo}function be(t,e){t*=Xo;var n=Math.cos(e*=Xo);Ae(n*Math.cos(t),n*Math.sin(t),Math.sin(e))}function Ae(t,e,n){Cs+=(t-Cs)/++Ts,Ls+=(e-Ls)/Ts,Ms+=(n-Ms)/Ts}function Te(){function i(t,e){t*=Xo;var n=Math.cos(e*=Xo),i=n*Math.cos(t),r=n*Math.sin(t),a=Math.sin(e),o=Math.atan2(Math.sqrt((o=u*a-c*r)*o+(o=c*i-s*a)*o+(o=s*r-u*i)*o),s*i+u*r+c*a);Ps+=o,Es+=o*(s+(s=i)),Vs+=o*(u+(u=r)),Gs+=o*(c+(c=a)),Ae(s,u,c)}var s,u,c;Is.point=function(t,e){t*=Xo;var n=Math.cos(e*=Xo);s=n*Math.cos(t),u=n*Math.sin(t),c=Math.sin(e),Is.point=i,Ae(s,u,c)}}function Pe(){Is.point=be}function Ce(){function i(t,e){t*=Xo;var n=Math.cos(e*=Xo),i=n*Math.cos(t),r=n*Math.sin(t),a=Math.sin(e),o=g*a-p*r,s=p*i-f*a,u=f*r-g*i,c=Math.sqrt(o*o+s*s+u*u),l=f*i+g*r+p*a,h=c&&-tt(l)/c,d=Math.atan2(c,l);ks+=h*o,Rs+=h*s,Os+=h*u,Ps+=d,Es+=d*(f+(f=i)),Vs+=d*(g+(g=r)),Gs+=d*(p+(p=a)),Ae(f,g,p)}var r,a,f,g,p;Is.point=function(t,e){r=t,a=e,Is.point=i,t*=Xo;var n=Math.cos(e*=Xo);f=n*Math.cos(t),g=n*Math.sin(t),p=Math.sin(e),Ae(f,g,p)},Is.lineEnd=function(){i(r,a),Is.lineEnd=Pe,Is.point=be}}function Le(n,i){function t(t,e){return t=n(t,e),i(t[0],t[1])}return n.invert&&i.invert&&(t.invert=function(t,e){return(t=i.invert(t,e))&&n.invert(t[0],t[1])}),t}function Me(){return!0}function Ee(t,e,n,i,s){var u=[],c=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n=t[0],i=t[e];if(Se(n,i)){s.lineStart();for(var r=0;r<e;++r)s.point((n=t[r])[0],n[1]);s.lineEnd()}else{var a=new Ge(n,t,null,!0),o=new Ge(n,null,a,!1);a.o=o,u.push(a),c.push(o),o=new Ge(i,null,a=new Ge(i,t,null,!1),!0),a.o=o,u.push(a),c.push(o)}}}),c.sort(e),Ve(u),Ve(c),u.length){for(var r=0,a=n,o=c.length;r<o;++r)c[r].e=a=!a;for(var l=u[0],h,d;;){for(var f=l,g=!0;f.v;)if((f=f.n)===l)return;h=f.z,s.lineStart();do{if(f.v=f.o.v=!0,f.e){if(g)for(var r=0,o=h.length;r<o;++r)s.point((d=h[r])[0],d[1]);else i(f.x,f.n.x,1,s);f=f.n}else{if(g)for(var r=(h=f.p.z).length-1;0<=r;--r)s.point((d=h[r])[0],d[1]);else i(f.x,f.p.x,-1,s);f=f.p}h=(f=f.o).z,g=!g}while(!f.v);s.lineEnd()}}}function Ve(t){if(e=t.length){for(var e,n=0,i=t[0],r;++n<e;)i.n=r=t[n],r.p=i,i=r;i.n=r=t[0],r.p=i}}function Ge(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function ke(v,y,m,w){return function(i,o){function e(t,e){var n=i(t,e);v(t=n[0],e=n[1])&&o.point(t,e)}function t(t,e){var n=i(t,e);c.point(n[0],n[1])}function n(){h.point=t,c.lineStart()}function r(){h.point=e,c.lineEnd()}function s(t,e){_.push([t,e]);var n=i(t,e);g.point(n[0],n[1])}function a(){g.lineStart(),_=[]}function u(){s(_[0][0],_[0][1]),g.lineEnd();var t=g.clean(),e=f.buffer(),n,i=e.length;if(_.pop(),x.push(_),_=null,i)if(1&t){var i,r=-1,a;if(0<(i=(n=e[0]).length-1)){for(p||(o.polygonStart(),p=!0),o.lineStart();++r<i;)o.point((a=n[r])[0],a[1]);o.lineEnd()}}else 1<i&&2&t&&e.push(e.pop().concat(e.shift())),d.push(e.filter(Re))}var c=y(o),l=i.invert(w[0],w[1]),h={point:e,lineStart:n,lineEnd:r,polygonStart:function(){h.point=s,h.lineStart=a,h.lineEnd=u,d=[],x=[]},polygonEnd:function(){h.point=e,h.lineStart=n,h.lineEnd=r,d=so.merge(d);var t=ze(l,x);d.length?(p||(o.polygonStart(),p=!0),Ee(d,Ie,t,m,o)):t&&(p||(o.polygonStart(),p=!0),o.lineStart(),m(null,null,1,o),o.lineEnd()),p&&(o.polygonEnd(),p=!1),d=x=null},sphere:function(){o.polygonStart(),o.lineStart(),m(null,null,1,o),o.lineEnd(),o.polygonEnd()}},d,f=Oe(),g=y(f),p=!1,x,_;return h}}function Re(t){return 1<t.length}function Oe(){var e=[],n;return{lineStart:function(){e.push(n=[])},point:function(t,e){n.push([t,e])},lineEnd:m,buffer:function(){var t=e;return e=[],n=null,t},rejoin:function(){1<e.length&&e.push(e.pop().concat(e.shift()))}}}function Ie(t,e){return((t=t.x)[0]<0?t[1]-zo-Oo:zo-t[1])-((e=e.x)[0]<0?e[1]-zo-Oo:zo-e[1])}function De(r){var a=NaN,o=NaN,s=NaN,u;return{lineStart:function(){r.lineStart(),u=1},point:function(t,e){var n=0<t?Do:-Do,i=vo(t-a);vo(i-Do)<Oo?(r.point(a,o=0<(o+e)/2?zo:-zo),r.point(s,o),r.lineEnd(),r.lineStart(),r.point(n,o),r.point(t,o),u=0):s!==n&&Do<=i&&(vo(a-s)<Oo&&(a-=s*Oo),vo(t-n)<Oo&&(t-=n*Oo),o=Ne(a,o,t,e),r.point(s,o),r.lineEnd(),r.lineStart(),r.point(n,o),u=0),r.point(a=t,o=e),s=n},lineEnd:function(){r.lineEnd(),a=o=NaN},clean:function(){return 2-u}}}function Ne(t,e,n,i){var r,a,o=Math.sin(t-n);return vo(o)>Oo?Math.atan((Math.sin(e)*(a=Math.cos(i))*Math.sin(n)-Math.sin(i)*(r=Math.cos(e))*Math.sin(t))/(r*a*o)):(e+i)/2}function Fe(t,e,n,i){var r;if(null==t)r=n*zo,i.point(-Do,r),i.point(0,r),i.point(Do,r),i.point(Do,0),i.point(Do,-r),i.point(0,-r),i.point(-Do,-r),i.point(-Do,0),i.point(-Do,r);else if(vo(t[0]-e[0])>Oo){var a=t[0]<e[0]?Do:-Do;r=n*a/2,i.point(-a,r),i.point(0,r),i.point(a,r)}else i.point(e[0],e[1])}function ze(t,e){var n=t[0],i=t[1],r=[Math.sin(n),-Math.cos(n),0],a=0,o=0;bs.reset();for(var s=0,u=e.length;s<u;++s){var c=e[s],l=c.length;if(l)for(var h=c[0],d=h[0],f=h[1]/2+Do/4,g=Math.sin(f),p=Math.cos(f),x=1;;){x===l&&(x=0);var _=(t=c[x])[0],v=t[1]/2+Do/4,y=Math.sin(v),m=Math.cos(v),w=_-d,S=0<=w?1:-1,b=S*w,A=Do<b,T=g*y;if(bs.add(Math.atan2(T*S*Math.sin(b),p*m+T*Math.cos(b))),a+=A?w+S*No:w,A^n<=d^n<=_){var P=_e(pe(h),pe(t));me(P);var C=_e(r,P);me(C);var L=(A^0<=w?-1:1)*et(C[2]);(L<i||i===L&&(P[0]||P[1]))&&(o+=A^0<=w?1:-1)}if(!x++)break;d=_,g=y,p=m,h=t}}return(a<-Oo||a<Oo&&bs<-Oo)^1&o}function Xe(r){function f(t,e){return Math.cos(t)*Math.cos(e)>E}function t(s){var u,c,l,h,d;return{lineStart:function(){h=l=!1,d=1},point:function(t,e){var n=[t,e],i,r=f(t,e),a=x?r?0:p(t,e):r?p(t+(t<0?Do:-Do),e):0;if(!u&&(h=l=r)&&s.lineStart(),r!==l&&(i=g(u,n),(Se(u,i)||Se(n,i))&&(n[0]+=Oo,n[1]+=Oo,r=f(n[0],n[1]))),r!==l)d=0,r?(s.lineStart(),i=g(n,u),s.point(i[0],i[1])):(i=g(u,n),s.point(i[0],i[1]),s.lineEnd()),u=i;else if(_&&u&&x^r){var o;a&c||!(o=g(n,u,!0))||(d=0,x?(s.lineStart(),s.point(o[0][0],o[0][1]),s.point(o[1][0],o[1][1]),s.lineEnd()):(s.point(o[1][0],o[1][1]),s.lineEnd(),s.lineStart(),s.point(o[0][0],o[0][1])))}!r||u&&Se(u,n)||s.point(n[0],n[1]),u=n,l=r,c=a},lineEnd:function(){l&&s.lineEnd(),u=null},clean:function(){return d|(h&&l)<<1}}}function g(t,e,n){var i,r,a=[1,0,0],o=_e(pe(t),pe(e)),s=xe(o,o),u=o[0],c=s-u*u;if(!c)return!n&&t;var l=E*s/c,h=-E*u/c,d=_e(a,o),f=ye(a,l),g;ve(f,ye(o,h));var p=d,x=xe(f,p),_=xe(p,p),v=x*x-_*(xe(f,f)-1);if(!(v<0)){var y=Math.sqrt(v),m=ye(p,(-x-y)/_);if(ve(m,f),m=we(m),!n)return m;var w=t[0],S=e[0],b=t[1],A=e[1],T;S<w&&(T=w,w=S,S=T);var P=S-w,C=vo(P-Do)<Oo,L;if(!C&&A<b&&(T=b,b=A,A=T),C||P<Oo?C?0<b+A^m[1]<(vo(m[0]-w)<Oo?b:A):b<=m[1]&&m[1]<=A:Do<P^(w<=m[0]&&m[0]<=S)){var M=ye(p,(-x+y)/_);return ve(M,f),[m,we(M)]}}}function p(t,e){var n=x?r:Do-r,i=0;return t<-n?i|=1:n<t&&(i|=2),e<-n?i|=4:n<e&&(i|=8),i}var E=Math.cos(r),x=0<E,_=vo(E)>Oo,e;return ke(f,t,pn(r,6*Xo),x?[0,-r]:[-Do,r-Do])}function He(d,f,g,p){return function(t){var e=t.a,n=t.b,i=e.x,r=e.y,a,o,s=0,u=1,c=n.x-i,l=n.y-r,h;if(h=d-i,c||!(0<h)){if(h/=c,c<0){if(h<s)return;h<u&&(u=h)}else if(0<c){if(u<h)return;s<h&&(s=h)}if(h=g-i,c||!(h<0)){if(h/=c,c<0){if(u<h)return;s<h&&(s=h)}else if(0<c){if(h<s)return;h<u&&(u=h)}if(h=f-r,l||!(0<h)){if(h/=l,l<0){if(h<s)return;h<u&&(u=h)}else if(0<l){if(u<h)return;s<h&&(s=h)}if(h=p-r,l||!(h<0)){if(h/=l,l<0){if(u<h)return;s<h&&(s=h)}else if(0<l){if(h<s)return;h<u&&(u=h)}return 0<s&&(t.a={x:i+s*c,y:r+s*l}),u<1&&(t.b={x:i+u*c,y:r+u*l}),t}}}}}}function Ye(b,A,T,P){function C(t,e){return vo(t[0]-b)<Oo?0<e?0:3:vo(t[0]-T)<Oo?0<e?2:1:vo(t[1]-A)<Oo?0<e?1:0:0<e?3:2}function L(t,e){return M(t.x,e.x)}function M(t,e){var n=C(t,1),i=C(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(r){function i(t){for(var e=0,n=d.length,i=t[1],r=0;r<n;++r)for(var a=1,o=d[r],s=o.length,u=o[0],c;a<s;++a)c=o[a],u[1]<=i?c[1]>i&&0<J(u,c,t)&&++e:c[1]<=i&&J(u,c,t)<0&&--e,u=c;return 0!==e}function a(t,e,n,i){var r=0,a=0;if(null==t||(r=C(t,n))!==(a=C(e,n))||M(t,e)<0^0<n)for(;i.point(0===r||3===r?b:T,1<r?P:A),(r=(r+n+4)%4)!==a;);else i.point(e[0],e[1])}function o(t,e){return b<=t&&t<=T&&A<=e&&e<=P}function t(t,e){o(t,e)&&r.point(t,e)}function e(){g.point=s,d&&d.push(f=[]),m=!(w=!0),v=y=NaN}function n(){h&&(s(p,x),_&&m&&c.rejoin(),h.push(c.buffer())),g.point=t,m&&r.lineEnd()}function s(t,e){var n=o(t=Math.max(-Ns,Math.min(Ns,t)),e=Math.max(-Ns,Math.min(Ns,e)));if(d&&f.push([t,e]),w)p=t,x=e,w=!1,(_=n)&&(r.lineStart(),r.point(t,e));else if(n&&m)r.point(t,e);else{var i={a:{x:v,y:y},b:{x:t,y:e}};l(i)?(m||(r.lineStart(),r.point(i.a.x,i.a.y)),r.point(i.b.x,i.b.y),n||r.lineEnd(),S=!1):n&&(r.lineStart(),r.point(t,e),S=!1)}v=t,y=e,m=n}var u=r,c=Oe(),l=He(b,A,T,P),h,d,f,g={point:t,lineStart:e,lineEnd:n,polygonStart:function(){r=c,h=[],d=[],S=!0},polygonEnd:function(){r=u,h=so.merge(h);var t=i([b,P]),e=S&&t,n=h.length;(e||n)&&(r.polygonStart(),e&&(r.lineStart(),a(null,null,1,r),r.lineEnd()),n&&Ee(h,L,t,a,r),r.polygonEnd()),h=d=f=null}},p,x,_,v,y,m,w,S;return g}}function Be(t){var e=0,n=Do/3,i=sn(t),r=i(e,n);return r.parallels=function(t){return arguments.length?i(e=t[0]*Do/180,n=t[1]*Do/180):[e/Do*180,n/Do*180]},r}function je(t,e){function n(t,e){var n=Math.sqrt(a-2*r*Math.sin(e))/r;return[n*Math.sin(t*=r),o-n*Math.cos(t)]}var i=Math.sin(t),r=(i+Math.sin(e))/2,a=1+i*(2*r-i),o=Math.sqrt(a)/r;return n.invert=function(t,e){var n=o-e;return[Math.atan2(t,n)/r,et((a-(t*t+n*n)*r*r)/(2*r))]},n}function Ue(){function n(t,e){zs+=o*t-a*e,a=t,o=e}var i,r,a,o;Xs.point=function(t,e){Xs.point=n,i=a=t,r=o=e},Xs.lineEnd=function(){n(i,r)}}function qe(t,e){t<Hs&&(Hs=t),Bs<t&&(Bs=t),e<Ys&&(Ys=e),js<e&&(js=e)}function We(){function t(t,e){o.push("M",t,",",e,a)}function e(t,e){o.push("M",t,",",e),s.point=n}function n(t,e){o.push("L",t,",",e)}function i(){s.point=t}function r(){o.push("Z")}var a=Qe(4.5),o=[],s={point:t,lineStart:function(){s.point=e},lineEnd:i,polygonStart:function(){s.lineEnd=r},polygonEnd:function(){s.lineEnd=i,s.point=t},pointRadius:function(t){return a=Qe(t),s},result:function(){if(o.length){var t=o.join("");return o=[],t}}};return s}function Qe(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Ze(t,e){Cs+=t,Ls+=e,++Ms}function Ke(){function n(t,e){var n=t-a,i=e-o,r=Math.sqrt(n*n+i*i);Es+=r*(a+t)/2,Vs+=r*(o+e)/2,Gs+=r,Ze(a=t,o=e)}var a,o;qs.point=function(t,e){qs.point=n,Ze(a=t,o=e)}}function $e(){qs.point=Ze}function Je(){function n(t,e){var n=t-a,i=e-o,r=Math.sqrt(n*n+i*i);Es+=r*(a+t)/2,Vs+=r*(o+e)/2,Gs+=r,ks+=(r=o*t-a*e)*(a+t),Rs+=r*(o+e),Os+=3*r,Ze(a=t,o=e)}var i,r,a,o;qs.point=function(t,e){qs.point=n,Ze(i=a=t,r=o=e)},qs.lineEnd=function(){n(i,r)}}function tn(n){function t(t,e){n.moveTo(t+o,e),n.arc(t,e,o,0,No)}function e(t,e){n.moveTo(t,e),s.point=i}function i(t,e){n.lineTo(t,e)}function r(){s.point=t}function a(){n.closePath()}var o=4.5,s={point:t,lineStart:function(){s.point=e},lineEnd:r,polygonStart:function(){s.lineEnd=a},polygonEnd:function(){s.lineEnd=r,s.point=t},pointRadius:function(t){return o=t,s},result:m};return s}function en(M){function e(t){return(S?i:n)(t)}function n(n){return an(n,function(t,e){t=M(t,e),n.point(t[0],t[1])})}function i(r){function t(t,e){t=M(t,e),r.point(t[0],t[1])}
function e(){x=NaN,w.point=n,r.lineStart()}function n(t,e){var n=pe([t,e]),i=M(t,e);E(x,_,p,v,y,m,x=i[0],_=i[1],p=t,v=n[0],y=n[1],m=n[2],S,r),r.point(x,_)}function i(){w.point=t,r.lineEnd()}function a(){e(),w.point=o,w.lineEnd=s}function o(t,e){n(u=t,c=e),l=x,h=_,d=v,f=y,g=m,w.point=n}function s(){E(x,_,p,v,y,m,l,h,u,d,f,g,S,r),(w.lineEnd=i)()}var u,c,l,h,d,f,g,p,x,_,v,y,m,w={point:t,lineStart:e,lineEnd:i,polygonStart:function(){r.polygonStart(),w.lineStart=a},polygonEnd:function(){r.polygonEnd(),w.lineStart=e}};return w}function E(t,e,n,i,r,a,o,s,u,c,l,h,d,f){var g=o-t,p=s-e,x=g*g+p*p;if(4*V<x&&d--){var _=i+c,v=r+l,y=a+h,m=Math.sqrt(_*_+v*v+y*y),w=Math.asin(y/=m),S=vo(vo(y)-1)<Oo||vo(n-u)<Oo?(n+u)/2:Math.atan2(v,_),b=M(S,w),A=b[0],T=b[1],P=A-t,C=T-e,L=p*P-g*C;(V<L*L/x||.3<vo((g*P+p*C)/x-.5)||i*c+r*l+a*h<G)&&(E(t,e,n,i,r,a,A,T,S,_/=m,v/=m,y,d,f),f.point(A,T),E(A,T,S,_,v,y,o,s,u,c,l,h,d,f))}}var V=.5,G=Math.cos(30*Xo),S=16;return e.precision=function(t){return arguments.length?(S=0<(V=t*t)&&16,e):Math.sqrt(V)},e}function nn(n){var e=en(function(t,e){return n([t*Ho,e*Ho])});return function(t){return un(e(t))}}function rn(t){this.stream=t}function an(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function on(t){return sn(function(){return t})()}function sn(t){function e(t){return[(t=s(t[0]*Xo,t[1]*Xo))[0]*c+_,v-t[1]*c]}function n(t){return(t=s.invert((t[0]-_)/c,(v-t[1])/c))&&[t[0]*Ho,t[1]*Ho]}function i(){s=Le(o=hn(g,p,x),a);var t=a(d,f);return _=l-t[0]*c,v=h+t[1]*c,r()}function r(){return b&&(b.valid=!1,b=null),e}var a,o,s,u=en(function(t,e){return[(t=a(t,e))[0]*c+_,v-t[1]*c]}),c=150,l=480,h=250,d=0,f=0,g=0,p=0,x=0,_,v,y=Ds,m=O,w=null,S=null,b;return e.stream=function(t){return b&&(b.valid=!1),(b=un(y(o,u(m(t))))).valid=!0,b},e.clipAngle=function(t){return arguments.length?(y=null==t?(w=t,Ds):Xe((w=+t)*Xo),r()):w},e.clipExtent=function(t){return arguments.length?(m=(S=t)?Ye(t[0][0],t[0][1],t[1][0],t[1][1]):O,r()):S},e.scale=function(t){return arguments.length?(c=+t,i()):c},e.translate=function(t){return arguments.length?(l=+t[0],h=+t[1],i()):[l,h]},e.center=function(t){return arguments.length?(d=t[0]%360*Xo,f=t[1]%360*Xo,i()):[d*Ho,f*Ho]},e.rotate=function(t){return arguments.length?(g=t[0]%360*Xo,p=t[1]%360*Xo,x=2<t.length?t[2]%360*Xo:0,i()):[g*Ho,p*Ho,x*Ho]},so.rebind(e,u,"precision"),function(){return a=t.apply(this,arguments),e.invert=a.invert&&n,i()}}function un(n){return an(n,function(t,e){n.point(t*Xo,e*Xo)})}function cn(t,e){return[t,e]}function ln(t,e){return[Do<t?t-No:t<-Do?t+No:t,e]}function hn(t,e,n){return t?e||n?Le(fn(t),gn(e,n)):fn(t):e||n?gn(e,n):ln}function dn(n){return function(t,e){return[Do<(t+=n)?t-No:t<-Do?t+No:t,e]}}function fn(t){var e=dn(t);return e.invert=dn(-t),e}function gn(t,e){function n(t,e){var n=Math.cos(e),i=Math.cos(t)*n,r=Math.sin(t)*n,a=Math.sin(e),o=a*s+i*u;return[Math.atan2(r*c-o*l,i*s-a*u),et(o*c+r*l)]}var s=Math.cos(t),u=Math.sin(t),c=Math.cos(e),l=Math.sin(e);return n.invert=function(t,e){var n=Math.cos(e),i=Math.cos(t)*n,r=Math.sin(t)*n,a=Math.sin(e),o=a*c-r*l;return[Math.atan2(r*c+a*l,i*s+o*u),et(o*s-i*u)]},n}function pn(s,u){var c=Math.cos(s),l=Math.sin(s);return function(t,e,n,i){var r=n*u;null!=t?(t=xn(c,t),e=xn(c,e),(0<n?t<e:e<t)&&(t+=n*No)):(t=s+n*No,e=s-.5*r);for(var a,o=t;0<n?e<o:o<e;o-=r)i.point((a=we([c,-l*Math.cos(o),-l*Math.sin(o)]))[0],a[1])}}function xn(t,e){var n=pe(e);n[0]-=t,me(n);var i=tt(-n[1]);return((-n[2]<0?-i:i)+2*Math.PI-Oo)%(2*Math.PI)}function _n(t,e,n){var i=so.range(t,e-Oo,n).concat(e);return function(e){return i.map(function(t){return[e,t]})}}function vn(t,e,n){var i=so.range(t,e-Oo,n).concat(e);return function(e){return i.map(function(t){return[t,e]})}}function yn(t){return t.source}function mn(t){return t.target}function wn(t,e,n,i){var r=Math.cos(e),o=Math.sin(e),a=Math.cos(i),s=Math.sin(i),u=r*Math.cos(t),c=r*Math.sin(t),l=a*Math.cos(n),h=a*Math.sin(n),d=2*Math.asin(Math.sqrt(at(i-e)+r*a*at(n-t))),f=1/Math.sin(d),g=d?function(t){var e=Math.sin(t*=d)*f,n=Math.sin(d-t)*f,i=n*u+e*l,r=n*c+e*h,a=n*o+e*s;return[Math.atan2(r,i)*Ho,Math.atan2(a,Math.sqrt(i*i+r*r))*Ho]}:function(){return[t*Ho,e*Ho]};return g.distance=d,g}function Sn(){function n(t,e){var n=Math.sin(e*=Xo),i=Math.cos(e),r=vo((t*=Xo)-o),a=Math.cos(r);Ws+=Math.atan2(Math.sqrt((r=i*Math.sin(r))*r+(r=u*n-s*i*a)*r),s*n+u*i*a),o=t,s=n,u=i}var o,s,u;Qs.point=function(t,e){o=t*Xo,s=Math.sin(e*=Xo),u=Math.cos(e),Qs.point=n},Qs.lineEnd=function(){Qs.point=Qs.lineEnd=m}}function bn(a,o){function t(t,e){var n=Math.cos(t),i=Math.cos(e),r=a(n*i);return[r*i*Math.sin(t),r*Math.sin(e)]}return t.invert=function(t,e){var n=Math.sqrt(t*t+e*e),i=o(n),r=Math.sin(i),a=Math.cos(i);return[Math.atan2(t*r,n*a),Math.asin(n&&e*r/n)]},t}function An(t,e){function n(t,e){0<o?e<-zo+Oo&&(e=-zo+Oo):zo-Oo<e&&(e=zo-Oo);var n=o/Math.pow(r(e),a);return[n*Math.sin(a*t),o-n*Math.cos(a*t)]}var i=Math.cos(t),r=function(t){return Math.tan(Do/4+t/2)},a=t===e?Math.sin(t):Math.log(i/Math.cos(e))/Math.log(r(e)/r(t)),o=i*Math.pow(r(t),a)/a;return a?(n.invert=function(t,e){var n=o-e,i=$(a)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/a,2*Math.atan(Math.pow(o/i,1/a))-zo]},n):Pn}function Tn(t,e){function n(t,e){var n=a-e;return[n*Math.sin(r*t),a-n*Math.cos(r*t)]}var i=Math.cos(t),r=t===e?Math.sin(t):(i-Math.cos(e))/(e-t),a=i/r+t;return vo(r)<Oo?cn:(n.invert=function(t,e){var n=a-e;return[Math.atan2(t,n)/r,a-$(r)*Math.sqrt(t*t+n*n)]},n)}function Pn(t,e){return[t,Math.log(Math.tan(Do/4+e/2))]}function Cn(t){var r=on(t),a=r.scale,o=r.translate,s=r.clipExtent,u;return r.scale=function(){var t=a.apply(r,arguments);return t===r?u?r.clipExtent(null):r:t},r.translate=function(){var t=o.apply(r,arguments);return t===r?u?r.clipExtent(null):r:t},r.clipExtent=function(t){var e=s.apply(r,arguments);if(e===r){if(u=null==t){var n=Do*a(),i=o();s([[i[0]-n,i[1]-n],[i[0]+n,i[1]+n]])}}else u&&(e=null);return e},r.clipExtent(null)}function Ln(t,e){return[Math.log(Math.tan(Do/4+e/2)),-t]}function Mn(t){return t[0]}function En(t){return t[1]}function Vn(t){for(var e=t.length,n=[0,1],i=2,r=2;r<e;r++){for(;1<i&&J(t[n[i-2]],t[n[i-1]],t[r])<=0;)--i;n[i++]=r}return n.slice(0,i)}function Gn(t,e){return t[0]-e[0]||t[1]-e[1]}function kn(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function Rn(t,e,n,i){var r=t[0],a=n[0],o=e[0]-r,s=i[0]-a,u=t[1],c=n[1],l=e[1]-u,h=i[1]-c,d=(s*(u-c)-h*(r-a))/(h*o-s*l);return[r+d*o,u+d*l]}function On(t){var e=t[0],n=t[t.length-1];return!(e[0]-n[0]||e[1]-n[1])}function In(){ii(this),this.edge=this.site=this.circle=null}function Dn(t){var e=au.pop()||new In;return e.site=t,e}function Nn(t){Wn(t),ru.remove(t),au.push(t),ii(t)}function Fn(t){var e=t.circle,n=e.x,i=e.cy,r={x:n,y:i},a=t.P,o=t.N,s=[t];Nn(t);for(var u=a;u.circle&&vo(n-u.circle.x)<Oo&&vo(i-u.circle.cy)<Oo;)a=u.P,s.unshift(u),Nn(u),u=a;s.unshift(u),Wn(u);for(var c=o;c.circle&&vo(n-c.circle.x)<Oo&&vo(i-c.circle.cy)<Oo;)o=c.N,s.push(c),Nn(c),c=o;s.push(c),Wn(c);var l=s.length,h;for(h=1;h<l;++h)c=s[h],u=s[h-1],ti(c.edge,u.site,c.site,r);u=s[0],(c=s[l-1]).edge=$n(u.site,c.site,null,r),qn(u),qn(c)}function zn(t){for(var e=t.x,n=t.y,i,r,a,o,s=ru._;s;)if(a=Xn(s,n)-e,Oo<a)s=s.L;else{if(o=e-Hn(s,n),!(Oo<o)){-Oo<a?(i=s.P,r=s):-Oo<o?r=(i=s).N:i=r=s;break}if(!s.R){i=s;break}s=s.R}var u=Dn(t);if(ru.insert(i,u),i||r){if(i===r)return Wn(i),r=Dn(i.site),ru.insert(u,r),u.edge=r.edge=$n(i.site,u.site),qn(i),void qn(r);if(r){Wn(i),Wn(r);var c=i.site,l=c.x,h=c.y,d=t.x-l,f=t.y-h,g=r.site,p=g.x-l,x=g.y-h,_=2*(d*x-f*p),v=d*d+f*f,y=p*p+x*x,m={x:(x*v-f*y)/_+l,y:(d*y-p*v)/_+h};ti(r.edge,c,g,m),u.edge=$n(c,t,null,m),r.edge=$n(t,g,null,m),qn(i),qn(r)}else u.edge=$n(i.site,u.site)}}function Xn(t,e){var n=t.site,i=n.x,r=n.y,a=r-e;if(!a)return i;var o=t.P;if(!o)return-1/0;var s=(n=o.site).x,u=n.y,c=u-e;if(!c)return s;var l=s-i,h=1/a-1/c,d=l/c;return h?(-d+Math.sqrt(d*d-2*h*(l*l/(-2*c)-u+c/2+r-a/2)))/h+i:(i+s)/2}function Hn(t,e){var n=t.N;if(n)return Xn(n,e);var i=t.site;return i.y===e?i.x:1/0}function Yn(t){this.site=t,this.edges=[]}function Bn(t){for(var e=t[0][0],n=t[1][0],i=t[0][1],r=t[1][1],a,o,s,u,c=iu,l=c.length,h,d,f,g,p,x;l--;)if((h=c[l])&&h.prepare())for(g=(f=h.edges).length,d=0;d<g;)s=(x=f[d].end()).x,u=x.y,a=(p=f[++d%g].start()).x,o=p.y,(vo(s-a)>Oo||vo(u-o)>Oo)&&(f.splice(d,0,new ei(Jn(h.site,x,vo(s-e)<Oo&&Oo<r-u?{x:e,y:vo(a-e)<Oo?o:r}:vo(u-r)<Oo&&Oo<n-s?{x:vo(o-r)<Oo?a:n,y:r}:vo(s-n)<Oo&&Oo<u-i?{x:n,y:vo(a-n)<Oo?o:i}:vo(u-i)<Oo&&Oo<s-e?{x:vo(o-i)<Oo?a:e,y:i}:null),h.site,null)),++g)}function jn(t,e){return e.angle-t.angle}function Un(){ii(this),this.x=this.y=this.arc=this.site=this.cy=null}function qn(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,a=n.site;if(i!==a){var o=r.x,s=r.y,u=i.x-o,c=i.y-s,l=a.x-o,h,d=2*(u*(h=a.y-s)-c*l);if(!(-Io<=d)){var f=u*u+c*c,g=l*l+h*h,p=(h*f-c*g)/d,x=(u*g-l*f)/d,h=x+s,_=uu.pop()||new Un;_.arc=t,_.site=r,_.x=p+o,_.y=h+Math.sqrt(p*p+x*x),_.cy=h,t.circle=_;for(var v=null,y=su._;y;)if(_.y<y.y||_.y===y.y&&_.x<=y.x){if(!y.L){v=y.P;break}y=y.L}else{if(!y.R){v=y;break}y=y.R}su.insert(v,_),v||(ou=_)}}}}function Wn(t){var e=t.circle;e&&(e.P||(ou=e.N),su.remove(e),uu.push(e),ii(e),t.circle=null)}function Qn(t){for(var e=nu,n=He(t[0][0],t[0][1],t[1][0],t[1][1]),i=e.length,r;i--;)(!Zn(r=e[i],t)||!n(r)||vo(r.a.x-r.b.x)<Oo&&vo(r.a.y-r.b.y)<Oo)&&(r.a=r.b=null,e.splice(i,1))}function Zn(t,e){var n=t.b;if(n)return!0;var i=t.a,r=e[0][0],a=e[1][0],o=e[0][1],s=e[1][1],u=t.l,c=t.r,l=u.x,h=u.y,d=c.x,f=c.y,g=(l+d)/2,p=(h+f)/2,x,_;if(f===h){if(g<r||a<=g)return;if(d<l){if(i){if(i.y>=s)return}else i={x:g,y:o};n={x:g,y:s}}else{if(i){if(i.y<o)return}else i={x:g,y:s};n={x:g,y:o}}}else if(_=p-(x=(l-d)/(f-h))*g,x<-1||1<x)if(d<l){if(i){if(i.y>=s)return}else i={x:(o-_)/x,y:o};n={x:(s-_)/x,y:s}}else{if(i){if(i.y<o)return}else i={x:(s-_)/x,y:s};n={x:(o-_)/x,y:o}}else if(h<f){if(i){if(i.x>=a)return}else i={x:r,y:x*r+_};n={x:a,y:x*a+_}}else{if(i){if(i.x<r)return}else i={x:a,y:x*a+_};n={x:r,y:x*r+_}}return t.a=i,t.b=n,!0}function Kn(t,e){this.l=t,this.r=e,this.a=this.b=null}function $n(t,e,n,i){var r=new Kn(t,e);return nu.push(r),n&&ti(r,t,e,n),i&&ti(r,e,t,i),iu[t.i].edges.push(new ei(r,t,e)),iu[e.i].edges.push(new ei(r,e,t)),r}function Jn(t,e,n){var i=new Kn(t,null);return i.a=e,i.b=n,nu.push(i),i}function ti(t,e,n,i){t.a||t.b?t.l===n?t.b=i:t.a=i:(t.a=i,t.l=e,t.r=n)}function ei(t,e,n){var i=t.a,r=t.b;this.edge=t,this.site=e,this.angle=n?Math.atan2(n.y-e.y,n.x-e.x):t.l===e?Math.atan2(r.x-i.x,i.y-r.y):Math.atan2(i.x-r.x,r.y-i.y)}function ni(){this._=null}function ii(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function ri(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function ai(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function oi(t){for(;t.L;)t=t.L;return t}function si(t,e){var n=t.sort(ui).pop(),i,r,a;for(nu=[],iu=new Array(t.length),ru=new ni,su=new ni;;)if(a=ou,n&&(!a||n.y<a.y||n.y===a.y&&n.x<a.x))n.x===i&&n.y===r||(iu[n.i]=new Yn(n),zn(n),i=n.x,r=n.y),n=t.pop();else{if(!a)break;Fn(a.arc)}e&&(Qn(e),Bn(e));var o={cells:iu,edges:nu};return ru=su=nu=iu=null,o}function ui(t,e){return e.y-t.y||e.x-t.x}function ci(t,e,n){return(t.x-n.x)*(e.y-t.y)-(t.x-e.x)*(n.y-t.y)}function li(t){return t.x}function hi(t){return t.y}function di(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function fi(t,e,n,i,r,a){if(!t(e,n,i,r,a)){var o=.5*(n+r),s=.5*(i+a),u=e.nodes;u[0]&&fi(t,u[0],n,i,o,s),u[1]&&fi(t,u[1],o,i,r,s),u[2]&&fi(t,u[2],n,s,o,a),u[3]&&fi(t,u[3],o,s,r,a)}}function gi(t,v,y,m,w,S,b){var A=1/0,T;return function t(e,n,i,r,a){if(!(S<n||b<i||r<m||a<w)){if(o=e.point){var o,s=v-e.x,u=y-e.y,c=s*s+u*u;if(c<A){var l=Math.sqrt(A=c);m=v-l,w=y-l,S=v+l,b=y+l,T=o}}for(var h=e.nodes,d=.5*(n+r),f=.5*(i+a),g,p,x=(f<=y)<<1|d<=v,_=x+4;x<_;++x)if(e=h[3&x])switch(3&x){case 0:t(e,n,i,d,f);break;case 1:t(e,d,i,r,f);break;case 2:t(e,n,f,d,a);break;case 3:t(e,d,f,r,a);break}}}(t,m,w,S,b),T}function pi(t,e){t=so.rgb(t),e=so.rgb(e);var n=t.r,i=t.g,r=t.b,a=e.r-n,o=e.g-i,s=e.b-r;return function(t){return"#"+mt(Math.round(n+a*t))+mt(Math.round(i+o*t))+mt(Math.round(r+s*t))}}function xi(t,e){var n={},i={},r;for(r in t)r in e?n[r]=yi(t[r],e[r]):i[r]=t[r];for(r in e)r in t||(i[r]=e[r]);return function(t){for(r in n)i[r]=n[r](t);return i}}function _i(e,n){return e=+e,n=+n,function(t){return e*(1-t)+n*t}}function vi(t,i){var e=lu.lastIndex=hu.lastIndex=0,n,r,a,o=-1,s=[],u=[];for(t+="",i+="";(n=lu.exec(t))&&(r=hu.exec(i));)(a=r.index)>e&&(a=i.slice(e,a),s[o]?s[o]+=a:s[++o]=a),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,u.push({i:o,x:_i(n,r)})),e=hu.lastIndex;return e<i.length&&(a=i.slice(e),s[o]?s[o]+=a:s[++o]=a),s.length<2?u[0]?(i=u[0].x,function(t){return i(t)+""}):function(){return i}:(i=u.length,function(t){for(var e=0,n;e<i;++e)s[(n=u[e]).i]=n.x(t);return s.join("")})}function yi(t,e){for(var n=so.interpolators.length,i;0<=--n&&!(i=so.interpolators[n](t,e)););return i}function mi(t,e){var n=[],i=[],r=t.length,a=e.length,o=Math.min(t.length,e.length),s;for(s=0;s<o;++s)n.push(yi(t[s],e[s]));for(;s<r;++s)i[s]=t[s];for(;s<a;++s)i[s]=e[s];return function(t){for(s=0;s<o;++s)i[s]=n[s](t);return i}}function wi(e){return function(t){return t<=0?0:1<=t?1:e(t)}}function Si(e){return function(t){return 1-e(1-t)}}function bi(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}}function Ai(t){return t*t}function Ti(t){return t*t*t}function Pi(t){if(t<=0)return 0;if(1<=t)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function Ci(e){return function(t){return Math.pow(t,e)}}function Li(t){return 1-Math.cos(t*zo)}function Mi(t){return Math.pow(2,10*(t-1))}function Ei(t){return 1-Math.sqrt(1-t*t)}function Vi(e,n){var i;return arguments.length<2&&(n=.45),i=arguments.length?n/No*Math.asin(1/e):(e=1,n/4),function(t){return 1+e*Math.pow(2,-10*t)*Math.sin((t-i)*No/n)}}function Gi(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}}function ki(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function Ri(t,e){t=so.hcl(t),e=so.hcl(e);var n=t.h,i=t.c,r=t.l,a=e.h-n,o=e.c-i,s=e.l-r;return isNaN(o)&&(o=0,i=isNaN(i)?e.c:i),isNaN(a)?(a=0,n=isNaN(n)?e.h:n):180<a?a-=360:a<-180&&(a+=360),function(t){return lt(n+a*t,i+o*t,r+s*t)+""}}function Oi(t,e){t=so.hsl(t),e=so.hsl(e);var n=t.h,i=t.s,r=t.l,a=e.h-n,o=e.s-i,s=e.l-r;return isNaN(o)&&(o=0,i=isNaN(i)?e.s:i),isNaN(a)?(a=0,n=isNaN(n)?e.h:n):180<a?a-=360:a<-180&&(a+=360),function(t){return ut(n+a*t,i+o*t,r+s*t)+""}}function Ii(t,e){t=so.lab(t),e=so.lab(e);var n=t.l,i=t.a,r=t.b,a=e.l-n,o=e.a-i,s=e.b-r;return function(t){return dt(n+a*t,i+o*t,r+s*t)+""}}function Di(e,n){return n-=e,function(t){return Math.round(e+n*t)}}function Ni(t){var e=[t.a,t.b],n=[t.c,t.d],i=zi(e),r=Fi(e,n),a=zi(Xi(n,e,-r))||0;e[0]*n[1]<n[0]*e[1]&&(e[0]*=-1,e[1]*=-1,i*=-1,r*=-1),this.rotate=(i?Math.atan2(e[1],e[0]):Math.atan2(-n[0],n[1]))*Ho,this.translate=[t.e,t.f],this.scale=[i,a],this.skew=a?Math.atan2(r,a)*Ho:0}function Fi(t,e){return t[0]*e[0]+t[1]*e[1]}function zi(t){var e=Math.sqrt(Fi(t,t));return e&&(t[0]/=e,t[1]/=e),e}function Xi(t,e,n){return t[0]+=n*e[0],t[1]+=n*e[1],t}function Hi(t){return t.length?t.pop()+",":""}function Yi(t,e,n,i){if(t[0]!==e[0]||t[1]!==e[1]){var r=n.push("translate(",null,",",null,")");i.push({i:r-4,x:_i(t[0],e[0])},{i:r-2,x:_i(t[1],e[1])})}else(e[0]||e[1])&&n.push("translate("+e+")")}function Bi(t,e,n,i){t!==e?(180<t-e?e+=360:180<e-t&&(t+=360),i.push({i:n.push(Hi(n)+"rotate(",null,")")-2,x:_i(t,e)})):e&&n.push(Hi(n)+"rotate("+e+")")}function ji(t,e,n,i){t!==e?i.push({i:n.push(Hi(n)+"skewX(",null,")")-2,x:_i(t,e)}):e&&n.push(Hi(n)+"skewX("+e+")")}function Ui(t,e,n,i){if(t[0]!==e[0]||t[1]!==e[1]){var r=n.push(Hi(n)+"scale(",null,",",null,")");i.push({i:r-4,x:_i(t[0],e[0])},{i:r-2,x:_i(t[1],e[1])})}else 1===e[0]&&1===e[1]||n.push(Hi(n)+"scale("+e+")")}function qi(t,e){var r=[],a=[];return t=so.transform(t),e=so.transform(e),Yi(t.translate,e.translate,r,a),Bi(t.rotate,e.rotate,r,a),ji(t.skew,e.skew,r,a),Ui(t.scale,e.scale,r,a),t=e=null,function(t){for(var e=-1,n=a.length,i;++e<n;)r[(i=a[e]).i]=i.x(t);return r.join("")}}function Wi(e,n){return n=(n-=e=+e)||1/n,function(t){return(t-e)/n}}function Qi(e,n){return n=(n-=e=+e)||1/n,function(t){return Math.max(0,Math.min(1,(t-e)/n))}}function Zi(t){for(var e=t.source,n=t.target,i=$i(e,n),r=[e];e!==i;)e=e.parent,r.push(e);for(var a=r.length;n!==i;)r.splice(a,0,n),n=n.parent;return r}function Ki(t){for(var e=[],n=t.parent;null!=n;)e.push(t),n=(t=n).parent;return e.push(t),e}function $i(t,e){if(t===e)return t;for(var n=Ki(t),i=Ki(e),r=n.pop(),a=i.pop(),o=null;r===a;)o=r,r=n.pop(),a=i.pop();return o}function Ji(t){t.fixed|=2}function tr(t){t.fixed&=-7}function er(t){t.fixed|=4,t.px=t.x,t.py=t.y}function nr(t){t.fixed&=-5}function ir(t,e,n){var i=0,r=0;if(t.charge=0,!t.leaf)for(var a=t.nodes,o=a.length,s=-1,u;++s<o;)null!=(u=a[s])&&(ir(u,e,n),t.charge+=u.charge,i+=u.charge*u.cx,r+=u.charge*u.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var c=e*n[t.point.index];t.charge+=t.pointCharge=c,i+=c*t.point.x,r+=c*t.point.y}t.cx=i/t.charge,t.cy=r/t.charge}function rr(t,e){return so.rebind(t,e,"sort","children","value"),(t.nodes=t).links=lr,t}function ar(t,e){for(var n=[t];null!=(t=n.pop());)if(e(t),(r=t.children)&&(i=r.length))for(var i,r;0<=--i;)n.push(r[i])}function or(t,e){for(var n=[t],i=[];null!=(t=n.pop());)if(i.push(t),(o=t.children)&&(a=o.length))for(var r=-1,a,o;++r<a;)n.push(o[r]);for(;null!=(t=i.pop());)e(t)}function sr(t){return t.children}function ur(t){return t.value}function cr(t,e){return e.value-t.value}function lr(t){return so.merge(t.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function hr(t){return t.x}function dr(t){return t.y}function fr(t,e,n){t.y0=e,t.y=n}function gr(t){return so.range(t.length)}function pr(t){for(var e=-1,n=t[0].length,i=[];++e<n;)i[e]=0;return i}function xr(t){for(var e=1,n=0,i=t[0][1],r,a=t.length;e<a;++e)(r=t[e][1])>i&&(n=e,i=r);return n}function _r(t){return t.reduce(vr,0)}function vr(t,e){return t+e[1]}function yr(t,e){return mr(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function mr(t,e){for(var n=-1,i=+t[0],r=(t[1]-i)/e,a=[];++n<=e;)a[n]=r*n+i;return a}function wr(t){return[so.min(t),so.max(t)]}function Sr(t,e){return t.value-e.value}function br(t,e){var n=t._pack_next;(t._pack_next=e)._pack_prev=t,(e._pack_next=n)._pack_prev=e}function Ar(t,e){(t._pack_next=e)._pack_prev=t}function Tr(t,e){var n=e.x-t.x,i=e.y-t.y,r=t.r+e.r;return n*n+i*i<.999*r*r}function Pr(t){function e(t){i=Math.min(t.x-t.r,i),r=Math.max(t.x+t.r,r),a=Math.min(t.y-t.r,a),o=Math.max(t.y+t.r,o)}if((n=t.children)&&(f=n.length)){var n,i=1/0,r=-1/0,a=1/0,o=-1/0,s,u,c,l,h,d,f;if(n.forEach(Cr),(s=n[0]).x=-s.r,s.y=0,e(s),1<f&&((u=n[1]).x=u.r,u.y=0,e(u),2<f))for(Er(s,u,c=n[2]),e(c),br(s,c),br(s._pack_prev=c,u),u=s._pack_next,l=3;l<f;l++){Er(s,u,c=n[l]);var g=0,p=1,x=1;for(h=u._pack_next;h!==u;h=h._pack_next,p++)if(Tr(h,c)){g=1;break}if(1==g)for(d=s._pack_prev;d!==h._pack_prev&&!Tr(d,c);d=d._pack_prev,x++);g?(p<x||p==x&&u.r<s.r?Ar(s,u=h):Ar(s=d,u),l--):(br(s,c),e(u=c))}var _=(i+r)/2,v=(a+o)/2,y=0;for(l=0;l<f;l++)(c=n[l]).x-=_,c.y-=v,y=Math.max(y,c.r+Math.sqrt(c.x*c.x+c.y*c.y));t.r=y,n.forEach(Lr)}}function Cr(t){t._pack_next=t._pack_prev=t}function Lr(t){delete t._pack_next,delete t._pack_prev}function Mr(t,e,n,i){var r=t.children;if(t.x=e+=i*t.x,t.y=n+=i*t.y,t.r*=i,r)for(var a=-1,o=r.length;++a<o;)Mr(r[a],e,n,i)}function Er(t,e,n){var i=t.r+n.r,r=e.x-t.x,a=e.y-t.y;if(i&&(r||a)){var o=e.r+n.r,s=r*r+a*a,u=.5+((i*=i)-(o*=o))/(2*s),c=Math.sqrt(Math.max(0,2*o*(i+s)-(i-=s)*i-o*o))/(2*s);n.x=t.x+u*r+c*a,n.y=t.y+u*a-c*r}else n.x=t.x+i,n.y=t.y}function Vr(t,e){return t.parent==e.parent?1:2}function Gr(t){var e=t.children;return e.length?e[0]:t.t}function kr(t){var e=t.children,n;return(n=e.length)?e[n-1]:t.t}function Rr(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function Or(t){for(var e=0,n=0,i=t.children,r=i.length,a;0<=--r;)(a=i[r]).z+=e,a.m+=e,e+=a.s+(n+=a.c)}function Ir(t,e,n){return t.a.parent===e.parent?t.a:n}function Dr(t){return 1+so.max(t,function(t){return t.y})}function Nr(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}function Fr(t){var e=t.children;return e&&e.length?Fr(e[0]):t}function zr(t){var e=t.children,n;return e&&(n=e.length)?zr(e[n-1]):t}function Xr(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function Hr(t,e){var n=t.x+e[3],i=t.y+e[0],r=t.dx-e[1]-e[3],a=t.dy-e[0]-e[2];return r<0&&(n+=r/2,r=0),a<0&&(i+=a/2,a=0),{x:n,y:i,dx:r,dy:a}}function Yr(t){var e=t[0],n=t[t.length-1];return e<n?[e,n]:[n,e]}function Br(t){return t.rangeExtent?t.rangeExtent():Yr(t.range())}function jr(t,e,n,i){var r=n(t[0],t[1]),a=i(e[0],e[1]);return function(t){return a(r(t))}}function Ur(t,e){var n=0,i=t.length-1,r=t[n],a=t[i],o;return a<r&&(o=n,n=i,i=o,o=r,r=a,a=o),t[n]=e.floor(r),t[i]=e.ceil(a),t}function qr(e){return e?{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}:Su}function Wr(n,t,e,i){var r=[],a=[],o=0,s=Math.min(n.length,t.length)-1;for(n[s]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++o<=s;)r.push(e(n[o-1],n[o])),a.push(i(t[o-1],t[o]));return function(t){var e=so.bisect(n,t,1,s)-1;return a[e](r[e](t))}}function Qr(n,i,r,a){function e(){var t=2<Math.min(n.length,i.length)?Wr:jr,e=a?Qi:Wi;return s=t(n,i,e,r),u=t(i,n,e,yi),o}function o(t){return s(t)}var s,u;return o.invert=function(t){return u(t)},o.domain=function(t){return arguments.length?(n=t.map(Number),e()):n},o.range=function(t){return arguments.length?(i=t,e()):i},o.rangeRound=function(t){return o.range(t).interpolate(Di)},o.clamp=function(t){return arguments.length?(a=t,e()):a},o.interpolate=function(t){return arguments.length?(r=t,e()):r},o.ticks=function(t){return Jr(n,t)},o.tickFormat=function(t,e){return ta(n,t,e)},o.nice=function(t){return Kr(n,t),e()},o.copy=function(){return Qr(n,i,r,a)},e()}function Zr(t,e){return so.rebind(t,e,"range","rangeRound","interpolate","clamp")}function Kr(t,e){return Ur(t,qr($r(t,e)[2])),Ur(t,qr($r(t,e)[2])),t}function $r(t,e){null==e&&(e=10);var n=Yr(t),i=n[1]-n[0],r=Math.pow(10,Math.floor(Math.log(i/e)/Math.LN10)),a=e/i*r;return a<=.15?r*=10:a<=.35?r*=5:a<=.75&&(r*=2),n[0]=Math.ceil(n[0]/r)*r,n[1]=Math.floor(n[1]/r)*r+.5*r,n[2]=r,n}function Jr(t,e){return so.range.apply(so,$r(t,e))}function ta(t,e,n){var i=$r(t,e);if(n){var r=ls.exec(n);if(r.shift(),"s"===r[8]){var a=so.formatPrefix(Math.max(vo(i[0]),vo(i[1])));return r[7]||(r[7]="."+ea(a.scale(i[2]))),r[8]="f",n=so.format(r.join("")),function(t){return n(a.scale(t))+a.symbol}}r[7]||(r[7]="."+na(r[8],i)),n=r.join("")}else n=",."+ea(i[2])+"f";return so.format(n)}function ea(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function na(t,e){var n=ea(e[2]);return t in bu?Math.abs(n-ea(Math.max(vo(e[0]),vo(e[1]))))+ +("e"!==t):n-2*("%"===t)}function ia(e,u,c,l){function h(t){return(c?Math.log(t<0?0:t):-Math.log(0<t?0:-t))/Math.log(u)}function d(t){return c?Math.pow(u,t):-Math.pow(u,-t)}function r(t){return e(h(t))}return r.invert=function(t){return d(e.invert(t))},r.domain=function(t){return arguments.length?(c=0<=t[0],e.domain((l=t.map(Number)).map(h)),r):l},r.base=function(t){return arguments.length?(u=+t,e.domain(l.map(h)),r):u},r.nice=function(){var t=Ur(l.map(h),c?Math:Tu);return e.domain(t),l=t.map(d),r},r.ticks=function(){var t=Yr(l),e=[],n=t[0],i=t[1],r=Math.floor(h(n)),a=Math.ceil(h(i)),o=u%1?2:u;if(isFinite(a-r)){if(c){for(;r<a;r++)for(var s=1;s<o;s++)e.push(d(r)*s);e.push(d(r))}else for(e.push(d(r));r++<a;)for(var s=o-1;0<s;s--)e.push(d(r)*s);for(r=0;e[r]<n;r++);for(a=e.length;e[a-1]>i;a--);e=e.slice(r,a)}return e},r.tickFormat=function(t,n){if(!arguments.length)return Au;arguments.length<2?n=Au:"function"!=typeof n&&(n=so.format(n));var i=Math.max(1,u*t/r.ticks().length);return function(t){var e=t/d(Math.round(h(t)));return e*u<u-.5&&(e*=u),e<=i?n(t):""}},r.copy=function(){return ia(e.copy(),u,c,l)},Zr(r,e)}function ra(e,n,i){function r(t){return e(a(t))}var a=aa(n),o=aa(1/n);return r.invert=function(t){return o(e.invert(t))},r.domain=function(t){return arguments.length?(e.domain((i=t.map(Number)).map(a)),r):i},r.ticks=function(t){return Jr(i,t)},r.tickFormat=function(t,e){return ta(i,t,e)},r.nice=function(t){return r.domain(Kr(i,t))},r.exponent=function(t){return arguments.length?(a=aa(n=t),o=aa(1/n),e.domain(i.map(a)),r):n},r.copy=function(){return ra(e.copy(),n,i)},Zr(r,e)}function aa(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function oa(s,u){function c(t){return h[((r.get(t)||("range"===u.t?r.set(t,s.push(t)):NaN))-1)%h.length]}function l(e,n){return so.range(s.length).map(function(t){return e+n*t})}var r,h,d;return c.domain=function(t){if(!arguments.length)return s;s=[],r=new v;for(var e=-1,n=t.length,i;++e<n;)r.has(i=t[e])||r.set(i,s.push(i));return c[u.t].apply(c,u.a)},c.range=function(t){return arguments.length?(h=t,d=0,u={t:"range",a:arguments},c):h},c.rangePoints=function(t,e){arguments.length<2&&(e=0);var n=t[0],i=t[1],r=s.length<2?(n=(n+i)/2,0):(i-n)/(s.length-1+e);return h=l(n+r*e/2,r),d=0,u={t:"rangePoints",a:arguments},c},c.rangeRoundPoints=function(t,e){arguments.length<2&&(e=0);var n=t[0],i=t[1],r=s.length<2?(n=i=Math.round((n+i)/2),0):(i-n)/(s.length-1+e)|0;return h=l(n+Math.round(r*e/2+(i-n-(s.length-1+e)*r)/2),r),d=0,u={t:"rangeRoundPoints",a:arguments},c},c.rangeBands=function(t,e,n){arguments.length<2&&(e=0),arguments.length<3&&(n=e);var i=t[1]<t[0],r=t[i-0],a,o=(t[1-i]-r)/(s.length-e+2*n);return h=l(r+o*n,o),i&&h.reverse(),d=o*(1-e),u={t:"rangeBands",a:arguments},c},c.rangeRoundBands=function(t,e,n){arguments.length<2&&(e=0),arguments.length<3&&(n=e);var i=t[1]<t[0],r=t[i-0],a=t[1-i],o=Math.floor((a-r)/(s.length-e+2*n));return h=l(r+Math.round((a-r-(s.length-e)*o)/2),o),i&&h.reverse(),d=Math.round(o*(1-e)),u={t:"rangeRoundBands",a:arguments},c},c.rangeBand=function(){return d},c.rangeExtent=function(){return Yr(u.a[0])},c.copy=function(){return oa(s,u)},c.domain(s)}function sa(n,i){function e(){var t=0,e=i.length;for(a=[];++t<e;)a[t-1]=so.quantile(n,t/e);return r}function r(t){if(!isNaN(t=+t))return i[so.bisect(a,t)]}var a;return r.domain=function(t){return arguments.length?(n=t.map(c).filter(l).sort(o),e()):n},r.range=function(t){return arguments.length?(i=t,e()):i},r.quantiles=function(){return a},r.invertExtent=function(t){return(t=i.indexOf(t))<0?[NaN,NaN]:[0<t?a[t-1]:n[0],t<a.length?a[t]:n[n.length-1]]},r.copy=function(){return sa(n,i)},e()}function ua(e,n,i){function t(t){return i[Math.max(0,Math.min(o,Math.floor(a*(t-e))))]}function r(){return a=i.length/(n-e),o=i.length-1,t}var a,o;return t.domain=function(t){return arguments.length?(e=+t[0],n=+t[t.length-1],r()):[e,n]},t.range=function(t){return arguments.length?(i=t,r()):i},t.invertExtent=function(t){return[t=(t=i.indexOf(t))<0?NaN:t/a+e,t+1/a]},t.copy=function(){return ua(e,n,i)},r()}function ca(e,n){function i(t){if(t<=t)return n[so.bisect(e,t)]}return i.domain=function(t){return arguments.length?(e=t,i):e},i.range=function(t){return arguments.length?(n=t,i):n},i.invertExtent=function(t){return t=n.indexOf(t),[e[t-1],e[t]]},i.copy=function(){return ca(e,n)},i}function la(n){function e(t){return+t}return(e.invert=e).domain=e.range=function(t){return arguments.length?(n=t.map(e),e):n},e.ticks=function(t){return Jr(n,t)},e.tickFormat=function(t,e){return ta(n,t,e)},e.copy=function(){return la(n)},e}function ha(){return 0}function da(t){return t.innerRadius}function fa(t){return t.outerRadius}function ga(t){return t.startAngle}function pa(t){return t.endAngle}function xa(t){return t&&t.padAngle}function _a(t,e,n,i){return 0<(t-n)*e-(e-i)*t?0:1}function va(t,e,n,i,r){var a=t[0]-e[0],o=t[1]-e[1],s=(r?i:-i)/Math.sqrt(a*a+o*o),u=s*o,c=-s*a,l=t[0]+u,h=t[1]+c,d=e[0]+u,f=e[1]+c,g=(l+d)/2,p=(h+f)/2,x=d-l,_=f-h,v=x*x+_*_,y=n-i,m=l*f-d*h,w=(_<0?-1:1)*Math.sqrt(Math.max(0,y*y*v-m*m)),S=(m*_-x*w)/v,b=(-m*x-_*w)/v,A=(m*_+x*w)/v,T=(-m*x+_*w)/v,P=S-g,C=b-p,L=A-g,M=T-p;return L*L+M*M<P*P+C*C&&(S=A,b=T),[[S-u,b-c],[S*n/y,b*n/y]]}function ya(c){function e(t){function e(){n.push("M",f(c(i),g))}for(var n=[],i=[],r=-1,a=t.length,o,s=Pt(l),u=Pt(h);++r<a;)d.call(this,o=t[r],r)?i.push([+s.call(this,o,r),+u.call(this,o,r)]):i.length&&(e(),i=[]);return i.length&&e(),n.length?n.join(""):null}var l=Mn,h=En,d=Me,f=ma,n=f.key,g=.7;return e.x=function(t){return arguments.length?(l=t,e):l},e.y=function(t){return arguments.length?(h=t,e):h},e.defined=function(t){return arguments.length?(d=t,e):d},e.interpolate=function(t){return arguments.length?(n="function"==typeof t?f=t:(f=Vu.get(t)||ma).key,e):n},e.tension=function(t){return arguments.length?(g=t,e):g},e}function ma(t){return 1<t.length?t.join("L"):t+"Z"}function wa(t){return t.join("L")+"Z"}function Sa(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("H",(i[0]+(i=t[e])[0])/2,"V",i[1]);return 1<n&&r.push("H",i[0]),r.join("")}function ba(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("V",(i=t[e])[1],"H",i[0]);return r.join("")}function Aa(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("H",(i=t[e])[0],"V",i[1]);return r.join("")}function Ta(t,e){return t.length<4?ma(t):t[1]+La(t.slice(1,-1),Ma(t,e))}function Pa(t,e){return t.length<3?wa(t):t[0]+La((t.push(t[0]),t),Ma([t[t.length-2]].concat(t,[t[1]]),e))}function Ca(t,e){return t.length<3?ma(t):t[0]+La(t,Ma(t,e))}function La(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return ma(t);var n=t.length!=e.length,i="",r=t[0],a=t[1],o=e[0],s=o,u=1;if(n&&(i+="Q"+(a[0]-2*o[0]/3)+","+(a[1]-2*o[1]/3)+","+a[0]+","+a[1],r=t[1],u=2),1<e.length){s=e[1],a=t[u],u++,i+="C"+(r[0]+o[0])+","+(r[1]+o[1])+","+(a[0]-s[0])+","+(a[1]-s[1])+","+a[0]+","+a[1];for(var c=2;c<e.length;c++,u++)a=t[u],s=e[c],i+="S"+(a[0]-s[0])+","+(a[1]-s[1])+","+a[0]+","+a[1]}if(n){var l=t[u];i+="Q"+(a[0]+2*s[0]/3)+","+(a[1]+2*s[1]/3)+","+l[0]+","+l[1]}return i}function Ma(t,e){for(var n=[],i=(1-e)/2,r,a=t[0],o=t[1],s=1,u=t.length;++s<u;)r=a,a=o,o=t[s],n.push([i*(o[0]-r[0]),i*(o[1]-r[1])]);return n}function Ea(t){if(t.length<3)return ma(t);var e=1,n=t.length,i=t[0],r=i[0],a=i[1],o=[r,r,r,(i=t[1])[0]],s=[a,a,a,i[1]],u=[r,",",a,"L",Ra(Ru,o),",",Ra(Ru,s)];for(t.push(t[n-1]);++e<=n;)i=t[e],o.shift(),o.push(i[0]),s.shift(),s.push(i[1]),Oa(u,o,s);return t.pop(),u.push("L",i),u.join("")}function Va(t){if(t.length<4)return ma(t);for(var e=[],n=-1,i=t.length,r,a=[0],o=[0];++n<3;)r=t[n],a.push(r[0]),o.push(r[1]);for(e.push(Ra(Ru,a)+","+Ra(Ru,o)),--n;++n<i;)r=t[n],a.shift(),a.push(r[0]),o.shift(),o.push(r[1]),Oa(e,a,o);return e.join("")}function Ga(t){for(var e,n=-1,i=t.length,r=i+4,a,o=[],s=[];++n<4;)a=t[n%i],o.push(a[0]),s.push(a[1]);for(e=[Ra(Ru,o),",",Ra(Ru,s)],--n;++n<r;)a=t[n%i],o.shift(),o.push(a[0]),s.shift(),s.push(a[1]),Oa(e,o,s);return e.join("")}function ka(t,e){var n=t.length-1;if(n)for(var i=t[0][0],r=t[0][1],a=t[n][0]-i,o=t[n][1]-r,s=-1,u,c;++s<=n;)c=s/n,(u=t[s])[0]=e*u[0]+(1-e)*(i+c*a),u[1]=e*u[1]+(1-e)*(r+c*o);return Ea(t)}function Ra(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Oa(t,e,n){t.push("C",Ra(Gu,e),",",Ra(Gu,n),",",Ra(ku,e),",",Ra(ku,n),",",Ra(Ru,e),",",Ra(Ru,n))}function Ia(t,e){return(e[1]-t[1])/(e[0]-t[0])}function Da(t){for(var e=0,n=t.length-1,i=[],r=t[0],a=t[1],o=i[0]=Ia(r,a);++e<n;)i[e]=(o+(o=Ia(r=a,a=t[e+1])))/2;return i[e]=o,i}function Na(t){for(var e=[],n,i,r,a,o=Da(t),s=-1,u=t.length-1;++s<u;)n=Ia(t[s],t[s+1]),vo(n)<Oo?o[s]=o[s+1]=0:9<(a=(i=o[s]/n)*i+(r=o[s+1]/n)*r)&&(a=3*n/Math.sqrt(a),o[s]=a*i,o[s+1]=a*r);for(s=-1;++s<=u;)a=(t[Math.min(u,s+1)][0]-t[Math.max(0,s-1)][0])/(6*(1+o[s]*o[s])),e.push([a||0,o[s]*a||0]);return e}function Fa(t){return t.length<3?ma(t):t[0]+La(t,Na(t))}function za(t){for(var e,n=-1,i=t.length,r,a;++n<i;)r=(e=t[n])[0],a=e[1]-zo,
e[0]=r*Math.cos(a),e[1]=r*Math.sin(a);return t}function Xa(g){function e(t){function e(){n.push("M",m(g(r),b),S,w(g(i.reverse()),b),"Z")}for(var n=[],i=[],r=[],a=-1,o=t.length,s,u=Pt(p),c=Pt(_),l=p===x?function(){return d}:Pt(x),h=_===v?function(){return f}:Pt(v),d,f;++a<o;)y.call(this,s=t[a],a)?(i.push([d=+u.call(this,s,a),f=+c.call(this,s,a)]),r.push([+l.call(this,s,a),+h.call(this,s,a)])):i.length&&(e(),i=[],r=[]);return i.length&&e(),n.length?n.join(""):null}var p=Mn,x=Mn,_=0,v=En,y=Me,m=ma,n=m.key,w=m,S="L",b=.7;return e.x=function(t){return arguments.length?(p=x=t,e):x},e.x0=function(t){return arguments.length?(p=t,e):p},e.x1=function(t){return arguments.length?(x=t,e):x},e.y=function(t){return arguments.length?(_=v=t,e):v},e.y0=function(t){return arguments.length?(_=t,e):_},e.y1=function(t){return arguments.length?(v=t,e):v},e.defined=function(t){return arguments.length?(y=t,e):y},e.interpolate=function(t){return arguments.length?(n="function"==typeof t?m=t:(m=Vu.get(t)||ma).key,w=m.reverse||m,S=m.closed?"M":"L",e):n},e.tension=function(t){return arguments.length?(b=t,e):b},e}function Ha(t){return t.radius}function Ya(t){return[t.x,t.y]}function Ba(i){return function(){var t=i.apply(this,arguments),e=t[0],n=t[1]-zo;return[e*Math.cos(n),e*Math.sin(n)]}}function ja(){return 64}function Ua(){return"circle"}function qa(t){var e=Math.sqrt(t/Do);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function Wa(i){return function(){var t,e,n;(t=this[i])&&(n=t[e=t.active])&&(n.timer.c=null,n.timer.t=NaN,--t.count?delete t[e]:delete this[i],t.active+=.5,n.event&&n.event.interrupt.call(this,this.__data__,n.index))}}function Qa(t,e,n){return bo(t,Fu),t.namespace=e,t.id=n,t}function Za(t,i,r,a){var o=t.id,s=t.namespace;return Y(t,"function"==typeof r?function(t,e,n){t[s][o].tween.set(i,a(r.call(t,t.__data__,e,n)))}:(r=a(r),function(t){t[s][o].tween.set(i,r)}))}function Ka(t){return null==t&&(t=""),function(){this.textContent=t}}function $a(t){return null==t?"__transition__":"__transition_"+t+"__"}function Ja(a,o,r,s,t){function e(t){var e=l.delay;if(d.t=e+h,e<=t)return n(t-e);d.c=n}function n(t){var e=c.active,n=c[e];for(var i in n&&(n.timer.c=null,n.timer.t=NaN,--c.count,delete c[e],n.event&&n.event.interrupt.call(a,a.__data__,n.index)),c)if(+i<s){var r=c[i];r.timer.c=null,r.timer.t=NaN,--c.count,delete c[i]}d.c=u,Vt(function(){return d.c&&u(t||1)&&(d.c=null,d.t=NaN),1},0,h),c.active=s,l.event&&l.event.start.call(a,a.__data__,o),p=[],l.tween.forEach(function(t,e){(e=e.call(a,a.__data__,o))&&p.push(e)}),g=l.ease,f=l.duration}function u(t){for(var e=t/f,n=g(e),i=p.length;0<i;)p[--i].call(a,n);if(1<=e)return l.event&&l.event.end.call(a,a.__data__,o),--c.count?delete c[s]:delete a[r],1}var c=a[r]||(a[r]={active:0,count:0}),l=c[s],h,d,f,g,p;l||(h=t.time,d=Vt(e,0,h),l=c[s]={tween:new v,time:h,timer:d,delay:t.delay,duration:t.duration,ease:t.ease,index:o},t=null,++c.count)}function to(t,n,i){t.attr("transform",function(t){var e=n(t);return"translate("+(isFinite(e)?e:i(t))+",0)"})}function eo(t,n,i){t.attr("transform",function(t){var e=n(t);return"translate(0,"+(isFinite(e)?e:i(t))+")"})}function no(t){return t.toISOString()}function io(e,a,t){function o(t){return e(t)}function s(t,e){var n,i=(t[1]-t[0])/e,r=so.bisect(Zu,i);return r==Zu.length?[a.year,$r(t.map(function(t){return t/31536e6}),e)[2]]:r?a[i/Zu[r-1]<Zu[r]/i?r-1:r]:[Ju,$r(t,e)[2]]}return o.invert=function(t){return ro(e.invert(t))},o.domain=function(t){return arguments.length?(e.domain(t),o):e.domain().map(ro)},o.nice=function(e,n){function i(t){return!isNaN(t)&&!e.range(t,ro(+t+1),n).length}var t=o.domain(),r=Yr(t),a=null==e?s(r,10):"number"==typeof e&&s(r,e);return a&&(e=a[0],n=a[1]),o.domain(Ur(t,1<n?{floor:function(t){for(;i(t=e.floor(t));)t=ro(t-1);return t},ceil:function(t){for(;i(t=e.ceil(t));)t=ro(+t+1);return t}}:e))},o.ticks=function(t,e){var n=Yr(o.domain()),i=null==t?s(n,10):"number"==typeof t?s(n,t):!t.range&&[{range:t},e];return i&&(t=i[0],e=i[1]),t.range(n[0],ro(+n[1]+1),e<1?1:e)},o.tickFormat=function(){return t},o.copy=function(){return io(e.copy(),a,t)},Zr(o,e)}function ro(t){return new Date(t)}function ao(t){return JSON.parse(t.responseText)}function oo(t){var e=lo.createRange();return e.selectNode(lo.body),e.createContextualFragment(t.responseText)}var so={version:"3.5.17"},uo=[].slice,co=function(t){return uo.call(t)},lo=this.document;if(lo)try{co(lo.documentElement.childNodes)[0].nodeType}catch(t){co=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t[e];return n}}if(Date.now||(Date.now=function(){return+new Date}),lo)try{lo.createElement("DIV").style.setProperty("opacity",0,"")}catch(t){var ho=this.Element.prototype,fo=ho.setAttribute,go=ho.setAttributeNS,po=this.CSSStyleDeclaration.prototype,xo=po.setProperty;ho.setAttribute=function(t,e){fo.call(this,t,e+"")},ho.setAttributeNS=function(t,e,n){go.call(this,t,e,n+"")},po.setProperty=function(t,e,n){xo.call(this,t,e+"",n)}}so.ascending=o,so.descending=function(t,e){return e<t?-1:t<e?1:t<=e?0:NaN},so.min=function(t,e){var n=-1,i=t.length,r,a;if(1===arguments.length){for(;++n<i;)if(null!=(a=t[n])&&a<=a){r=a;break}for(;++n<i;)null!=(a=t[n])&&a<r&&(r=a)}else{for(;++n<i;)if(null!=(a=e.call(t,t[n],n))&&a<=a){r=a;break}for(;++n<i;)null!=(a=e.call(t,t[n],n))&&a<r&&(r=a)}return r},so.max=function(t,e){var n=-1,i=t.length,r,a;if(1===arguments.length){for(;++n<i;)if(null!=(a=t[n])&&a<=a){r=a;break}for(;++n<i;)null!=(a=t[n])&&r<a&&(r=a)}else{for(;++n<i;)if(null!=(a=e.call(t,t[n],n))&&a<=a){r=a;break}for(;++n<i;)null!=(a=e.call(t,t[n],n))&&r<a&&(r=a)}return r},so.extent=function(t,e){var n=-1,i=t.length,r,a,o;if(1===arguments.length){for(;++n<i;)if(null!=(a=t[n])&&a<=a){r=o=a;break}for(;++n<i;)null!=(a=t[n])&&(a<r&&(r=a),o<a&&(o=a))}else{for(;++n<i;)if(null!=(a=e.call(t,t[n],n))&&a<=a){r=o=a;break}for(;++n<i;)null!=(a=e.call(t,t[n],n))&&(a<r&&(r=a),o<a&&(o=a))}return[r,o]},so.sum=function(t,e){var n=0,i=t.length,r,a=-1;if(1===arguments.length)for(;++a<i;)l(r=+t[a])&&(n+=r);else for(;++a<i;)l(r=+e.call(t,t[a],a))&&(n+=r);return n},so.mean=function(t,e){var n=0,i=t.length,r,a=-1,o=i;if(1===arguments.length)for(;++a<i;)l(r=c(t[a]))?n+=r:--o;else for(;++a<i;)l(r=c(e.call(t,t[a],a)))?n+=r:--o;if(o)return n/o},so.quantile=function(t,e){var n=(t.length-1)*e+1,i=Math.floor(n),r=+t[i-1],a=n-i;return a?r+a*(t[i]-r):r},so.median=function(t,e){var n=[],i=t.length,r,a=-1;if(1===arguments.length)for(;++a<i;)l(r=c(t[a]))&&n.push(r);else for(;++a<i;)l(r=c(e.call(t,t[a],a)))&&n.push(r);if(n.length)return so.quantile(n.sort(o),.5)},so.variance=function(t,e){var n=t.length,i=0,r,a,o=0,s=-1,u=0;if(1===arguments.length)for(;++s<n;)l(r=c(t[s]))&&(o+=(a=r-i)*(r-(i+=a/++u)));else for(;++s<n;)l(r=c(e.call(t,t[s],s)))&&(o+=(a=r-i)*(r-(i+=a/++u)));if(1<u)return o/(u-1)},so.deviation=function(){var t=so.variance.apply(this,arguments);return t?Math.sqrt(t):t};var _o=t(o);so.bisectLeft=_o.left,so.bisect=so.bisectRight=_o.right,so.bisector=function(n){return t(1===n.length?function(t,e){return o(n(t),e)}:n)},so.shuffle=function(t,e,n){(i=arguments.length)<3&&(n=t.length,i<2&&(e=0));for(var i=n-e,r,a;i;)a=Math.random()*i--|0,r=t[i+e],t[i+e]=t[a+e],t[a+e]=r;return t},so.permute=function(t,e){for(var n=e.length,i=new Array(n);n--;)i[n]=t[e[n]];return i},so.pairs=function(t){for(var e=0,n=t.length-1,i,r=t[0],a=new Array(n<0?0:n);e<n;)a[e]=[i=r,r=t[++e]];return a},so.transpose=function(t){if(!(a=t.length))return[];for(var e=-1,n=so.min(t,u),i=new Array(n);++e<n;)for(var r=-1,a,o=i[e]=new Array(a);++r<a;)o[r]=t[r][e];return i},so.zip=function(){return so.transpose(arguments)},so.keys=function(t){var e=[];for(var n in t)e.push(n);return e},so.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},so.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},so.merge=function(t){for(var e=t.length,n,i=-1,r=0,a,o;++i<e;)r+=t[i].length;for(a=new Array(r);0<=--e;)for(n=(o=t[e]).length;0<=--n;)a[--r]=o[n];return a};var vo=Math.abs;so.range=function(t,e,n){if(arguments.length<3&&(n=1,arguments.length<2&&(e=t,t=0)),(e-t)/n==1/0)throw new Error("infinite range");var i=[],r=h(vo(n)),a=-1,o;if(t*=r,e*=r,(n*=r)<0)for(;(o=t+n*++a)>e;)i.push(o/r);else for(;(o=t+n*++a)<e;)i.push(o/r);return i},so.map=function(t,e){var n=new v;if(t instanceof v)t.forEach(function(t,e){n.set(t,e)});else if(Array.isArray(t)){var i=-1,r=t.length,a;if(1===arguments.length)for(;++i<r;)n.set(i,t[i]);else for(;++i<r;)n.set(e.call(t,a=t[i],i),a)}else for(var o in t)n.set(o,t[o]);return n};var yo="__proto__",mo="\0";e(v,{has:r,get:function(t){return this._[n(t)]},set:function(t,e){return this._[n(t)]=e},remove:a,keys:d,values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:i(e),value:this._[e]});return t},size:f,empty:g,forEach:function(t){for(var e in this._)t.call(this,i(e),this._[e])}}),so.nest=function(){function h(n,t,i){if(i>=f.length)return p?p.call(d,t):g?t.sort(g):t;for(var e=-1,r=t.length,a=f[i++],o,s,u,c=new v,l;++e<r;)(l=c.get(o=a(s=t[e])))?l.push(s):c.set(o,[s]);return u=n?(s=n(),function(t,e){s.set(t,h(n,e,i))}):(s={},function(t,e){s[t]=h(n,e,i)}),c.forEach(u),s}function a(t,n){if(n>=f.length)return t;var i=[],r=e[n++];return t.forEach(function(t,e){i.push({key:t,values:a(e,n)})}),r?i.sort(function(t,e){return r(t.key,e.key)}):i}var d={},f=[],e=[],g,p;return d.map=function(t,e){return h(e,t,0)},d.entries=function(t){return a(h(so.map,t,0),0)},d.key=function(t){return f.push(t),d},d.sortKeys=function(t){return e[f.length-1]=t,d},d.sortValues=function(t){return g=t,d},d.rollup=function(t){return p=t,d},d},so.set=function(t){var e=new p;if(t)for(var n=0,i=t.length;n<i;++n)e.add(t[n]);return e},e(p,{has:r,add:function(t){return this._[n(t+="")]=!0,t},remove:a,values:d,size:f,empty:g,forEach:function(t){for(var e in this._)t.call(this,i(e))}}),so.behavior={},so.rebind=function(t,e){for(var n=1,i=arguments.length,r;++n<i;)t[r=arguments[n]]=x(t,e,e[r]);return t};var wo=["webkit","ms","moz","Moz","o","O"];so.dispatch=function(){for(var t=new y,e=-1,n=arguments.length;++e<n;)t[arguments[e]]=w(t);return t},y.prototype.on=function(t,e){var n=t.indexOf("."),i="";if(0<=n&&(i=t.slice(n+1),t=t.slice(0,n)),t)return arguments.length<2?this[t].on(i):this[t].on(i,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(i,null);return this}},so.event=null,so.requote=function(t){return t.replace(So,"\\$&")};var So=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,bo={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]},Ao=function(t,e){return e.querySelector(t)},To=function(t,e){return e.querySelectorAll(t)},Po=function(t,e){var n=t.matches||t[_(t,"matchesSelector")];return(Po=function(t,e){return n.call(t,e)})(t,e)};"function"==typeof Sizzle&&(Ao=function(t,e){return Sizzle(t,e)[0]||null},To=Sizzle,Po=Sizzle.matchesSelector),so.selection=function(){return so.select(lo.documentElement)};var Co=so.selection.prototype=[];Co.select=function(t){var e=[],n,i,r,a;t=A(t);for(var o=-1,s=this.length;++o<s;){e.push(n=[]),n.parentNode=(r=this[o]).parentNode;for(var u=-1,c=r.length;++u<c;)(a=r[u])?(n.push(i=t.call(a,a.__data__,u,o)),i&&"__data__"in a&&(i.__data__=a.__data__)):n.push(null)}return b(e)},Co.selectAll=function(t){var e=[],n,i;t=T(t);for(var r=-1,a=this.length;++r<a;)for(var o=this[r],s=-1,u=o.length;++s<u;)(i=o[s])&&(e.push(n=co(t.call(i,i.__data__,s,r))),n.parentNode=i);return b(e)};var Lo="http://www.w3.org/1999/xhtml",Mo={svg:"http://www.w3.org/2000/svg",xhtml:Lo,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};so.ns={prefix:Mo,qualify:function(t){var e=t.indexOf(":"),n=t;return 0<=e&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),Mo.hasOwnProperty(n)?{space:Mo[n],local:t}:t}},Co.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node();return(t=so.ns.qualify(t)).local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(P(e,t[e]));return this}return this.each(P(t,e))},Co.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node(),i=(t=M(t)).length,r=-1;if(e=n.classList){for(;++r<i;)if(!e.contains(t[r]))return!1}else for(e=n.getAttribute("class");++r<i;)if(!L(t[r]).test(e))return!1;return!0}for(e in t)this.each(E(e,t[e]));return this}return this.each(E(t,e))},Co.style=function(t,e,n){var i=arguments.length;if(i<3){if("string"!=typeof t){for(n in i<2&&(e=""),t)this.each(G(n,t[n],e));return this}if(i<2){var r=this.node();return R(r).getComputedStyle(r,null).getPropertyValue(t)}n=""}return this.each(G(t,e,n))},Co.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(k(e,t[e]));return this}return this.each(k(t,e))},Co.text=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}:null==e?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent},Co.html=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}:null==e?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML},Co.append=function(t){return t=N(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},Co.insert=function(t,e){return t=N(t),e=A(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})},Co.remove=function(){return this.each(F)},Co.data=function(t,g){function e(t,e){var n,i=t.length,r=e.length,a=Math.min(i,r),o=new Array(r),s=new Array(r),u=new Array(i),c,l;if(g){var h=new v,d=new Array(i),f;for(n=-1;++n<i;)(c=t[n])&&(h.has(f=g.call(c,c.__data__,n))?u[n]=c:h.set(f,c),d[n]=f);for(n=-1;++n<r;)(c=h.get(f=g.call(e,l=e[n],n)))?!0!==c&&((o[n]=c).__data__=l):s[n]=z(l),h.set(f,!0);for(n=-1;++n<i;)n in d&&!0!==h.get(d[n])&&(u[n]=t[n])}else{for(n=-1;++n<a;)c=t[n],l=e[n],c?(c.__data__=l,o[n]=c):s[n]=z(l);for(;n<r;++n)s[n]=z(e[n]);for(;n<i;++n)u[n]=t[n]}s.update=o,s.parentNode=o.parentNode=u.parentNode=t.parentNode,p.push(s),x.push(o),_.push(u)}var n=-1,i=this.length,r,a;if(!arguments.length){for(t=new Array(i=(r=this[0]).length);++n<i;)(a=r[n])&&(t[n]=a.__data__);return t}var p=B([]),x=b([]),_=b([]);if("function"==typeof t)for(;++n<i;)e(r=this[n],t.call(r,r.parentNode.__data__,n));else for(;++n<i;)e(r=this[n],t);return x.enter=function(){return p},x.exit=function(){return _},x},Co.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},Co.filter=function(t){var e=[],n,i,r;"function"!=typeof t&&(t=X(t));for(var a=0,o=this.length;a<o;a++){e.push(n=[]),n.parentNode=(i=this[a]).parentNode;for(var s=0,u=i.length;s<u;s++)(r=i[s])&&t.call(r,r.__data__,s,a)&&n.push(r)}return b(e)},Co.order=function(){for(var t=-1,e=this.length;++t<e;)for(var n=this[t],i=n.length-1,r=n[i],a;0<=--i;)(a=n[i])&&(r&&r!==a.nextSibling&&r.parentNode.insertBefore(a,r),r=a);return this},Co.sort=function(t){t=H.apply(this,arguments);for(var e=-1,n=this.length;++e<n;)this[e].sort(t);return this.order()},Co.each=function(i){return Y(this,function(t,e,n){i.call(t,t.__data__,e,n)})},Co.call=function(t){var e=co(arguments);return t.apply(e[0]=this,e),this},Co.empty=function(){return!this.node()},Co.node=function(){for(var t=0,e=this.length;t<e;t++)for(var n=this[t],i=0,r=n.length;i<r;i++){var a=n[i];if(a)return a}return null},Co.size=function(){var t=0;return Y(this,function(){++t}),t};var Eo=[];so.selection.enter=B,(so.selection.enter.prototype=Eo).append=Co.append,Eo.empty=Co.empty,Eo.node=Co.node,Eo.call=Co.call,Eo.size=Co.size,Eo.select=function(t){for(var e=[],n,i,r,a,o,s=-1,u=this.length;++s<u;){r=(a=this[s]).update,e.push(n=[]),n.parentNode=a.parentNode;for(var c=-1,l=a.length;++c<l;)(o=a[c])?(n.push(r[c]=i=t.call(a.parentNode,o.__data__,c,s)),i.__data__=o.__data__):n.push(null)}return b(e)},Eo.insert=function(t,e){return arguments.length<2&&(e=j(this)),Co.insert.call(this,t,e)},so.select=function(t){var e;return"string"==typeof t?(e=[Ao(t,lo)]).parentNode=lo.documentElement:(e=[t]).parentNode=s(t),b([e])},so.selectAll=function(t){var e;return"string"==typeof t?(e=co(To(t,lo))).parentNode=lo.documentElement:(e=co(t)).parentNode=null,b([e])},Co.on=function(t,e,n){var i=arguments.length;if(i<3){if("string"!=typeof t){for(n in i<2&&(e=!1),t)this.each(U(n,t[n],e));return this}if(i<2)return(i=this.node()["__on"+t])&&i._;n=!1}return this.each(U(t,e,n))};var Vo=so.map({mouseenter:"mouseover",mouseleave:"mouseout"});lo&&Vo.forEach(function(t){"on"+t in lo&&Vo.remove(t)});var Go,ko=0;so.mouse=function(t){return Z(t,S())};var Ro=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;so.touch=function(t,e,n){if(arguments.length<3&&(n=e,e=S().changedTouches),e)for(var i=0,r=e.length,a;i<r;++i)if((a=e[i]).identifier===n)return Z(t,a)},so.behavior.drag=function(){function e(){this.on("mousedown.drag",n).on("touchstart.drag",i)}function t(f,g,p,x,_){return function(){function t(){var t=g(r,s),e,n;t&&(e=t[0]-d[0],n=t[1]-d[1],o|=e|n,a({type:"drag",x:(d=t)[0]+c[0],y:t[1]+c[1],dx:e,dy:n}))}function e(){g(r,s)&&(l.on(x+u,null).on(_+u,null),h(o),a({type:"dragend"}))}var n=this,i=so.event.target.correspondingElement||so.event.target,r=n.parentNode,a=v.of(n,arguments),o=0,s=f(),u=".drag"+(null==s?"":"-"+s),c,l=so.select(p(i)).on(x+u,t).on(_+u,e),h=Q(i),d=g(r,s);c=y?[(c=y.apply(n,arguments)).x-d[0],c.y-d[1]]:[0,0],a({type:"dragstart"})}}var v=D(e,"drag","dragstart","dragend"),y=null,n=t(m,so.mouse,R,"mousemove","mouseup"),i=t(K,so.touch,O,"touchmove","touchend");return e.origin=function(t){return arguments.length?(y=t,e):y},so.rebind(e,v,"on")},so.touches=function(n,t){return arguments.length<2&&(t=S().touches),t?co(t).map(function(t){var e=Z(n,t);return e.identifier=t.identifier,e}):[]};var Oo=1e-6,Io=Oo*Oo,Do=Math.PI,No=2*Do,Fo=No-Oo,zo=Do/2,Xo=Do/180,Ho=180/Do,Yo=Math.SQRT2,Bo=2,jo=4;so.interpolateZoom=function(t,e){var r=t[0],a=t[1],o=t[2],n=e[0],i=e[1],s=e[2],u=n-r,c=i-a,l=u*u+c*c,h,d;if(l<Io)d=Math.log(s/o)/Yo,h=function(t){return[r+t*u,a+t*c,o*Math.exp(Yo*t*d)]};else{var f=Math.sqrt(l),g=(s*s-o*o+4*l)/(2*o*2*f),p=(s*s-o*o-4*l)/(2*s*2*f),x=Math.log(Math.sqrt(g*g+1)-g),_=Math.log(Math.sqrt(p*p+1)-p);d=(_-x)/Yo,h=function(t){var e=t*d,n=it(x),i=o/(2*f)*(n*rt(Yo*e+x)-nt(x));return[r+i*u,a+i*c,o*n/it(Yo*e+x)]}}return h.duration=1e3*d,h},so.behavior.zoom=function(){function r(t){t.on(L,s).on(Wo+".zoom",i).on("dblclick.zoom",a).on(M,P)}function u(t){return[(t[0]-C.x)/C.k,(t[1]-C.y)/C.k]}function n(t){return[t[0]*C.k+C.x,t[1]*C.k+C.y]}function m(t){C.k=Math.max(d[0],Math.min(d[1],t))}function w(t,e){e=n(e),C.x+=t[0]-e[0],C.y+=t[1]-e[1]}function S(t,e,n,i){t.__chart__={x:C.x,y:C.y,k:C.k},m(Math.pow(2,i)),w(c=e,n),t=so.select(t),0<f&&(t=t.transition().duration(f)),t.call(r.event)}function e(){y&&y.domain(v.range().map(function(t){return(t-C.x)/C.k}).map(v.invert)),k&&k.domain(G.range().map(function(t){return(t-C.y)/C.k}).map(G.invert))}function b(t){g++||t({type:"zoomstart"})}function A(t){e(),t({type:"zoom",scale:C.k,translate:[C.x,C.y]})}function T(t){--g||(t({type:"zoomend"}),c=null)}function s(){function t(){r=1,w(so.mouse(n),o),A(i)}function e(){a.on(p,null).on(x,null),s(r),T(i)}var n=this,i=V.of(n,arguments),r=0,a=so.select(R(n)).on(p,t).on(x,e),o=u(so.mouse(n)),s=Q(n);Nu.call(n),b(i)}function P(){function l(){var t=so.touches(f);return x=C.k,t.forEach(function(t){t.identifier in g&&(g[t.identifier]=u(t))}),t}function t(){var t=so.event.target;so.select(t).on(_,h).on(v,d),y.push(t);for(var e=so.event.changedTouches,n=0,i=e.length;n<i;++n)g[e[n].identifier]=null;var r=l(),a=Date.now();if(1===r.length){if(a-E<500){var o=r[0];S(f,o,g[o.identifier],Math.floor(Math.log(C.k)/Math.LN2)+1),I()}E=a}else if(1<r.length){var o=r[0],s=r[1],u=o[0]-s[0],c=o[1]-s[1];p=u*u+c*c}}function h(){var t=so.touches(f),e,n,i,r;Nu.call(f);for(var a=0,o=t.length;a<o;++a,r=null)if(i=t[a],r=g[i.identifier]){if(n)break;e=i,n=r}if(r){var s=(s=i[0]-e[0])*s+(s=i[1]-e[1])*s,u=p&&Math.sqrt(s/p);e=[(e[0]+i[0])/2,(e[1]+i[1])/2],n=[(n[0]+r[0])/2,(n[1]+r[1])/2],m(u*x)}E=null,w(e,n),A(c)}function d(){if(so.event.touches.length){for(var t=so.event.changedTouches,e=0,n=t.length;e<n;++e)delete g[t[e].identifier];for(var i in g)return void l()}so.selectAll(y).on(r,null),a.on(L,s).on(M,P),o(),T(c)}var f=this,c=V.of(f,arguments),g={},p=0,x,r=".zoom-"+so.event.changedTouches[0].identifier,_="touchmove"+r,v="touchend"+r,y=[],a=so.select(f),o=Q(f);t(),b(c),a.on(L,null).on(M,t)}function i(){var t=V.of(this,arguments);_?clearTimeout(_):(Nu.call(this),o=u(c=l||so.mouse(this)),b(t)),_=setTimeout(function(){_=null,T(t)},50),I(),m(Math.pow(2,.002*qo())*C.k),w(c,o),A(t)}function a(){var t=so.mouse(this),e=Math.log(C.k)/Math.LN2;S(this,t,u(t),so.event.shiftKey?Math.ceil(e)-1:Math.floor(e)+1)}var C={x:0,y:0,k:1},o,c,l,h=[960,500],d=Uo,f=250,g=0,L="mousedown.zoom",p="mousemove.zoom",x="mouseup.zoom",_,M="touchstart.zoom",E,V=D(r,"zoomstart","zoom","zoomend"),v,y,G,k;return Wo||(Wo="onwheel"in lo?(qo=function(){return-so.event.deltaY*(so.event.deltaMode?120:1)},"wheel"):"onmousewheel"in lo?(qo=function(){return so.event.wheelDelta},"mousewheel"):(qo=function(){return-so.event.detail},"MozMousePixelScroll")),r.event=function(t){t.each(function(){var s=V.of(this,arguments),e=C;Xu?so.select(this).transition().each("start.zoom",function(){C=this.__chart__||{x:0,y:0,k:1},b(s)}).tween("zoom:zoom",function(){var i=h[0],t=h[1],r=c?c[0]:i/2,a=c?c[1]:t/2,o=so.interpolateZoom([(r-C.x)/C.k,(a-C.y)/C.k,i/C.k],[(r-e.x)/e.k,(a-e.y)/e.k,i/e.k]);return function(t){var e=o(t),n=i/e[2];this.__chart__=C={x:r-e[0]*n,y:a-e[1]*n,k:n},A(s)}}).each("interrupt.zoom",function(){T(s)}).each("end.zoom",function(){T(s)}):(this.__chart__=C,b(s),A(s),T(s))})},r.translate=function(t){return arguments.length?(C={x:+t[0],y:+t[1],k:C.k},e(),r):[C.x,C.y]},r.scale=function(t){return arguments.length?(C={x:C.x,y:C.y,k:null},m(+t),e(),r):C.k},r.scaleExtent=function(t){return arguments.length?(d=null==t?Uo:[+t[0],+t[1]],r):d},r.center=function(t){return arguments.length?(l=t&&[+t[0],+t[1]],r):l},r.size=function(t){return arguments.length?(h=t&&[+t[0],+t[1]],r):h},r.duration=function(t){return arguments.length?(f=+t,r):f},r.x=function(t){return arguments.length?(v=(y=t).copy(),C={x:0,y:0,k:1},r):y},r.y=function(t){return arguments.length?(G=(k=t).copy(),C={x:0,y:0,k:1},r):k},so.rebind(r,V,"on")};var Uo=[0,1/0],qo,Wo;(so.color=ot).prototype.toString=function(){return this.rgb()+""};var Qo=(so.hsl=st).prototype=new ot;Qo.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new st(this.h,this.s,this.l/t)},Qo.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new st(this.h,this.s,t*this.l)},Qo.rgb=function(){return ut(this.h,this.s,this.l)};var Zo=(so.hcl=ct).prototype=new ot;Zo.brighter=function(t){return new ct(this.h,this.c,Math.min(100,this.l+Ko*(arguments.length?t:1)))},Zo.darker=function(t){return new ct(this.h,this.c,Math.max(0,this.l-Ko*(arguments.length?t:1)))},Zo.rgb=function(){return lt(this.h,this.c,this.l).rgb()},so.lab=ht;var Ko=18,$o=.95047,Jo=1,ts=1.08883,es=ht.prototype=new ot;es.brighter=function(t){return new ht(Math.min(100,this.l+Ko*(arguments.length?t:1)),this.a,this.b)},es.darker=function(t){return new ht(Math.max(0,this.l-Ko*(arguments.length?t:1)),this.a,this.b)},es.rgb=function(){return dt(this.l,this.a,this.b)};var ns=(so.rgb=_t).prototype=new ot;ns.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,i=this.b,r=30;return e||n||i?(e&&e<30&&(e=30),n&&n<30&&(n=30),i&&i<30&&(i=30),new _t(Math.min(255,e/t),Math.min(255,n/t),Math.min(255,i/t))):new _t(30,30,30)},ns.darker=function(t){return new _t((t=Math.pow(.7,arguments.length?t:1))*this.r,t*this.g,t*this.b)},ns.hsl=function(){return St(this.r,this.g,this.b)},ns.toString=function(){return"#"+mt(this.r)+mt(this.g)+mt(this.b)};var is=so.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});is.forEach(function(t,e){is.set(t,vt(e))}),so.functor=Pt,so.xhr=Ct(O),so.dsv=function(r,a){function o(t,e,n){arguments.length<3&&(n=e,e=null);var i=Lt(t,a,null==e?s:u(e),n);return i.row=function(t){return arguments.length?i.response(null==(e=t)?s:u(t)):e},i}function s(t){return o.parse(t.responseText)}function u(e){return function(t){return o.parse(t.responseText,e)}}function e(t){return t.map(c).join(r)}function c(t){return n.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var n=new RegExp('["'+r+"\n]"),d=r.charCodeAt(0);return o.parse=function(t,i){var r;return o.parseRows(t,function(t,e){if(r)return r(t,e-1);var n=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");r=i?function(t,e){return i(n(t),e)}:n})},o.parseRows=function(r,t){function e(){if(s<=u)return o;if(l)return l=!1,a;var t=u;if(34===r.charCodeAt(t)){for(var e=t;e++<s;)if(34===r.charCodeAt(e)){if(34!==r.charCodeAt(e+1))break;++e}var n;return u=e+2,13===(n=r.charCodeAt(e+1))?(l=!0,10===r.charCodeAt(e+2)&&++u):10===n&&(l=!0),r.slice(t+1,e).replace(/""/g,'"')}for(;u<s;){var n,i=1;if(10===(n=r.charCodeAt(u++)))l=!0;else if(13===n)l=!0,10===r.charCodeAt(u)&&(++u,++i);else if(n!==d)continue;return r.slice(t,u-i)}return r.slice(t)}for(var a={},o={},n=[],s=r.length,u=0,i=0,c,l;(c=e())!==o;){for(var h=[];c!==a&&c!==o;)h.push(c),c=e();t&&null==(h=t(h,i++))||n.push(h)}return n},o.format=function(t){if(Array.isArray(t[0]))return o.formatRows(t);var n=new p,i=[];return t.forEach(function(t){for(var e in t)n.has(e)||i.push(n.add(e))}),[i.map(c).join(r)].concat(t.map(function(e){return i.map(function(t){return c(e[t])}).join(r)})).join("\n")},o.formatRows=function(t){return t.map(e).join("\n")},o},so.csv=so.dsv(",","text/csv"),so.tsv=so.dsv("\t","text/tab-separated-values");var rs,as,os,ss,us=this[_(this,"requestAnimationFrame")]||function(t){setTimeout(t,17)};so.timer=function(){Vt.apply(this,arguments)},so.timer.flush=function(){kt(),Rt()},so.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var cs=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"].map(It);so.formatPrefix=function(t,e){var n=0;return(t=+t)&&(t<0&&(t*=-1),e&&(t=so.round(t,Ot(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),cs[8+n/3]};var ls=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,hs=so.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=so.round(t,Ot(t,e))).toFixed(Math.max(0,Math.min(20,Ot(t*(1+1e-15),e))))}}),ds=so.time={},fs=Date;Ft.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){gs.setUTCDate.apply(this._,arguments)},setDay:function(){gs.setUTCDay.apply(this._,arguments)},setFullYear:function(){gs.setUTCFullYear.apply(this._,arguments)},setHours:function(){gs.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){gs.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){gs.setUTCMinutes.apply(this._,arguments)},setMonth:function(){gs.setUTCMonth.apply(this._,arguments)},setSeconds:function(){gs.setUTCSeconds.apply(this._,arguments)},setTime:function(){gs.setTime.apply(this._,arguments)}};var gs=Date.prototype;ds.year=zt(function(t){return(t=ds.day(t)).setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),ds.years=ds.year.range,ds.years.utc=ds.year.utc.range,ds.day=zt(function(t){var e=new fs(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),ds.days=ds.day.range,ds.days.utc=ds.day.utc.range,ds.dayOfYear=function(t){var e=ds.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(t,n){n=7-n;var e=ds[t]=zt(function(t){return(t=ds.day(t)).setDate(t.getDate()-(t.getDay()+n)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var e=ds.year(t).getDay();return Math.floor((ds.dayOfYear(t)+(e+n)%7)/7)-(e!==n)});ds[t+"s"]=e.range,ds[t+"s"].utc=e.utc.range,ds[t+"OfYear"]=function(t){var e=ds.year(t).getDay();return Math.floor((ds.dayOfYear(t)+(e+n)%7)/7)}}),ds.week=ds.sunday,ds.weeks=ds.sunday.range,ds.weeks.utc=ds.sunday.utc.range,ds.weekOfYear=ds.sundayOfYear;var ps={"-":"",_:" ",0:"0"},xs=/^\s*\d+/,_s=/^%/;so.locale=function(t){return{numberFormat:Dt(t),
timeFormat:Ht(t)}};var vs=so.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});so.format=vs.numberFormat,so.geo={},ce.prototype={s:0,t:0,add:function(t){le(t,this.t,ys),le(ys.s,this.s,this),this.s?this.t+=ys.t:this.s=ys.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var ys=new ce;so.geo.stream=function(t,e){t&&ms.hasOwnProperty(t.type)?ms[t.type](t,e):he(t,e)};var ms={Feature:function(t,e){he(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)he(n[i].geometry,e)}},ws={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){de(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)de(n[i],e,0)},Polygon:function(t,e){fe(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)fe(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)he(n[i],e)}};so.geo.area=function(t){return Ss=0,so.geo.stream(t,As),Ss};var Ss,bs=new ce,As={sphere:function(){Ss+=4*Do},point:m,lineStart:m,lineEnd:m,polygonStart:function(){bs.reset(),As.lineStart=ge},polygonEnd:function(){var t=2*bs;Ss+=t<0?4*Do+t:t,As.lineStart=As.lineEnd=As.point=m}},Ts,Ps,Cs,Ls,Ms,Es,Vs,Gs,ks,Rs,Os;so.geo.bounds=function(){function h(t,e){y.push(m=[f=t,p=t]),e<g&&(g=e),x<e&&(x=e)}function i(t,e){var n=pe([t*Xo,e*Xo]);if(v){var i=_e(v,n),r,a=_e([i[1],-i[0],0],i);me(a),a=we(a);var o=t-_,s=0<o?1:-1,u=a[0]*Ho*s,c=180<vo(o);if(c^(s*_<u&&u<s*t)){var l=a[1]*Ho;x<l&&(x=l)}else if(c^(s*_<(u=(u+360)%360-180)&&u<s*t)){var l;(l=-a[1]*Ho)<g&&(g=l)}else e<g&&(g=e),x<e&&(x=e);c?t<_?d(f,t)>d(f,p)&&(p=t):d(t,p)>d(f,p)&&(f=t):f<=p?(t<f&&(f=t),p<t&&(p=t)):_<t?d(f,t)>d(f,p)&&(p=t):d(t,p)>d(f,p)&&(f=t)}else h(t,e);v=n,_=t}function t(){w.point=i}function e(){m[0]=f,m[1]=p,w.point=h,v=null}function n(t,e){if(v){var n=t-_;l+=180<vo(n)?n+(0<n?360:-360):n}else o=t,s=e;As.point(t,e),i(t,e)}function r(){As.lineStart()}function a(){n(o,s),As.lineEnd(),vo(l)>Oo&&(f=-(p=180)),m[0]=f,m[1]=p,v=null}function d(t,e){return(e-=t)<0?e+360:e}function u(t,e){return t[0]-e[0]}function c(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var f,g,p,x,_,o,s,v,l,y,m,w={point:h,lineStart:t,lineEnd:e,polygonStart:function(){w.point=n,w.lineStart=r,w.lineEnd=a,l=0,As.polygonStart()},polygonEnd:function(){As.polygonEnd(),w.point=h,w.lineStart=t,w.lineEnd=e,bs<0?(f=-(p=180),g=-(x=90)):Oo<l?x=90:l<-Oo&&(g=-90),m[0]=f,m[1]=p}};return function(t){var e;if(x=p=-(f=g=1/0),y=[],so.geo.stream(t,w),e=y.length){y.sort(u);for(var n=1,i,r,a=[i=y[0]];n<e;++n)c((r=y[n])[0],i)||c(r[1],i)?(d(i[0],r[1])>d(i[0],i[1])&&(i[1]=r[1]),d(r[0],i[1])>d(i[0],i[1])&&(i[0]=r[0])):a.push(i=r);for(var o=-1/0,s,e,n=0,i=a[e=a.length-1],r;n<=e;i=r,++n)r=a[n],(s=d(i[1],r[0]))>o&&(o=s,f=r[0],p=i[1])}return y=m=null,f===1/0||g===1/0?[[NaN,NaN],[NaN,NaN]]:[[f,g],[p,x]]}}(),so.geo.centroid=function(t){Ts=Ps=Cs=Ls=Ms=Es=Vs=Gs=ks=Rs=Os=0,so.geo.stream(t,Is);var e=ks,n=Rs,i=Os,r=e*e+n*n+i*i;return r<Io&&(e=Es,n=Vs,i=Gs,Ps<Oo&&(e=Cs,n=Ls,i=Ms),(r=e*e+n*n+i*i)<Io)?[NaN,NaN]:[Math.atan2(n,e)*Ho,et(i/Math.sqrt(r))*Ho]};var Is={sphere:m,point:be,lineStart:Te,lineEnd:Pe,polygonStart:function(){Is.lineStart=Ce},polygonEnd:function(){Is.lineStart=Te}},Ds=ke(Me,De,Fe,[-Do,-Do/2]),Ns=1e9;so.geo.clipExtent=function(){var e,n,i,r,a,o,s={stream:function(t){return a&&(a.valid=!1),(a=o(t)).valid=!0,a},extent:function(t){return arguments.length?(o=Ye(e=+t[0][0],n=+t[0][1],i=+t[1][0],r=+t[1][1]),a&&(a.valid=!1,a=null),s):[[e,n],[i,r]]}};return s.extent([[0,0],[960,500]])},(so.geo.conicEqualArea=function(){return Be(je)}).raw=je,so.geo.albers=function(){return so.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},so.geo.albersUsa=function(){function r(t){var e=t[0],n=t[1];return i=null,c(e,n),i||(l(e,n),i)||h(e,n),i}var a=so.geo.albers(),o=so.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=so.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),i,u={point:function(t,e){i=[t,e]}},c,l,h;return r.invert=function(t){var e=a.scale(),n=a.translate(),i=(t[0]-n[0])/e,r=(t[1]-n[1])/e;return(.12<=r&&r<.234&&-.425<=i&&i<-.214?o:.166<=r&&r<.234&&-.214<=i&&i<-.115?s:a).invert(t)},r.stream=function(t){var n=a.stream(t),i=o.stream(t),r=s.stream(t);return{point:function(t,e){n.point(t,e),i.point(t,e),r.point(t,e)},sphere:function(){n.sphere(),i.sphere(),r.sphere()},lineStart:function(){n.lineStart(),i.lineStart(),r.lineStart()},lineEnd:function(){n.lineEnd(),i.lineEnd(),r.lineEnd()},polygonStart:function(){n.polygonStart(),i.polygonStart(),r.polygonStart()},polygonEnd:function(){n.polygonEnd(),i.polygonEnd(),r.polygonEnd()}}},r.precision=function(t){return arguments.length?(a.precision(t),o.precision(t),s.precision(t),r):a.precision()},r.scale=function(t){return arguments.length?(a.scale(t),o.scale(.35*t),s.scale(t),r.translate(a.translate())):a.scale()},r.translate=function(t){if(!arguments.length)return a.translate();var e=a.scale(),n=+t[0],i=+t[1];return c=a.translate(t).clipExtent([[n-.455*e,i-.238*e],[n+.455*e,i+.238*e]]).stream(u).point,l=o.translate([n-.307*e,i+.201*e]).clipExtent([[n-.425*e+Oo,i+.12*e+Oo],[n-.214*e-Oo,i+.234*e-Oo]]).stream(u).point,h=s.translate([n-.205*e,i+.212*e]).clipExtent([[n-.214*e+Oo,i+.166*e+Oo],[n-.115*e-Oo,i+.234*e-Oo]]).stream(u).point,r},r.scale(1070)};var Fs,zs,Xs={point:m,lineStart:m,lineEnd:m,polygonStart:function(){zs=0,Xs.lineStart=Ue},polygonEnd:function(){Xs.lineStart=Xs.lineEnd=Xs.point=m,Fs+=vo(zs/2)}},Hs,Ys,Bs,js,Us={point:qe,lineStart:m,lineEnd:m,polygonStart:m,polygonEnd:m},qs={point:Ze,lineStart:Ke,lineEnd:$e,polygonStart:function(){qs.lineStart=Je},polygonEnd:function(){qs.point=Ze,qs.lineStart=Ke,qs.lineEnd=$e}},Ws;so.geo.path=function(){function e(t){return t&&("function"==typeof i&&s.pointRadius(+i.apply(this,arguments)),u&&u.valid||(u=o(s)),so.geo.stream(t,u)),s.result()}function n(){return u=null,e}var i=4.5,r,a,o,s,u;return e.area=function(t){return Fs=0,so.geo.stream(t,o(Xs)),Fs},e.centroid=function(t){return Cs=Ls=Ms=Es=Vs=Gs=ks=Rs=Os=0,so.geo.stream(t,o(qs)),Os?[ks/Os,Rs/Os]:Gs?[Es/Gs,Vs/Gs]:Ms?[Cs/Ms,Ls/Ms]:[NaN,NaN]},e.bounds=function(t){return Bs=js=-(Hs=Ys=1/0),so.geo.stream(t,o(Us)),[[Hs,Ys],[Bs,js]]},e.projection=function(t){return arguments.length?(o=(r=t)?t.stream||nn(t):O,n()):r},e.context=function(t){return arguments.length?(s=null==(a=t)?new We:new tn(t),"function"!=typeof i&&s.pointRadius(i),n()):a},e.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(s.pointRadius(+t),+t),e):i},e.projection(so.geo.albersUsa()).context(null)},so.geo.transform=function(i){return{stream:function(t){var e=new rn(t);for(var n in i)e[n]=i[n];return e}}},rn.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},so.geo.projection=on,so.geo.projectionMutator=sn,(so.geo.equirectangular=function(){return on(cn)}).raw=cn.invert=cn,so.geo.rotation=function(e){function t(t){return(t=e(t[0]*Xo,t[1]*Xo))[0]*=Ho,t[1]*=Ho,t}return e=hn(e[0]%360*Xo,e[1]*Xo,2<e.length?e[2]*Xo:0),t.invert=function(t){return(t=e.invert(t[0]*Xo,t[1]*Xo))[0]*=Ho,t[1]*=Ho,t},t},ln.invert=cn,so.geo.circle=function(){function e(){var t="function"==typeof r?r.apply(this,arguments):r,n=hn(-t[0]*Xo,-t[1]*Xo,0).invert,i=[];return a(null,null,1,{point:function(t,e){i.push(t=n(t,e)),t[0]*=Ho,t[1]*=Ho}}),{type:"Polygon",coordinates:[i]}}var r=[0,0],n,i=6,a;return e.origin=function(t){return arguments.length?(r=t,e):r},e.angle=function(t){return arguments.length?(a=pn((n=+t)*Xo,i*Xo),e):n},e.precision=function(t){return arguments.length?(a=pn(n*Xo,(i=+t)*Xo),e):i},e.angle(90)},so.geo.distance=function(t,e){var n=(e[0]-t[0])*Xo,i=t[1]*Xo,r=e[1]*Xo,a=Math.sin(n),o=Math.cos(n),s=Math.sin(i),u=Math.cos(i),c=Math.sin(r),l=Math.cos(r),h;return Math.atan2(Math.sqrt((h=l*a)*h+(h=u*c-s*l*o)*h),s*c+u*l*o)},so.geo.graticule=function(){function e(){return{type:"MultiLineString",coordinates:t()}}function t(){return so.range(Math.ceil(a/d)*d,r,d).map(x).concat(so.range(Math.ceil(c/f)*f,u,f).map(_)).concat(so.range(Math.ceil(i/l)*l,n,l).filter(function(t){return vo(t%d)>Oo}).map(g)).concat(so.range(Math.ceil(s/h)*h,o,h).filter(function(t){return vo(t%f)>Oo}).map(p))}var n,i,r,a,o,s,u,c,l=10,h=l,d=90,f=360,g,p,x,_,v=2.5;return e.lines=function(){return t().map(function(t){return{type:"LineString",coordinates:t}})},e.outline=function(){return{type:"Polygon",coordinates:[x(a).concat(_(u).slice(1),x(r).reverse().slice(1),_(c).reverse().slice(1))]}},e.extent=function(t){return arguments.length?e.majorExtent(t).minorExtent(t):e.minorExtent()},e.majorExtent=function(t){return arguments.length?(a=+t[0][0],r=+t[1][0],c=+t[0][1],u=+t[1][1],r<a&&(t=a,a=r,r=t),u<c&&(t=c,c=u,u=t),e.precision(v)):[[a,c],[r,u]]},e.minorExtent=function(t){return arguments.length?(i=+t[0][0],n=+t[1][0],s=+t[0][1],o=+t[1][1],n<i&&(t=i,i=n,n=t),o<s&&(t=s,s=o,o=t),e.precision(v)):[[i,s],[n,o]]},e.step=function(t){return arguments.length?e.majorStep(t).minorStep(t):e.minorStep()},e.majorStep=function(t){return arguments.length?(d=+t[0],f=+t[1],e):[d,f]},e.minorStep=function(t){return arguments.length?(l=+t[0],h=+t[1],e):[l,h]},e.precision=function(t){return arguments.length?(v=+t,g=_n(s,o,90),p=vn(i,n,v),x=_n(c,u,90),_=vn(a,r,v),e):v},e.majorExtent([[-180,-90+Oo],[180,90-Oo]]).minorExtent([[-180,-80-Oo],[180,80+Oo]])},so.geo.greatArc=function(){function e(){return{type:"LineString",coordinates:[i||n.apply(this,arguments),a||r.apply(this,arguments)]}}var n=yn,i,r=mn,a;return e.distance=function(){return so.geo.distance(i||n.apply(this,arguments),a||r.apply(this,arguments))},e.source=function(t){return arguments.length?(i="function"==typeof(n=t)?null:t,e):n},e.target=function(t){return arguments.length?(a="function"==typeof(r=t)?null:t,e):r},e.precision=function(){return arguments.length?e:0},e},so.geo.interpolate=function(t,e){return wn(t[0]*Xo,t[1]*Xo,e[0]*Xo,e[1]*Xo)},so.geo.length=function(t){return Ws=0,so.geo.stream(t,Qs),Ws};var Qs={sphere:m,point:m,lineStart:Sn,lineEnd:m,polygonStart:m,polygonEnd:m},Zs=bn(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(so.geo.azimuthalEqualArea=function(){return on(Zs)}).raw=Zs;var Ks=bn(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},O);(so.geo.azimuthalEquidistant=function(){return on(Ks)}).raw=Ks,(so.geo.conicConformal=function(){return Be(An)}).raw=An,(so.geo.conicEquidistant=function(){return Be(Tn)}).raw=Tn;var $s=bn(function(t){return 1/t},Math.atan);(so.geo.gnomonic=function(){return on($s)}).raw=$s,Pn.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-zo]},(so.geo.mercator=function(){return Cn(Pn)}).raw=Pn;var Js=bn(function(){return 1},Math.asin);(so.geo.orthographic=function(){return on(Js)}).raw=Js;var tu=bn(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});(so.geo.stereographic=function(){return on(tu)}).raw=tu,Ln.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-zo]},(so.geo.transverseMercator=function(){var t=Cn(Ln),e=t.center,n=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return t?n([t[0],t[1],2<t.length?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90])}).raw=Ln,so.geom={},so.geom.hull=function(t){function e(t){if(t.length<3)return[];var e=Pt(d),n=Pt(f),i,r=t.length,a=[],o=[];for(i=0;i<r;i++)a.push([+e.call(this,t[i],i),+n.call(this,t[i],i),i]);for(a.sort(Gn),i=0;i<r;i++)o.push([a[i][0],-a[i][1]]);var s=Vn(a),u=Vn(o),c=u[0]===s[0],l=u[u.length-1]===s[s.length-1],h=[];for(i=s.length-1;0<=i;--i)h.push(t[a[s[i]][2]]);for(i=+c;i<u.length-l;++i)h.push(t[a[u[i]][2]]);return h}var d=Mn,f=En;return arguments.length?e(t):(e.x=function(t){return arguments.length?(d=t,e):d},e.y=function(t){return arguments.length?(f=t,e):f},e)},so.geom.polygon=function(t){return bo(t,eu),t};var eu=so.geom.polygon.prototype=[];eu.area=function(){for(var t=-1,e=this.length,n,i=this[e-1],r=0;++t<e;)n=i,i=this[t],r+=n[1]*i[0]-n[0]*i[1];return.5*r},eu.centroid=function(t){var e=-1,n=this.length,i=0,r=0,a,o=this[n-1],s;for(arguments.length||(t=-1/(6*this.area()));++e<n;)a=o,o=this[e],s=a[0]*o[1]-o[0]*a[1],i+=(a[0]+o[0])*s,r+=(a[1]+o[1])*s;return[i*t,r*t]},eu.clip=function(t){for(var e,n=On(t),i=-1,r=this.length-On(this),a,o,s=this[r-1],u,c,l;++i<r;){for(e=t.slice(),t.length=0,u=this[i],c=e[(o=e.length-n)-1],a=-1;++a<o;)kn(l=e[a],s,u)?(kn(c,s,u)||t.push(Rn(c,l,s,u)),t.push(l)):kn(c,s,u)&&t.push(Rn(c,l,s,u)),c=l;n&&t.push(t[0]),s=u}return t};var nu,iu,ru,au=[],ou,su,uu=[];Yn.prototype.prepare=function(){for(var t=this.edges,e=t.length,n;e--;)(n=t[e].edge).b&&n.a||t.splice(e,1);return t.sort(jn),t.length},ei.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},ni.prototype={insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else n=this._?(t=oi(this._),e.P=null,(e.N=t).P=t.L=e,t):(e.P=e.N=null,this._=e,null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(i=n.U).L?(r=i.R)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(ri(this,n),n=(t=n).U),n.C=!1,i.C=!0,ai(this,i)):(r=i.L)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(ai(this,n),n=(t=n).U),n.C=!1,i.C=!0,ri(this,i)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e=t.U,n,i=t.L,r=t.R,a,o;if(a=i?r?oi(r):i:r,e?e.L===t?e.L=a:e.R=a:this._=a,i&&r?(o=a.C,a.C=t.C,((a.L=i).U=a)!==r?(e=a.U,a.U=t.U,t=a.R,e.L=t,(a.R=r).U=a):(a.U=e,t=(e=a).R)):(o=t.C,t=a),t&&(t.U=e),!o)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===e.L){if((n=e.R).C&&(n.C=!1,e.C=!0,ri(this,e),n=e.R),n.L&&n.L.C||n.R&&n.R.C){n.R&&n.R.C||(n.L.C=!1,n.C=!0,ai(this,n),n=e.R),n.C=e.C,e.C=n.R.C=!1,ri(this,e),t=this._;break}}else if((n=e.L).C&&(n.C=!1,e.C=!0,ai(this,e),n=e.L),n.L&&n.L.C||n.R&&n.R.C){n.L&&n.L.C||(n.R.C=!1,n.C=!0,ri(this,n),n=e.L),n.C=e.C,e.C=n.L.C=!1,ai(this,e),t=this._;break}n.C=!0,e=(t=e).U}while(!t.C);t&&(t.C=!1)}}},so.geom.voronoi=function(t){function e(a){var o=new Array(a.length),s=h[0][0],u=h[0][1],c=h[1][0],l=h[1][1];return si(n(a),h).cells.forEach(function(t,e){var n=t.edges,i=t.site,r;(o[e]=n.length?n.map(function(t){var e=t.start();return[e.x,e.y]}):i.x>=s&&i.x<=c&&i.y>=u&&i.y<=l?[[s,l],[c,l],[c,u],[s,u]]:[]).point=a[e]}),o}function n(t){return t.map(function(t,e){return{x:Math.round(a(t,e)/Oo)*Oo,y:Math.round(o(t,e)/Oo)*Oo,i:e}})}var i=Mn,r=En,a=i,o=r,h=cu;return t?e(t):(e.links=function(e){return si(n(e)).edges.filter(function(t){return t.l&&t.r}).map(function(t){return{source:e[t.l.i],target:e[t.r.i]}})},e.triangles=function(l){var h=[];return si(n(l)).cells.forEach(function(t,e){for(var n=t.site,i=t.edges.sort(jn),r=-1,a=i.length,o,s,u=i[a-1].edge,c=u.l===n?u.r:u.l;++r<a;)o=u,s=c,c=(u=i[r].edge).l===n?u.r:u.l,e<s.i&&e<c.i&&ci(n,s,c)<0&&h.push([l[e],l[s.i],l[c.i]])}),h},e.x=function(t){return arguments.length?(a=Pt(i=t),e):i},e.y=function(t){return arguments.length?(o=Pt(r=t),e):r},e.clipExtent=function(t){return arguments.length?(h=null==t?cu:t,e):h===cu?null:h},e.size=function(t){return arguments.length?e.clipExtent(t&&[[0,0],t]):h===cu?null:h&&h[1]},e)};var cu=[[-1e6,-1e6],[1e6,1e6]];so.geom.delaunay=function(t){return so.geom.voronoi().triangles(t)},so.geom.quadtree=function(t,y,m,w,S){function e(t){function f(t,e,n,i,r,a,o,s){if(!isNaN(n)&&!isNaN(i))if(t.leaf){var u=t.x,c=t.y;if(null!=u)if(vo(u-n)+vo(c-i)<.01)h(t,e,n,i,r,a,o,s);else{var l=t.point;t.x=t.y=t.point=null,h(t,l,u,c,r,a,o,s),h(t,e,n,i,r,a,o,s)}else t.x=n,t.y=i,t.point=e}else h(t,e,n,i,r,a,o,s)}function h(t,e,n,i,r,a,o,s){var u=.5*(r+o),c=.5*(a+s),l=u<=n,h=c<=i,d=h<<1|l;t.leaf=!1,l?r=u:o=u,h?a=c:s=c,f(t=t.nodes[d]||(t.nodes[d]={leaf:!0,nodes:[],point:null,x:null,y:null}),e,n,i,r,a,o,s)}var e,n=Pt(b),i=Pt(A),r,a,o,s,u,c,l,d;if(null!=y)u=y,c=m,l=w,d=S;else if(l=d=-(u=c=1/0),r=[],a=[],s=t.length,T)for(o=0;o<s;++o)(e=t[o]).x<u&&(u=e.x),e.y<c&&(c=e.y),e.x>l&&(l=e.x),e.y>d&&(d=e.y),r.push(e.x),a.push(e.y);else for(o=0;o<s;++o){var g=+n(e=t[o],o),p=+i(e,o);g<u&&(u=g),p<c&&(c=p),l<g&&(l=g),d<p&&(d=p),r.push(g),a.push(p)}var x=l-u,_=d-c;_<x?d=c+x:l=u+_;var v={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(t){f(v,t,+n(t,++o),+i(t,o),u,c,l,d)},visit:function(t){fi(t,v,u,c,l,d)},find:function(t){return gi(v,t[0],t[1],u,c,l,d)}};if(o=-1,null==y){for(;++o<s;)f(v,t[o],r[o],a[o],u,c,l,d);--o}else t.forEach(v.add);return r=a=t=e=null,v}var b=Mn,A=En,T;return(T=arguments.length)?(b=li,A=hi,3===T&&(S=m,w=y,m=y=0),e(t)):(e.x=function(t){return arguments.length?(b=t,e):b},e.y=function(t){return arguments.length?(A=t,e):A},e.extent=function(t){return arguments.length?(null==t?y=m=w=S=null:(y=+t[0][0],m=+t[0][1],w=+t[1][0],S=+t[1][1]),e):null==y?null:[[y,m],[w,S]]},e.size=function(t){return arguments.length?(null==t?y=m=w=S=null:(y=m=0,w=+t[0],S=+t[1]),e):null==y?null:[w-y,S-m]},e)},so.interpolateRgb=pi,so.interpolateObject=xi,so.interpolateNumber=_i,so.interpolateString=vi;var lu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,hu=new RegExp(lu.source,"g");so.interpolate=yi,so.interpolators=[function(t,e){var n=typeof e;return("string"===n?is.has(e.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(e)?pi:vi:e instanceof ot?pi:Array.isArray(e)?mi:"object"===n&&isNaN(e)?xi:_i)(t,e)}],so.interpolateArray=mi;var du=function(){return O},fu=so.map({linear:du,poly:Ci,quad:function(){return Ai},cubic:function(){return Ti},sin:function(){return Li},exp:function(){return Mi},circle:function(){return Ei},elastic:Vi,back:Gi,bounce:function(){return ki}}),gu=so.map({in:O,out:Si,"in-out":bi,"out-in":function(t){return bi(Si(t))}});so.ease=function(t){var e=t.indexOf("-"),n=0<=e?t.slice(0,e):t,i=0<=e?t.slice(e+1):"in";return n=fu.get(n)||du,wi((i=gu.get(i)||O)(n.apply(null,uo.call(arguments,1))))},so.interpolateHcl=Ri,so.interpolateHsl=Oi,so.interpolateLab=Ii,so.interpolateRound=Di,so.transform=function(t){var n=lo.createElementNS(so.ns.prefix.svg,"g");return(so.transform=function(t){if(null!=t){n.setAttribute("transform",t);var e=n.transform.baseVal.consolidate()}return new Ni(e?e.matrix:pu)})(t)},Ni.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var pu={a:1,b:0,c:0,d:1,e:0,f:0};so.interpolateTransform=qi,so.layout={},so.layout.bundle=function(){return function(t){for(var e=[],n=-1,i=t.length;++n<i;)e.push(Zi(t[n]));return e}},so.layout.chord=function(){function t(){var t={},n=[],e=so.range(m),i=[],r,a,o,s,u;for(_=[],v=[],r=0,s=-1;++s<m;){for(a=0,u=-1;++u<m;)a+=y[s][u];n.push(a),i.push(so.range(m)),r+=a}for(S&&e.sort(function(t,e){return S(n[t],n[e])}),b&&i.forEach(function(t,n){t.sort(function(t,e){return b(y[n][t],y[n][e])})}),r=(No-w*m)/r,a=0,s=-1;++s<m;){for(o=a,u=-1;++u<m;){var c=e[s],l=i[c][u],h=y[c][l],d=a,f=a+=h*r;t[c+"-"+l]={index:c,subindex:l,startAngle:d,endAngle:f,value:h}}v[c]={index:c,startAngle:o,endAngle:a,value:n[c]},a+=w}for(s=-1;++s<m;)for(u=s-1;++u<m;){var g=t[s+"-"+u],p=t[u+"-"+s];(g.value||p.value)&&_.push(g.value<p.value?{source:p,target:g}:{source:g,target:p})}A&&x()}function x(){_.sort(function(t,e){return A((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}var e={},_,v,y,m,w=0,S,b,A;return e.matrix=function(t){return arguments.length?(m=(y=t)&&y.length,_=v=null,e):y},e.padding=function(t){return arguments.length?(w=t,_=v=null,e):w},e.sortGroups=function(t){return arguments.length?(S=t,_=v=null,e):S},e.sortSubgroups=function(t){return arguments.length?(b=t,_=null,e):b},e.sortChords=function(t){return arguments.length?(A=t,_&&x(),e):A},e.chords=function(){return _||t(),_},e.groups=function(){return v||t(),v},e},so.layout.force=function(){function h(c){return function(t,e,n,i){if(t.point!==c){var r=t.cx-c.x,a=t.cy-c.y,o=i-e,s=r*r+a*a;if(o*o/y<s){if(s<l){var u=t.charge/s;c.px-=r*u,c.py-=a*u}return!0}if(t.point&&s&&s<l){var u=t.pointCharge/s;c.px-=r*u,c.py-=a*u}}return!t.charge}}function t(t){t.px=so.event.x,t.py=so.event.y,r.resume()}var r={},d=so.dispatch("start","tick","end"),f,g=[1,1],e,p,x=.9,a=xu,o=_u,_=-30,l=vu,v=.1,y=.64,m=[],w=[],S,b,A;return r.tick=function(){if((p*=.99)<.005)return f=null,d.end({type:"end",alpha:p=0}),!0;var t=m.length,e=w.length,n,i,r,a,o,s,u,c,l;for(i=0;i<e;++i)a=(r=w[i]).source,(s=(c=(o=r.target).x-a.x)*c+(l=o.y-a.y)*l)&&(c*=s=p*b[i]*((s=Math.sqrt(s))-S[i])/s,l*=s,o.x-=c*(u=a.weight+o.weight?a.weight/(a.weight+o.weight):.5),o.y-=l*u,a.x+=c*(u=1-u),a.y+=l*u);if((u=p*v)&&(c=g[0]/2,l=g[1]/2,i=-1,u))for(;++i<t;)(r=m[i]).x+=(c-r.x)*u,r.y+=(l-r.y)*u;if(_)for(ir(n=so.geom.quadtree(m),p,A),i=-1;++i<t;)(r=m[i]).fixed||n.visit(h(r));for(i=-1;++i<t;)(r=m[i]).fixed?(r.x=r.px,r.y=r.py):(r.x-=(r.px-(r.px=r.x))*x,r.y-=(r.py-(r.py=r.y))*x);d.tick({type:"tick",alpha:p})},r.nodes=function(t){return arguments.length?(m=t,r):m},r.links=function(t){return arguments.length?(w=t,r):w},r.size=function(t){return arguments.length?(g=t,r):g},r.linkDistance=function(t){return arguments.length?(a="function"==typeof t?t:+t,r):a},r.distance=r.linkDistance,r.linkStrength=function(t){return arguments.length?(o="function"==typeof t?t:+t,r):o},r.friction=function(t){return arguments.length?(x=+t,r):x},r.charge=function(t){return arguments.length?(_="function"==typeof t?t:+t,r):_},r.chargeDistance=function(t){return arguments.length?(l=t*t,r):Math.sqrt(l)},r.gravity=function(t){return arguments.length?(v=+t,r):v},r.theta=function(t){return arguments.length?(y=t*t,r):Math.sqrt(y)},r.alpha=function(t){return arguments.length?(t=+t,p?0<t?p=t:(f.c=null,f.t=NaN,f=null,d.end({type:"end",alpha:p=0})):0<t&&(d.start({type:"start",alpha:p=t}),f=Vt(r.tick)),r):p},r.start=function(){function t(t,e){if(!l){for(l=new Array(u),r=0;r<u;++r)l[r]=[];for(r=0;r<c;++r){var n=w[r];l[n.source.index].push(n.target),l[n.target.index].push(n.source)}}for(var i=l[s],r=-1,a=i.length,o;++r<a;)if(!isNaN(o=i[r][t]))return o;return Math.random()*e}var s,u=m.length,c=w.length,e=g[0],n=g[1],l,i;for(s=0;s<u;++s)(i=m[s]).index=s,i.weight=0;for(s=0;s<c;++s)"number"==typeof(i=w[s]).source&&(i.source=m[i.source]),"number"==typeof i.target&&(i.target=m[i.target]),++i.source.weight,++i.target.weight;for(s=0;s<u;++s)i=m[s],isNaN(i.x)&&(i.x=t("x",e)),isNaN(i.y)&&(i.y=t("y",n)),isNaN(i.px)&&(i.px=i.x),isNaN(i.py)&&(i.py=i.y);if(S=[],"function"==typeof a)for(s=0;s<c;++s)S[s]=+a.call(this,w[s],s);else for(s=0;s<c;++s)S[s]=a;if(b=[],"function"==typeof o)for(s=0;s<c;++s)b[s]=+o.call(this,w[s],s);else for(s=0;s<c;++s)b[s]=o;if(A=[],"function"==typeof _)for(s=0;s<u;++s)A[s]=+_.call(this,m[s],s);else for(s=0;s<u;++s)A[s]=_;return r.resume()},r.resume=function(){return r.alpha(.1)},r.stop=function(){return r.alpha(0)},r.drag=function(){if(e||(e=so.behavior.drag().origin(O).on("dragstart.force",Ji).on("drag.force",t).on("dragend.force",tr)),!arguments.length)return e;this.on("mouseover.force",er).on("mouseout.force",nr).call(e)},so.rebind(r,d,"on")};var xu=20,_u=1,vu=1/0;so.layout.hierarchy=function(){function s(t){var e=[t],n=[],i;for(t.depth=0;null!=(i=e.pop());)if(n.push(i),(a=c.call(s,i,i.depth))&&(r=a.length)){for(var r,a,o;0<=--r;)e.push(o=a[r]),o.parent=i,o.depth=i.depth+1;l&&(i.value=0),i.children=a}else l&&(i.value=+l.call(s,i,i.depth)||0),delete i.children;return or(t,function(t){var e,n;u&&(e=t.children)&&e.sort(u),l&&(n=t.parent)&&(n.value+=t.value)}),n}var u=cr,c=sr,l=ur;return s.sort=function(t){return arguments.length?(u=t,s):u},s.children=function(t){return arguments.length?(c=t,s):c},s.value=function(t){return arguments.length?(l=t,s):l},s.revalue=function(t){return l&&(ar(t,function(t){t.children&&(t.value=0)}),or(t,function(t){var e;t.children||(t.value=+l.call(s,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value)})),t},s},so.layout.partition=function(){function c(t,e,n,i){var r=t.children;if(t.x=e,t.y=t.depth*i,t.dx=n,t.dy=i,r&&(o=r.length)){var a=-1,o,s,u;for(n=t.value?n/t.value:0;++a<o;)c(s=r[a],e,u=s.value*n,i),e+=u}}function a(t){var e=t.children,n=0;if(e&&(r=e.length))for(var i=-1,r;++i<r;)n=Math.max(n,a(e[i]));return 1+n}function e(t,e){var n=i.call(this,t,e);return c(n[0],0,r[0],r[1]/a(n[0])),n}var i=so.layout.hierarchy(),r=[1,1];return e.size=function(t){return arguments.length?(r=t,e):r},rr(e,i)},so.layout.pie=function(){function d(n){var t=n.length,i=n.map(function(t,e){return+f.call(d,t,e)}),e=+("function"==typeof p?p.apply(this,arguments):p),r=("function"==typeof x?x.apply(this,arguments):x)-e,a=Math.min(Math.abs(r)/t,+("function"==typeof _?_.apply(this,arguments):_)),o=a*(r<0?-1:1),s=so.sum(i),u=s?(r-t*o)/s:0,c=so.range(t),l=[],h;return null!=g&&c.sort(g===yu?function(t,e){return i[e]-i[t]}:function(t,e){return g(n[t],n[e])}),c.forEach(function(t){l[t]={data:n[t],value:h=i[t],startAngle:e,endAngle:e+=h*u+o,padAngle:a}}),l}var f=Number,g=yu,p=0,x=No,_=0;return d.value=function(t){return arguments.length?(f=t,d):f},d.sort=function(t){return arguments.length?(g=t,d):g},d.startAngle=function(t){return arguments.length?(p=t,d):p},d.endAngle=function(t){return arguments.length?(x=t,d):x},d.padAngle=function(t){return arguments.length?(_=t,d):_},d};var yu={};so.layout.stack=function(){function h(t,e){if(!(s=t.length))return t;var n=t.map(function(t,e){return d.call(h,t,e)}),i=n.map(function(t){return t.map(function(t,e){return[x.call(h,t,e),_.call(h,t,e)]})}),r=f.call(h,i,e);n=so.permute(n,r),i=so.permute(i,r);var a=g.call(h,i,e),o=n[0].length,s,u,c,l;for(c=0;c<o;++c)for(p.call(h,n[0][c],l=a[c],i[0][c][1]),u=1;u<s;++u)p.call(h,n[u][c],l+=i[u-1][c][1],i[u][c][1]);return t}var d=O,f=gr,g=pr,p=fr,x=hr,_=dr;return h.values=function(t){return arguments.length?(d=t,h):d},h.order=function(t){return arguments.length?(f="function"==typeof t?t:mu.get(t)||gr,h):f},h.offset=function(t){return arguments.length?(g="function"==typeof t?t:wu.get(t)||pr,h):g},h.x=function(t){return arguments.length?(x=t,h):x},h.y=function(t){return arguments.length?(_=t,h):_},h.out=function(t){return arguments.length?(p=t,h):p},h};var mu=so.map({"inside-out":function(t){var e=t.length,n,i,r=t.map(xr),a=t.map(_r),o=so.range(e).sort(function(t,e){return r[t]-r[e]}),s=0,u=0,c=[],l=[];for(n=0;n<e;++n)i=o[n],s<u?(s+=a[i],c.push(i)):(u+=a[i],l.push(i));return l.reverse().concat(c)},reverse:function(t){return so.range(t.length).reverse()},default:gr}),wu=so.map({silhouette:function(t){var e=t.length,n=t[0].length,i=[],r=0,a,o,s,u=[];for(o=0;o<n;++o){for(s=a=0;a<e;a++)s+=t[a][o][1];r<s&&(r=s),i.push(s)}for(o=0;o<n;++o)u[o]=(r-i[o])/2;return u},wiggle:function(t){var e=t.length,n=t[0],i=n.length,r,a,o,s,u,c,l,h,d,f=[];for(f[0]=h=d=0,a=1;a<i;++a){for(s=r=0;r<e;++r)s+=t[r][a][1];for(u=r=0,l=n[a][0]-n[a-1][0];r<e;++r){for(o=0,c=(t[r][a][1]-t[r][a-1][1])/(2*l);o<r;++o)c+=(t[o][a][1]-t[o][a-1][1])/l;u+=c*t[r][a][1]}f[a]=h-=s?u/s*l:0,h<d&&(d=h)}for(a=0;a<i;++a)f[a]-=d;return f},expand:function(t){var e=t.length,n=t[0].length,i=1/e,r,a,o,s=[];for(a=0;a<n;++a){for(o=r=0;r<e;r++)o+=t[r][a][1];if(o)for(r=0;r<e;r++)t[r][a][1]/=o;else for(r=0;r<e;r++)t[r][a][1]=i}for(a=0;a<n;++a)s[a]=0;return s},zero:pr});so.layout.histogram=function(){function n(t,e){for(var n=[],i=t.map(d,this),r=f.call(this,i,e),a=g.call(this,r,i,e),o,e=-1,s=i.length,u=a.length-1,c=h?1:1/s,l;++e<u;)(o=n[e]=[]).dx=a[e+1]-(o.x=a[e]),o.y=0;if(0<u)for(e=-1;++e<s;)(l=i[e])>=r[0]&&l<=r[1]&&((o=n[so.bisect(a,l,1,u)-1]).y+=c,o.push(t[e]));return n}var h=!0,d=Number,f=wr,g=yr;return n.value=function(t){return arguments.length?(d=t,n):d},n.range=function(t){return arguments.length?(f=Pt(t),n):f},n.bins=function(e){return arguments.length?(g="number"==typeof e?function(t){return mr(t,e)}:Pt(e),n):g},n.frequency=function(t){return arguments.length?(h=!!t,n):h},n},so.layout.pack=function(){function e(t,e){var n=u.call(this,t,e),i=n[0],r=l[0],a=l[1],o=null==h?Math.sqrt:"function"==typeof h?h:function(){return h};if(i.x=i.y=0,or(i,function(t){t.r=+o(t.value)}),or(i,Pr),c){var s=c*(h?1:Math.max(2*i.r/r,2*i.r/a))/2;or(i,function(t){t.r+=s}),or(i,Pr),or(i,function(t){t.r-=s})}return Mr(i,r/2,a/2,h?1:1/Math.max(2*i.r/r,2*i.r/a)),n}var u=so.layout.hierarchy().sort(Sr),c=0,l=[1,1],h;return e.size=function(t){return arguments.length?(l=t,e):l},e.radius=function(t){return arguments.length?(h=null==t||"function"==typeof t?t:+t,e):h},e.padding=function(t){return arguments.length?(c=+t,e):c},rr(e,u)},so.layout.tree=function(){function e(t,e){var n=p.call(this,t,e),i=n[0],r=h(i);if(or(r,d),r.parent.m=-r.z,ar(r,f),v)ar(i,g);else{var a=i,o=i,s=i;ar(i,function(t){t.x<a.x&&(a=t),t.x>o.x&&(o=t),t.depth>s.depth&&(s=t)});var u=x(a,o)/2-a.x,c=_[0]/(o.x+x(o,a)/2+u),l=_[1]/(s.depth||1);ar(i,function(t){t.x=(t.x+u)*c,t.y=t.depth*l})}return n}function h(t){for(var e={A:null,children:[t]},n=[e],i;null!=(i=n.pop());)for(var r=i.children,a,o=0,s=r.length;o<s;++o)n.push((r[o]=a={_:r[o],parent:i,children:(a=r[o].children)&&a.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=a);return e.children[0]}function d(t){var e=t.children,n=t.parent.children,i=t.i?n[t.i-1]:null;if(e.length){Or(t);var r=(e[0].z+e[e.length-1].z)/2;i?(t.z=i.z+x(t._,i._),t.m=t.z-r):t.z=r}else i&&(t.z=i.z+x(t._,i._));t.parent.A=a(t,i,t.parent.A||n[0])}function f(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function a(t,e,n){if(e){for(var i=t,r=t,a=e,o=i.parent.children[0],s=i.m,u=r.m,c=a.m,l=o.m,h;a=kr(a),i=Gr(i),a&&i;)o=Gr(o),(r=kr(r)).a=t,0<(h=a.z+c-i.z-s+x(a._,i._))&&(Rr(Ir(a,t,n),t,h),s+=h,u+=h),c+=a.m,s+=i.m,l+=o.m,u+=r.m;a&&!kr(r)&&(r.t=a,r.m+=c-u),i&&!Gr(o)&&(o.t=i,o.m+=s-l,n=t)}return n}function g(t){t.x*=_[0],t.y=t.depth*_[1]}var p=so.layout.hierarchy().sort(null).value(null),x=Vr,_=[1,1],v=null;return e.separation=function(t){return arguments.length?(x=t,e):x},e.size=function(t){return arguments.length?(v=null==(_=t)?g:null,e):v?null:_},e.nodeSize=function(t){return arguments.length?(v=null==(_=t)?null:g,e):v?_:null},rr(e,p)},so.layout.cluster=function(){function e(t,e){var n=l.call(this,t,e),i=n[0],r,a=0;or(i,function(t){var e=t.children;e&&e.length?(t.x=Nr(e),t.y=Dr(e)):(t.x=r?a+=h(t,r):0,t.y=0,r=t)});var o=Fr(i),s=zr(i),u=o.x-h(o,s)/2,c=s.x+h(s,o)/2;return or(i,f?function(t){t.x=(t.x-i.x)*d[0],t.y=(i.y-t.y)*d[1]}:function(t){t.x=(t.x-u)/(c-u)*d[0],t.y=(1-(i.y?t.y/i.y:1))*d[1]}),n}var l=so.layout.hierarchy().sort(null).value(null),h=Vr,d=[1,1],f=!1;return e.separation=function(t){return arguments.length?(h=t,e):h},e.size=function(t){return arguments.length?(f=null==(d=t),e):f?null:d},e.nodeSize=function(t){return arguments.length?(f=null!=(d=t),e):f?d:null},rr(e,l)},so.layout.treemap=function(){function l(t,e){for(var n=-1,i=t.length,r,a;++n<i;)a=(r=t[n]).value*(e<0?0:e),r.area=isNaN(a)||a<=0?0:a}function h(t){var e=t.children;if(e&&e.length){var n=p(t),i=[],r=e.slice(),a,o=1/0,s,u="slice"===x?n.dx:"dice"===x?n.dy:"slice-dice"===x?1&t.depth?n.dy:n.dx:Math.min(n.dx,n.dy),c;for(l(r,n.dx*n.dy/t.value),i.area=0;0<(c=r.length);)i.push(a=r[c-1]),i.area+=a.area,o="squarify"!==x||(s=d(i,u))<=o?(r.pop(),s):(i.area-=i.pop().area,f(i,u,n,!1),u=Math.min(n.dx,n.dy),i.length=i.area=0,1/0);i.length&&(f(i,u,n,!0),i.length=i.area=0),e.forEach(h)}}function o(t){var e=t.children;if(e&&e.length){var n=p(t),i=e.slice(),r,a=[];for(l(i,n.dx*n.dy/t.value),a.area=0;r=i.pop();)a.push(r),
a.area+=r.area,null!=r.z&&(f(a,r.z?n.dx:n.dy,n,!i.length),a.length=a.area=0);e.forEach(o)}}function d(t,e){for(var n=t.area,i,r=0,a=1/0,o=-1,s=t.length;++o<s;)(i=t[o].area)&&(i<a&&(a=i),r<i&&(r=i));return e*=e,(n*=n)?Math.max(e*r*_/n,n/(e*a*_)):1/0}function f(t,e,n,i){var r=-1,a=t.length,o=n.x,s=n.y,u=e?g(t.area/e):0,c;if(e==n.dx){for((i||u>n.dy)&&(u=n.dy);++r<a;)(c=t[r]).x=o,c.y=s,c.dy=u,o+=c.dx=Math.min(n.x+n.dx-o,u?g(c.area/u):0);c.z=!0,c.dx+=n.x+n.dx-o,n.y+=u,n.dy-=u}else{for((i||u>n.dx)&&(u=n.dx);++r<a;)(c=t[r]).x=o,c.y=s,c.dx=u,s+=c.dy=Math.min(n.y+n.dy-s,u?g(c.area/u):0);c.z=!1,c.dy+=n.y+n.dy-s,n.x+=u,n.dx-=u}}function r(t){var e=c||i(t),n=e[0];return n.x=n.y=0,n.value?(n.dx=a[0],n.dy=a[1]):n.dx=n.dy=0,c&&i.revalue(n),l([n],n.dx*n.dy/n.value),(c?o:h)(n),u&&(c=e),e}var i=so.layout.hierarchy(),g=Math.round,a=[1,1],s=null,p=Xr,u=!1,c,x="squarify",_=.5*(1+Math.sqrt(5));return r.size=function(t){return arguments.length?(a=t,r):a},r.padding=function(n){function t(t){var e=n.call(r,t,t.depth);return null==e?Xr(t):Hr(t,"number"==typeof e?[e,e,e,e]:e)}function e(t){return Hr(t,n)}return arguments.length?(p=null==(s=n)?Xr:"function"==(i=typeof n)?t:("number"===i&&(n=[n,n,n,n]),e),r):s;var i},r.round=function(t){return arguments.length?(g=t?Math.round:Number,r):g!=Number},r.sticky=function(t){return arguments.length?(u=t,c=null,r):u},r.ratio=function(t){return arguments.length?(_=t,r):_},r.mode=function(t){return arguments.length?(x=t+"",r):x},rr(r,i)},so.random={normal:function(i,r){var t=arguments.length;return t<2&&(r=1),t<1&&(i=0),function(){for(var t,e,n;!(n=(t=2*Math.random()-1)*t+(e=2*Math.random()-1)*e)||1<n;);return i+r*t*Math.sqrt(-2*Math.log(n)/n)}},logNormal:function(){var t=so.random.normal.apply(so,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=so.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(n){return function(){for(var t=0,e=0;e<n;e++)t+=Math.random();return t}}},so.scale={};var Su={floor:O,ceil:O};so.scale.linear=function(){return Qr([0,1],[0,1],yi,!1)};var bu={s:1,g:1,p:1,r:1,e:1};so.scale.log=function(){return ia(so.scale.linear().domain([0,1]),10,!0,[1,10])};var Au=so.format(".0e"),Tu={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};so.scale.pow=function(){return ra(so.scale.linear(),1,[0,1])},so.scale.sqrt=function(){return so.scale.pow().exponent(.5)},so.scale.ordinal=function(){return oa([],{t:"range",a:[[]]})},so.scale.category10=function(){return so.scale.ordinal().range(Pu)},so.scale.category20=function(){return so.scale.ordinal().range(Cu)},so.scale.category20b=function(){return so.scale.ordinal().range(Lu)},so.scale.category20c=function(){return so.scale.ordinal().range(Mu)};var Pu=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(yt),Cu=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(yt),Lu=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(yt),Mu=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(yt);so.scale.quantile=function(){return sa([],[])},so.scale.quantize=function(){return ua(0,1,[0,1])},so.scale.threshold=function(){return ca([.5],[0,1])},so.scale.identity=function(){return la([0,1])},so.svg={},so.svg.arc=function(){function e(){var t=Math.max(0,+F.apply(this,arguments)),e=Math.max(0,+z.apply(this,arguments)),n=Y.apply(this,arguments)-zo,i=B.apply(this,arguments)-zo,r=Math.abs(i-n),a=i<n?0:1;if(e<t&&(o=e,e=t,t=o),Fo<=r)return N(e,a)+(t?N(t,1-a):"")+"Z";var o,s,u,c,l=0,h=0,d,f,g,p,x,_,v,y,m=[];if((c=(+j.apply(this,arguments)||0)/2)&&(u=H===Eu?Math.sqrt(t*t+e*e):+H.apply(this,arguments),a||(h*=-1),e&&(h=et(u/e*Math.sin(c))),t&&(l=et(u/t*Math.sin(c)))),e){d=e*Math.cos(n+h),f=e*Math.sin(n+h),g=e*Math.cos(i-h),p=e*Math.sin(i-h);var w=Math.abs(i-n-2*h)<=Do?0:1;if(h&&_a(d,f,g,p)===a^w){var S=(n+i)/2;d=e*Math.cos(S),f=e*Math.sin(S),g=p=null}}else d=f=0;if(t){x=t*Math.cos(i-l),_=t*Math.sin(i-l),v=t*Math.cos(n+l),y=t*Math.sin(n+l);var b=Math.abs(n-i+2*l)<=Do?0:1;if(l&&_a(x,_,v,y)===1-a^b){var A=(n+i)/2;x=t*Math.cos(A),_=t*Math.sin(A),v=y=null}}else x=_=0;if(Oo<r&&.001<(o=Math.min(Math.abs(e-t)/2,+X.apply(this,arguments)))){s=t<e^a?0:1;var T=o,P=o;if(r<Do){var C=null==v?[x,_]:null==g?[d,f]:Rn([d,f],[v,y],[g,p],[x,_]),L=d-C[0],M=f-C[1],E=g-C[0],V=p-C[1],G=1/Math.sin(Math.acos((L*E+M*V)/(Math.sqrt(L*L+M*M)*Math.sqrt(E*E+V*V)))/2),k=Math.sqrt(C[0]*C[0]+C[1]*C[1]);P=Math.min(o,(t-k)/(G-1)),T=Math.min(o,(e-k)/(G+1))}if(null!=g){var R=va(null==v?[x,_]:[v,y],[d,f],e,T,a),O=va([g,p],[x,_],e,T,a);o===T?m.push("M",R[0],"A",T,",",T," 0 0,",s," ",R[1],"A",e,",",e," 0 ",1-a^_a(R[1][0],R[1][1],O[1][0],O[1][1]),",",a," ",O[1],"A",T,",",T," 0 0,",s," ",O[0]):m.push("M",R[0],"A",T,",",T," 0 1,",s," ",O[0])}else m.push("M",d,",",f);if(null!=v){var I=va([d,f],[v,y],t,-P,a),D=va([x,_],null==g?[d,f]:[g,p],t,-P,a);o===P?m.push("L",D[0],"A",P,",",P," 0 0,",s," ",D[1],"A",t,",",t," 0 ",a^_a(D[1][0],D[1][1],I[1][0],I[1][1]),",",1-a," ",I[1],"A",P,",",P," 0 0,",s," ",I[0]):m.push("L",D[0],"A",P,",",P," 0 0,",s," ",I[0])}else m.push("L",x,",",_)}else m.push("M",d,",",f),null!=g&&m.push("A",e,",",e," 0 ",w,",",a," ",g,",",p),m.push("L",x,",",_),null!=v&&m.push("A",t,",",t," 0 ",b,",",1-a," ",v,",",y);return m.push("Z"),m.join("")}function N(t,e){return"M0,"+t+"A"+t+","+t+" 0 1,"+e+" 0,"+-t+"A"+t+","+t+" 0 1,"+e+" 0,"+t}var F=da,z=fa,X=ha,H=Eu,Y=ga,B=pa,j=xa;return e.innerRadius=function(t){return arguments.length?(F=Pt(t),e):F},e.outerRadius=function(t){return arguments.length?(z=Pt(t),e):z},e.cornerRadius=function(t){return arguments.length?(X=Pt(t),e):X},e.padRadius=function(t){return arguments.length?(H=t==Eu?Eu:Pt(t),e):H},e.startAngle=function(t){return arguments.length?(Y=Pt(t),e):Y},e.endAngle=function(t){return arguments.length?(B=Pt(t),e):B},e.padAngle=function(t){return arguments.length?(j=Pt(t),e):j},e.centroid=function(){var t=(+F.apply(this,arguments)+ +z.apply(this,arguments))/2,e=(+Y.apply(this,arguments)+ +B.apply(this,arguments))/2-zo;return[Math.cos(e)*t,Math.sin(e)*t]},e};var Eu="auto";so.svg.line=function(){return ya(O)};var Vu=so.map({linear:ma,"linear-closed":wa,step:Sa,"step-before":ba,"step-after":Aa,basis:Ea,"basis-open":Va,"basis-closed":Ga,bundle:ka,cardinal:Ca,"cardinal-open":Ta,"cardinal-closed":Pa,monotone:Fa});Vu.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var Gu=[0,2/3,1/3,0],ku=[0,1/3,2/3,0],Ru=[0,1/6,2/3,1/6];so.svg.line.radial=function(){var t=ya(za);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},(ba.reverse=Aa).reverse=ba,so.svg.area=function(){return Xa(O)},so.svg.area.radial=function(){var t=Xa(za);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},so.svg.chord=function(){function e(t,e){var n=r(this,u,t,e),i=r(this,c,t,e);return"M"+n.p0+o(n.r,n.p1,n.a1-n.a0)+(a(n,i)?s(n.r,n.p1,n.r,n.p0):s(n.r,n.p1,i.r,i.p0)+o(i.r,i.p1,i.a1-i.a0)+s(i.r,i.p1,n.r,n.p0))+"Z"}function r(t,e,n,i){var r=e.call(t,n,i),a=l.call(t,r,i),o=h.call(t,r,i)-zo,s=d.call(t,r,i)-zo;return{r:a,a0:o,a1:s,p0:[a*Math.cos(o),a*Math.sin(o)],p1:[a*Math.cos(s),a*Math.sin(s)]}}function a(t,e){return t.a0==e.a0&&t.a1==e.a1}function o(t,e,n){return"A"+t+","+t+" 0 "+ +(Do<n)+",1 "+e}function s(t,e,n,i){return"Q 0,0 "+i}var u=yn,c=mn,l=Ha,h=ga,d=pa;return e.radius=function(t){return arguments.length?(l=Pt(t),e):l},e.source=function(t){return arguments.length?(u=Pt(t),e):u},e.target=function(t){return arguments.length?(c=Pt(t),e):c},e.startAngle=function(t){return arguments.length?(h=Pt(t),e):h},e.endAngle=function(t){return arguments.length?(d=Pt(t),e):d},e},so.svg.diagonal=function(){function e(t,e){var n=o.call(this,t,e),i=s.call(this,t,e),r=(n.y+i.y)/2,a=[n,{x:n.x,y:r},{x:i.x,y:r},i];return"M"+(a=a.map(u))[0]+"C"+a[1]+" "+a[2]+" "+a[3]}var o=yn,s=mn,u=Ya;return e.source=function(t){return arguments.length?(o=Pt(t),e):o},e.target=function(t){return arguments.length?(s=Pt(t),e):s},e.projection=function(t){return arguments.length?(u=t,e):u},e},so.svg.diagonal.radial=function(){var t=so.svg.diagonal(),e=Ya,n=t.projection;return t.projection=function(t){return arguments.length?n(Ba(e=t)):e},t},so.svg.symbol=function(){function e(t,e){return(Ou.get(n.call(this,t,e))||qa)(i.call(this,t,e))}var n=Ua,i=ja;return e.type=function(t){return arguments.length?(n=Pt(t),e):n},e.size=function(t){return arguments.length?(i=Pt(t),e):i},e};var Ou=so.map({circle:qa,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*Du)),n=e*Du;return"M0,"+-e+"L"+n+",0 0,"+e+" "+-n+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/Iu),n=e*Iu/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/Iu),n=e*Iu/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});so.svg.symbolTypes=Ou.keys();var Iu=Math.sqrt(3),Du=Math.tan(30*Xo);Co.transition=function(t){for(var e=Xu||++zu,n=$a(t),i=[],r,a,o=Hu||{time:Date.now(),ease:Pi,delay:0,duration:250},s=-1,u=this.length;++s<u;){i.push(r=[]);for(var c=this[s],l=-1,h=c.length;++l<h;)(a=c[l])&&Ja(a,l,n,e,o),r.push(a)}return Qa(i,n,e)},Co.interrupt=function(t){return this.each(null==t?Nu:Wa($a(t)))};var Nu=Wa($a()),Fu=[],zu=0,Xu,Hu;Fu.call=Co.call,Fu.empty=Co.empty,Fu.node=Co.node,Fu.size=Co.size,so.transition=function(t,e){return t&&t.transition?Xu?t.transition(e):t:so.selection().transition(t)},(so.transition.prototype=Fu).select=function(t){var e=this.id,n=this.namespace,i=[],r,a,o;t=A(t);for(var s=-1,u=this.length;++s<u;){i.push(r=[]);for(var c=this[s],l=-1,h=c.length;++l<h;)(o=c[l])&&(a=t.call(o,o.__data__,l,s))?("__data__"in o&&(a.__data__=o.__data__),Ja(a,l,n,e,o[n][e]),r.push(a)):r.push(null)}return Qa(i,n,e)},Fu.selectAll=function(t){var e=this.id,n=this.namespace,i=[],r,a,o,s,u;t=T(t);for(var c=-1,l=this.length;++c<l;)for(var h=this[c],d=-1,f=h.length;++d<f;)if(o=h[d]){u=o[n][e],a=t.call(o,o.__data__,d,c),i.push(r=[]);for(var g=-1,p=a.length;++g<p;)(s=a[g])&&Ja(s,g,n,e,u),r.push(s)}return Qa(i,n,e)},Fu.filter=function(t){var e=[],n,i,r;"function"!=typeof t&&(t=X(t));for(var a=0,o=this.length;a<o;a++){e.push(n=[]);for(var i,s=0,u=(i=this[a]).length;s<u;s++)(r=i[s])&&t.call(r,r.__data__,s,a)&&n.push(r)}return Qa(e,this.namespace,this.id)},Fu.tween=function(e,n){var i=this.id,r=this.namespace;return arguments.length<2?this.node()[r][i].tween.get(e):Y(this,null==n?function(t){t[r][i].tween.remove(e)}:function(t){t[r][i].tween.set(e,n)})},Fu.attr=function(t,e){function i(){this.removeAttribute(s)}function r(){this.removeAttributeNS(s.space,s.local)}function n(n){return null==n?i:(n+="",function(){var t=this.getAttribute(s),e;return t!==n&&(e=o(t,n),function(t){this.setAttribute(s,e(t))})})}function a(n){return null==n?r:(n+="",function(){var t=this.getAttributeNS(s.space,s.local),e;return t!==n&&(e=o(t,n),function(t){this.setAttributeNS(s.space,s.local,e(t))})})}if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var o="transform"==t?qi:yi,s=so.ns.qualify(t);return Za(this,"attr."+t,e,s.local?a:n)},Fu.attrTween=function(t,i){function e(t,e){var n=i.call(this,t,e,this.getAttribute(r));return n&&function(t){this.setAttribute(r,n(t))}}function n(t,e){var n=i.call(this,t,e,this.getAttributeNS(r.space,r.local));return n&&function(t){this.setAttributeNS(r.space,r.local,n(t))}}var r=so.ns.qualify(t);return this.tween("attr."+t,r.local?n:e)},Fu.style=function(i,t,r){function e(){this.style.removeProperty(i)}function n(n){return null==n?e:(n+="",function(){var t=R(this).getComputedStyle(this,null).getPropertyValue(i),e;return t!==n&&(e=yi(t,n),function(t){this.style.setProperty(i,e(t),r)})})}var a=arguments.length;if(a<3){if("string"!=typeof i){for(r in a<2&&(t=""),i)this.style(r,i[r],t);return this}r=""}return Za(this,"style."+i,t,n)},Fu.styleTween=function(i,r,a){function t(t,e){var n=r.call(this,t,e,R(this).getComputedStyle(this,null).getPropertyValue(i));return n&&function(t){this.style.setProperty(i,n(t),a)}}return arguments.length<3&&(a=""),this.tween("style."+i,t)},Fu.text=function(t){return Za(this,"text",t,Ka)},Fu.remove=function(){var e=this.namespace;return this.each("end.transition",function(){var t;this[e].count<2&&(t=this.parentNode)&&t.removeChild(this)})},Fu.ease=function(e){var n=this.id,i=this.namespace;return arguments.length<1?this.node()[i][n].ease:("function"!=typeof e&&(e=so.ease.apply(so,arguments)),Y(this,function(t){t[i][n].ease=e}))},Fu.delay=function(i){var r=this.id,a=this.namespace;return arguments.length<1?this.node()[a][r].delay:Y(this,"function"==typeof i?function(t,e,n){t[a][r].delay=+i.call(t,t.__data__,e,n)}:(i=+i,function(t){t[a][r].delay=i}))},Fu.duration=function(i){var r=this.id,a=this.namespace;return arguments.length<1?this.node()[a][r].duration:Y(this,"function"==typeof i?function(t,e,n){t[a][r].duration=Math.max(1,i.call(t,t.__data__,e,n))}:(i=Math.max(1,i),function(t){t[a][r].duration=i}))},Fu.each=function(i,n){var r=this.id,a=this.namespace;if(arguments.length<2){var t=Hu,e=Xu;try{Xu=r,Y(this,function(t,e,n){Hu=t[a][r],i.call(t,t.__data__,e,n)})}finally{Hu=t,Xu=e}}else Y(this,function(t){var e=t[a][r];(e.event||(e.event=so.dispatch("start","end","interrupt"))).on(i,n)});return this},Fu.transition=function(){for(var t=this.id,e=++zu,n=this.namespace,i=[],r,a,o,s,u=0,c=this.length;u<c;u++){i.push(r=[]);for(var a,l=0,h=(a=this[u]).length;l<h;l++)(o=a[l])&&Ja(o,l,n,e,{time:(s=o[n][t]).time,ease:s.ease,delay:s.delay+s.duration,duration:s.duration}),r.push(o)}return Qa(i,n,e)},so.svg.axis=function(){function n(t){t.each(function(){var t=so.select(this),e=this.__chart__||P,n=this.__chart__=P.copy(),i=null==G?n.ticks?n.ticks.apply(n,V):n.domain():G,r=null==k?n.tickFormat?n.tickFormat.apply(n,V):O:k,a=t.selectAll(".tick").data(i,n),o=a.enter().insert("g",".domain").attr("class","tick").style("opacity",Oo),s=so.transition(a.exit()).style("opacity",Oo).remove(),u=so.transition(a.order()).style("opacity",1),c=Math.max(L,0)+E,l,h=Br(n),d=t.selectAll(".domain").data([0]),f=(d.enter().append("path").attr("class","domain"),so.transition(d));o.append("line"),o.append("text");var g=o.select("line"),p=u.select("line"),x=a.select("text").text(r),_=o.select("text"),v=u.select("text"),y="top"===C||"left"===C?-1:1,m,w,S,b;if("bottom"===C||"top"===C?(l=to,m="x",S="y",w="x2",b="y2",x.attr("dy",y<0?"0em":".71em").style("text-anchor","middle"),f.attr("d","M"+h[0]+","+y*M+"V0H"+h[1]+"V"+y*M)):(l=eo,m="y",S="x",w="y2",b="x2",x.attr("dy",".32em").style("text-anchor",y<0?"end":"start"),f.attr("d","M"+y*M+","+h[0]+"H0V"+h[1]+"H"+y*M)),g.attr(b,y*L),_.attr(S,y*c),p.attr(w,0).attr(b,y*L),v.attr(m,0).attr(S,y*c),n.rangeBand){var A=n,T=A.rangeBand()/2;e=n=function(t){return A(t)+T}}else e.rangeBand?e=n:s.call(l,n,e);o.call(l,e,n),u.call(l,n,n)})}var P=so.scale.linear(),C=Yu,L=6,M=6,E=3,V=[10],G=null,k;return n.scale=function(t){return arguments.length?(P=t,n):P},n.orient=function(t){return arguments.length?(C=t in Bu?t+"":Yu,n):C},n.ticks=function(){return arguments.length?(V=co(arguments),n):V},n.tickValues=function(t){return arguments.length?(G=t,n):G},n.tickFormat=function(t){return arguments.length?(k=t,n):k},n.tickSize=function(t){var e=arguments.length;return e?(L=+t,M=+arguments[e-1],n):L},n.innerTickSize=function(t){return arguments.length?(L=+t,n):L},n.outerTickSize=function(t){return arguments.length?(M=+t,n):M},n.tickPadding=function(t){return arguments.length?(E=+t,n):E},n.tickSubdivide=function(){return arguments.length&&n},n};var Yu="bottom",Bu={top:1,right:1,bottom:1,left:1};so.svg.brush=function(){function m(t){t.each(function(){var t=so.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",o).on("touchstart.brush",o),e=t.selectAll(".background").data([0]);e.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),t.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var n=t.selectAll(".resize").data(s,O);n.exit().remove(),n.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return ju[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),n.style("display",m.empty()?"none":null);var i=so.transition(t),r=so.transition(e),a;T&&(a=Br(T),r.attr("x",a[0]).attr("width",a[1]-a[0]),S(i)),P&&(a=Br(P),r.attr("y",a[0]).attr("height",a[1]-a[0]),b(i)),w(i)})}function w(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+C[+/e$/.test(t)]+","+L[+/^s/.test(t)]+")"})}function S(t){t.select(".extent").attr("x",C[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",C[1]-C[0])}function b(t){t.select(".extent").attr("y",L[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",L[1]-L[0])}function o(){function t(){32==so.event.keyCode&&(d||(g=null,p[0]-=C[1],p[1]-=L[1],d=2),I())}function e(){32==so.event.keyCode&&2==d&&(p[0]+=C[1],p[1]+=L[1],d=0,I())}function n(){var t=so.mouse(a),e=!1;x&&(t[0]+=x[0],t[1]+=x[1]),d||(so.event.altKey?(g||(g=[(C[0]+C[1])/2,(L[0]+L[1])/2]),p[0]=C[+(t[0]<g[0])],p[1]=L[+(t[1]<g[1])]):g=null),l&&i(t,T,0)&&(S(u),e=!0),h&&i(t,P,1)&&(b(u),e=!0),e&&(w(u),s({type:"brush",mode:d?"move":"resize"}))}function i(t,e,n){var i=Br(e),r=i[0],a=i[1],o=p[n],s=n?L:C,u=s[1]-s[0],c,l;if(d&&(r-=o,a-=u+o),c=(n?G:V)?Math.max(r,Math.min(a,t[n])):t[n],d?l=(c+=o)+u:(g&&(o=Math.max(r,Math.min(a,2*g[n]-c))),o<c?(l=c,c=o):l=o),s[0]!=c||s[1]!=l)return n?E=null:M=null,s[0]=c,s[1]=l,!0}function r(){n(),u.style("pointer-events","all").selectAll(".resize").style("display",m.empty()?"none":null),so.select("body").style("cursor",null),_.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),f(),s({type:"brushend"})}var a=this,o=so.select(so.event.target),s=A.of(a,arguments),u=so.select(a),c=o.datum(),l=!/^(n|s)$/.test(c)&&T,h=!/^(e|w)$/.test(c)&&P,d=o.classed("extent"),f=Q(a),g,p=so.mouse(a),x,_=so.select(R(a)).on("keydown.brush",t).on("keyup.brush",e);if(so.event.changedTouches?_.on("touchmove.brush",n).on("touchend.brush",r):_.on("mousemove.brush",n).on("mouseup.brush",r),u.interrupt().selectAll("*").interrupt(),d)p[0]=C[0]-p[0],p[1]=L[0]-p[1];else if(c){var v=+/w$/.test(c),y=+/^n/.test(c);x=[C[1-v]-p[0],L[1-y]-p[1]],p[0]=C[v],p[1]=L[y]}else so.event.altKey&&(g=p.slice());u.style("pointer-events","none").selectAll(".resize").style("display",null),so.select("body").style("cursor",o.style("cursor")),s({type:"brushstart"}),n()}var A=D(m,"brushstart","brush","brushend"),T=null,P=null,C=[0,0],L=[0,0],M,E,V=!0,G=!0,s=Uu[0];return m.event=function(t){t.each(function(){var i=A.of(this,arguments),r={x:C,y:L,i:M,j:E},t=this.__chart__||r;this.__chart__=r,Xu?so.select(this).transition().each("start.brush",function(){M=t.i,E=t.j,C=t.x,L=t.y,i({type:"brushstart"})}).tween("brush:brush",function(){var e=mi(C,r.x),n=mi(L,r.y);return M=E=null,function(t){C=r.x=e(t),L=r.y=n(t),i({type:"brush",mode:"resize"})}}).each("end.brush",function(){M=r.i,E=r.j,i({type:"brush",mode:"resize"}),i({type:"brushend"})}):(i({type:"brushstart"}),i({type:"brush",mode:"resize"}),i({type:"brushend"}))})},m.x=function(t){return arguments.length?(s=Uu[!(T=t)<<1|!P],m):T},m.y=function(t){return arguments.length?(s=Uu[!T<<1|!(P=t)],m):P},m.clamp=function(t){return arguments.length?(T&&P?(V=!!t[0],G=!!t[1]):T?V=!!t:P&&(G=!!t),m):T&&P?[V,G]:T?V:P?G:null},m.extent=function(t){var e,n,i,r,a;return arguments.length?(T&&(e=t[0],n=t[1],P&&(e=e[0],n=n[0]),M=[e,n],T.invert&&(e=T(e),n=T(n)),n<e&&(a=e,e=n,n=a),e==C[0]&&n==C[1]||(C=[e,n])),P&&(i=t[0],r=t[1],T&&(i=i[1],r=r[1]),E=[i,r],P.invert&&(i=P(i),r=P(r)),r<i&&(a=i,i=r,r=a),i==L[0]&&r==L[1]||(L=[i,r])),m):(T&&(M?(e=M[0],n=M[1]):(e=C[0],n=C[1],T.invert&&(e=T.invert(e),n=T.invert(n)),n<e&&(a=e,e=n,n=a))),P&&(E?(i=E[0],r=E[1]):(i=L[0],r=L[1],P.invert&&(i=P.invert(i),r=P.invert(r)),r<i&&(a=i,i=r,r=a))),T&&P?[[e,i],[n,r]]:T?[e,n]:P&&[i,r])},m.clear=function(){return m.empty()||(C=[0,0],L=[0,0],M=E=null),m},m.empty=function(){return!!T&&C[0]==C[1]||!!P&&L[0]==L[1]},so.rebind(m,A,"on")};var ju={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Uu=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],qu=ds.format=vs.timeFormat,Wu=qu.utc,Qu=Wu("%Y-%m-%dT%H:%M:%S.%LZ");qu.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?no:Qu,no.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},no.toString=Qu.toString,ds.second=zt(function(t){return new fs(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),ds.seconds=ds.second.range,ds.seconds.utc=ds.second.utc.range,ds.minute=zt(function(t){return new fs(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),ds.minutes=ds.minute.range,ds.minutes.utc=ds.minute.utc.range,ds.hour=zt(function(t){var e=t.getTimezoneOffset()/60;return new fs(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),ds.hours=ds.hour.range,ds.hours.utc=ds.hour.utc.range,ds.month=zt(function(t){return(t=ds.day(t)).setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),ds.months=ds.month.range,ds.months.utc=ds.month.utc.range;var Zu=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Ku=[[ds.second,1],[ds.second,5],[ds.second,15],[ds.second,30],[ds.minute,1],[ds.minute,5],[ds.minute,15],[ds.minute,30],[ds.hour,1],[ds.hour,3],[ds.hour,6],[ds.hour,12],[ds.day,1],[ds.day,2],[ds.week,1],[ds.month,1],[ds.month,3],[ds.year,1]],$u=qu.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",Me]]),Ju={range:function(t,e,n){return so.range(Math.ceil(t/n)*n,+e,n).map(ro)},floor:O,ceil:O};Ku.year=ds.year,ds.scale=function(){return io(so.scale.linear(),Ku,$u)};var tc=Ku.map(function(t){return[t[0].utc,t[1]]}),ec=Wu.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",Me]]);tc.year=ds.year.utc,ds.scale.utc=function(){return io(so.scale.linear(),tc,ec)},so.text=Ct(function(t){return t.responseText}),so.json=function(t,e){return Lt(t,"application/json",ao,e)},so.html=function(t,e){return Lt(t,"text/html",oo,e)},so.xml=Ct(function(t){return t.responseXML}),"function"==typeof define&&define.amd?(this.d3=so,define(so)):"object"==typeof module&&module.exports?module.exports=so:this.d3=so}(),/* @license C3.js v0.4.21 | (c) C3 Team and other contributors | http://c3js.org/ */
function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.c3=e()}(this,function(){"use strict";function r(t,e){var n=this;n.component=t,n.params=e||{},n.d3=t.d3,n.scale=n.d3.scale.linear(),n.range,n.orient="bottom",n.innerTickSize=6,n.outerTickSize=this.params.withOuterTick?6:0,n.tickPadding=3,n.tickValues=null,n.tickFormat,n.tickArguments,n.tickOffset=0,n.tickCulling=!0,n.tickCentered,n.tickTextCharSize,n.tickTextRotate=n.params.tickTextRotate,n.tickLength,n.axis=n.generateAxis()}function t(t,e,n){this.owner=t,m.chart.internal[e]=n}function e(t){var e=this.internal=new n(this);e.loadConfig(t),e.beforeInit(t),e.init(),e.afterInit(t),
// bind "this" to nested API
function e(n,i,r){Object.keys(n).forEach(function(t){i[t]=n[t].bind(r),0<Object.keys(n[t]).length&&e(n[t],i[t],r)})}(w,this,this)}function n(t){var e=this;e.d3=window.d3?window.d3:"undefined"!=typeof require?require("d3"):void 0,e.api=t,e.config=e.getDefaultConfig(),e.data={},e.cache={},e.axes={}}var X={target:"c3-target",chart:"c3-chart",chartLine:"c3-chart-line",chartLines:"c3-chart-lines",chartBar:"c3-chart-bar",chartBars:"c3-chart-bars",chartText:"c3-chart-text",chartTexts:"c3-chart-texts",chartArc:"c3-chart-arc",chartArcs:"c3-chart-arcs",chartArcsTitle:"c3-chart-arcs-title",chartArcsBackground:"c3-chart-arcs-background",chartArcsGaugeUnit:"c3-chart-arcs-gauge-unit",chartArcsGaugeMax:"c3-chart-arcs-gauge-max",chartArcsGaugeMin:"c3-chart-arcs-gauge-min",selectedCircle:"c3-selected-circle",selectedCircles:"c3-selected-circles",eventRect:"c3-event-rect",eventRects:"c3-event-rects",eventRectsSingle:"c3-event-rects-single",eventRectsMultiple:"c3-event-rects-multiple",zoomRect:"c3-zoom-rect",brush:"c3-brush",focused:"c3-focused",defocused:"c3-defocused",region:"c3-region",regions:"c3-regions",title:"c3-title",tooltipContainer:"c3-tooltip-container",tooltip:"c3-tooltip",tooltipName:"c3-tooltip-name",shape:"c3-shape",shapes:"c3-shapes",line:"c3-line",lines:"c3-lines",bar:"c3-bar",bars:"c3-bars",circle:"c3-circle",circles:"c3-circles",arc:"c3-arc",arcLabelLine:"c3-arc-label-line",arcs:"c3-arcs",area:"c3-area",areas:"c3-areas",empty:"c3-empty",text:"c3-text",texts:"c3-texts",gaugeValue:"c3-gauge-value",grid:"c3-grid",gridLines:"c3-grid-lines",xgrid:"c3-xgrid",xgrids:"c3-xgrids",xgridLine:"c3-xgrid-line",xgridLines:"c3-xgrid-lines",xgridFocus:"c3-xgrid-focus",ygrid:"c3-ygrid",ygrids:"c3-ygrids",ygridLine:"c3-ygrid-line",ygridLines:"c3-ygrid-lines",axis:"c3-axis",axisX:"c3-axis-x",axisXLabel:"c3-axis-x-label",axisY:"c3-axis-y",axisYLabel:"c3-axis-y-label",axisY2:"c3-axis-y2",axisY2Label:"c3-axis-y2-label",legendBackground:"c3-legend-background",legendItem:"c3-legend-item",legendItemEvent:"c3-legend-item-event",legendItemTile:"c3-legend-item-tile",legendItemHidden:"c3-legend-item-hidden",legendItemFocused:"c3-legend-item-focused",dragarea:"c3-dragarea",EXPANDED:"_expanded_",SELECTED:"_selected_",INCLUDED:"_included_"},u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},o=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},C=function t(e){return e||0===e},d=function t(e){return"function"==typeof e},c=function t(e){return Array.isArray(e)},l=function t(e){return"string"==typeof e},A=function t(e){return void 0===e},I=function t(e){return void 0!==e},h=function t(e){return 10*Math.ceil(e/10)},f=function t(e){return Math.ceil(e)+.5},O=function t(e){return e[1]-e[0]},g=function t(e){return null==e||l(e)&&0===e.length||"object"===(void 0===e?"undefined":u(e))&&0===Object.keys(e).length},L=function t(e){return!S.isEmpty(e)},H=function t(e,n,i){return I(e[n])?e[n]:i},i=function t(e,n){var i=!1;return Object.keys(e).forEach(function(t){e[t]===n&&(i=!0)}),i},x=function t(e){return"string"==typeof e?e.replace(/</g,"&lt;").replace(/>/g,"&gt;"):e},v=function t(e){var n=e.getBoundingClientRect(),i=[e.pathSegList.getItem(0),e.pathSegList.getItem(1)],r,a;return{x:i[0].x,y:Math.min(i[0].y,i[1].y),width:n.width,height:n.height}},p,_;(_=r.prototype).axisX=function(t,e,n){t.attr("transform",function(t){return"translate("+Math.ceil(e(t)+n)+", 0)"})},_.axisY=function(t,e){t.attr("transform",function(t){return"translate(0,"+Math.ceil(e(t))+")"})},_.scaleExtent=function(t){var e=t[0],n=t[t.length-1];return e<n?[e,n]:[n,e]},_.generateTicks=function(t){var e=this,n,i,r=[];if(t.ticks)return t.ticks.apply(t,e.tickArguments);for(i=t.domain(),n=Math.ceil(i[0]);n<i[1];n++)r.push(n);return 0<r.length&&0<r[0]&&r.unshift(r[0]-(r[1]-r[0])),r},_.copyScale=function(){var t=this,e=t.scale.copy(),n;return t.params.isCategory&&(n=t.scale.domain(),e.domain([n[0],n[1]-1])),e},_.textFormatted=function(t){var e=this,n=e.tickFormat?e.tickFormat(t):t;return void 0!==n?n:""},_.updateRange=function(){var t=this;return t.range=t.scale.rangeExtent?t.scale.rangeExtent():t.scaleExtent(t.scale.range()),t.range},_.updateTickTextCharSize=function(t){var a=this;if(a.tickTextCharSize)return a.tickTextCharSize;var o={h:11.5,w:5.5};return t.select("text").text(function(t){return a.textFormatted(t)}).each(function(t){var e=this.getBoundingClientRect(),n=a.textFormatted(t),i=e.height,r=n?e.width/n.length:void 0;i&&r&&(o.h=i,o.w=r)}).text(""),a.tickTextCharSize=o},_.transitionise=function(t){return this.params.withoutTransition?t:this.d3.transition(t)},_.isVertical=function(){return"left"===this.orient||"right"===this.orient},_.tspanData=function(t,e,n,i){var r=this,a=r.params.tickMultiline?r.splitTickText(t,n,i):[].concat(r.textFormatted(t));return a.map(function(t){return{index:e,splitted:t,length:a.length}})},_.splitTickText=function(t,e,n){function i(t,e){u=void 0;for(var n=1;n<e.length;n++)
// if text width gets over tick width, split by space index or crrent index
if(" "===e.charAt(n)&&(u=n),s=e.substr(0,n+1),c=r.tickTextCharSize.w*s.length,o<c)return i(t.concat(e.substr(0,u||n)),e.slice(u?u+1:n));return t.concat(e)}var r=this,a=r.textFormatted(t),o=r.params.tickWidth,s,u,c,l=[];return"[object Array]"===Object.prototype.toString.call(a)?a:((!o||o<=0)&&(o=r.isVertical()?95:r.params.isCategory?Math.ceil(n(e[1])-n(e[0]))-12:110),i(l,a+""))},_.updateTickLength=function(){var t=this;t.tickLength=Math.max(t.innerTickSize,0)+t.tickPadding},_.lineY2=function(t){var e=this,n=e.scale(t)+(e.tickCentered?0:e.tickOffset);return e.range[0]<n&&n<e.range[1]?e.innerTickSize:0},_.textY=function(){var t=this,e=t.tickTextRotate;return e?11.5-e/15*2.5*(0<e?1:-1):t.tickLength},_.textTransform=function(){var t,e=this.tickTextRotate;return e?"rotate("+e+")":""},_.textTextAnchor=function(){var t,e=this.tickTextRotate;return e?0<e?"start":"end":"middle"},_.tspanDx=function(){var t,e=this.tickTextRotate;return e?8*Math.sin(Math.PI*(e/180)):0},_.tspanDy=function(t,e){var n=this,i=n.tickTextCharSize.h;return 0===e&&(i=n.isVertical()?-((t.length-1)*(n.tickTextCharSize.h/2)-3):".71em"),i},_.generateAxis=function(){function v(t){t.each(function(){var t=v.g=m.select(this),e=this.__chart__||y.scale,n=this.__chart__=y.copyScale(),i=y.tickValues?y.tickValues:y.generateTicks(n),r=t.selectAll(".tick").data(i,n),a=r.enter().insert("g",".domain").attr("class","tick").style("opacity",1e-6),
// MEMO: No exit transition. The reason is this transition affects max tick width calculation because old tick will be included in the ticks.
o=r.exit().remove(),s=y.transitionise(r).style("opacity",1),u,c,l;w.isCategory?(y.tickOffset=Math.ceil((n(1)-n(0))/2),c=y.tickCentered?0:y.tickOffset,l=y.tickCentered?y.tickOffset:0):y.tickOffset=c=0,a.append("line"),a.append("text"),y.updateRange(),y.updateTickLength(),y.updateTickTextCharSize(t.select(".tick"));var h=s.select("line"),d=s.select("text"),f=r.select("text").selectAll("tspan").data(function(t,e){return y.tspanData(t,e,i,n)});f.enter().append("tspan"),f.exit().remove(),f.text(function(t){return t.splitted});var g=t.selectAll(".domain").data([0]),p=(g.enter().append("path").attr("class","domain"),y.transitionise(g));
// TODO: each attr should be one function and change its behavior by internal.orient, probably
switch(y.orient){case"bottom":u=y.axisX,h.attr("x1",c).attr("x2",c).attr("y2",function(t,e){return y.lineY2(t,e)}),d.attr("x",0).attr("y",function(t,e){return y.textY(t,e)}).attr("transform",function(t,e){return y.textTransform(t,e)}).style("text-anchor",function(t,e){return y.textTextAnchor(t,e)}),f.attr("x",0).attr("dy",function(t,e){return y.tspanDy(t,e)}).attr("dx",function(t,e){return y.tspanDx(t,e)}),p.attr("d","M"+y.range[0]+","+y.outerTickSize+"V0H"+y.range[1]+"V"+y.outerTickSize);break;case"top":
// TODO: rotated tick text
u=y.axisX,h.attr("x2",0).attr("y2",-y.innerTickSize),d.attr("x",0).attr("y",-y.tickLength).style("text-anchor","middle"),f.attr("x",0).attr("dy","0em"),p.attr("d","M"+y.range[0]+","+-y.outerTickSize+"V0H"+y.range[1]+"V"+-y.outerTickSize);break;case"left":u=y.axisY,h.attr("x2",-y.innerTickSize).attr("y1",l).attr("y2",l),d.attr("x",-y.tickLength).attr("y",y.tickOffset).style("text-anchor","end"),f.attr("x",-y.tickLength).attr("dy",function(t,e){return y.tspanDy(t,e)}),p.attr("d","M"+-y.outerTickSize+","+y.range[0]+"H0V"+y.range[1]+"H"+-y.outerTickSize);break;case"right":u=y.axisY,h.attr("x2",y.innerTickSize).attr("y2",0),d.attr("x",y.tickLength).attr("y",0).style("text-anchor","start"),f.attr("x",y.tickLength).attr("dy",function(t,e){return y.tspanDy(t,e)}),p.attr("d","M"+y.outerTickSize+","+y.range[0]+"H0V"+y.range[1]+"H"+y.outerTickSize);break}if(n.rangeBand){var x=n,_=x.rangeBand()/2;e=n=function t(e){return x(e)+_}}else e.rangeBand?e=n:o.call(u,n,y.tickOffset);a.call(u,e,y.tickOffset),s.call(u,n,y.tickOffset)})}var y=this,m=y.d3,w=y.params;return v.scale=function(t){return arguments.length?(y.scale=t,v):y.scale},v.orient=function(t){return arguments.length?(y.orient=t in{top:1,right:1,bottom:1,left:1}?t+"":"bottom",v):y.orient},v.tickFormat=function(t){return arguments.length?(y.tickFormat=t,v):y.tickFormat},v.tickCentered=function(t){return arguments.length?(y.tickCentered=t,v):y.tickCentered},v.tickOffset=function(){return y.tickOffset},v.tickInterval=function(){var t,e;return(t=w.isCategory?2*y.tickOffset:(e=v.g.select("path.domain").node().getTotalLength()-2*y.outerTickSize)/v.g.selectAll("line").size())===1/0?0:t},v.ticks=function(){return arguments.length?(y.tickArguments=arguments,v):y.tickArguments},v.tickCulling=function(t){return arguments.length?(y.tickCulling=t,v):y.tickCulling},v.tickValues=function(t){if("function"==typeof t)y.tickValues=function(){return t(y.scale.domain())};else{if(!arguments.length)return y.tickValues;y.tickValues=t}return v},v};var y=function(t){function i(t){a(this,i);var e={fn:p,internal:{fn:_}},n=s(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,"axis",e));return n.d3=t.d3,n.internal=r,n}return o(i,t),i}(t);(p=y.prototype).init=function t(){var e=this.owner,n=e.config,i=e.main;e.axes.x=i.append("g").attr("class",X.axis+" "+X.axisX).attr("clip-path",e.clipPathForXAxis).attr("transform",e.getTranslate("x")).style("visibility",n.axis_x_show?"visible":"hidden"),e.axes.x.append("text").attr("class",X.axisXLabel).attr("transform",n.axis_rotated?"rotate(-90)":"").style("text-anchor",this.textAnchorForXAxisLabel.bind(this)),e.axes.y=i.append("g").attr("class",X.axis+" "+X.axisY).attr("clip-path",n.axis_y_inner?"":e.clipPathForYAxis).attr("transform",e.getTranslate("y")).style("visibility",n.axis_y_show?"visible":"hidden"),e.axes.y.append("text").attr("class",X.axisYLabel).attr("transform",n.axis_rotated?"":"rotate(-90)").style("text-anchor",this.textAnchorForYAxisLabel.bind(this)),e.axes.y2=i.append("g").attr("class",X.axis+" "+X.axisY2).attr("transform",e.getTranslate("y2")).style("visibility",n.axis_y2_show?"visible":"hidden"),e.axes.y2.append("text").attr("class",X.axisY2Label).attr("transform",n.axis_rotated?"":"rotate(-90)").style("text-anchor",this.textAnchorForY2AxisLabel.bind(this))},p.getXAxis=function t(e,n,i,r,a,o,s){var u=this.owner,c=u.config,l={isCategory:u.isCategorized(),withOuterTick:a,tickMultiline:c.axis_x_tick_multiline,tickWidth:c.axis_x_tick_width,tickTextRotate:s?0:c.axis_x_tick_rotate,withoutTransition:o},h=new this.internal(this,l).axis.scale(e).orient(n);return u.isTimeSeries()&&r&&"function"!=typeof r&&(r=r.map(function(t){return u.parseDate(t)})),
// Set tick
h.tickFormat(i).tickValues(r),u.isCategorized()&&(h.tickCentered(c.axis_x_tick_centered),g(c.axis_x_tick_culling)&&(c.axis_x_tick_culling=!1)),h},p.updateXAxisTickValues=function t(e,n){var i=this.owner,r=i.config,a;return(r.axis_x_tick_fit||r.axis_x_tick_count)&&(a=this.generateTickValues(i.mapTargetsToUniqueXs(e),r.axis_x_tick_count,i.isTimeSeries())),n?n.tickValues(a):(i.xAxis.tickValues(a),i.subXAxis.tickValues(a)),a},p.getYAxis=function t(e,n,i,r,a,o,s){var u=this.owner,c=u.config,l={withOuterTick:a,withoutTransition:o,tickTextRotate:s?0:c.axis_y_tick_rotate},h=new this.internal(this,l).axis.scale(e).orient(n).tickFormat(i);return u.isTimeSeriesY()?h.ticks(u.d3.time[c.axis_y_tick_time_value],c.axis_y_tick_time_interval):h.tickValues(r),h},p.getId=function t(e){var n=this.owner.config;return e in n.data_axes?n.data_axes[e]:"y"},p.getXAxisTickFormat=function t(){var n=this.owner,i=n.config,e=n.isTimeSeries()?n.defaultAxisTimeFormat:n.isCategorized()?n.categoryName:function(t){return t<0?t.toFixed(0):t};return i.axis_x_tick_format&&(d(i.axis_x_tick_format)?e=i.axis_x_tick_format:n.isTimeSeries()&&(e=function t(e){return e?n.axisTimeFormat(i.axis_x_tick_format)(e):""})),d(e)?function(t){return e.call(n,t)}:e},p.getTickValues=function t(e,n){return e||(n?n.tickValues():void 0)},p.getXAxisTickValues=function t(){return this.getTickValues(this.owner.config.axis_x_tick_values,this.owner.xAxis)},p.getYAxisTickValues=function t(){return this.getTickValues(this.owner.config.axis_y_tick_values,this.owner.yAxis)},p.getY2AxisTickValues=function t(){return this.getTickValues(this.owner.config.axis_y2_tick_values,this.owner.y2Axis)},p.getLabelOptionByAxisId=function t(e){var n,i=this.owner.config,r;return"y"===e?r=i.axis_y_label:"y2"===e?r=i.axis_y2_label:"x"===e&&(r=i.axis_x_label),r},p.getLabelText=function t(e){var n=this.getLabelOptionByAxisId(e);return l(n)?n:n?n.text:null},p.setLabelText=function t(e,n){var i,r=this.owner.config,a=this.getLabelOptionByAxisId(e);l(a)?"y"===e?r.axis_y_label=n:"y2"===e?r.axis_y2_label=n:"x"===e&&(r.axis_x_label=n):a&&(a.text=n)},p.getLabelPosition=function t(e,n){var i=this.getLabelOptionByAxisId(e),r=i&&"object"===(void 0===i?"undefined":u(i))&&i.position?i.position:n;return{isInner:0<=r.indexOf("inner"),isOuter:0<=r.indexOf("outer"),isLeft:0<=r.indexOf("left"),isCenter:0<=r.indexOf("center"),isRight:0<=r.indexOf("right"),isTop:0<=r.indexOf("top"),isMiddle:0<=r.indexOf("middle"),isBottom:0<=r.indexOf("bottom")}},p.getXAxisLabelPosition=function t(){return this.getLabelPosition("x",this.owner.config.axis_rotated?"inner-top":"inner-right")},p.getYAxisLabelPosition=function t(){return this.getLabelPosition("y",this.owner.config.axis_rotated?"inner-right":"inner-top")},p.getY2AxisLabelPosition=function t(){return this.getLabelPosition("y2",this.owner.config.axis_rotated?"inner-right":"inner-top")},p.getLabelPositionById=function t(e){return"y2"===e?this.getY2AxisLabelPosition():"y"===e?this.getYAxisLabelPosition():this.getXAxisLabelPosition()},p.textForXAxisLabel=function t(){return this.getLabelText("x")},p.textForYAxisLabel=function t(){return this.getLabelText("y")},p.textForY2AxisLabel=function t(){return this.getLabelText("y2")},p.xForAxisLabel=function t(e,n){var i=this.owner;return e?n.isLeft?0:n.isCenter?i.width/2:i.width:n.isBottom?-i.height:n.isMiddle?-i.height/2:0},p.dxForAxisLabel=function t(e,n){return e?n.isLeft?"0.5em":n.isRight?"-0.5em":"0":n.isTop?"-0.5em":n.isBottom?"0.5em":"0"},p.textAnchorForAxisLabel=function t(e,n){return e?n.isLeft?"start":n.isCenter?"middle":"end":n.isBottom?"start":n.isMiddle?"middle":"end"},p.xForXAxisLabel=function t(){return this.xForAxisLabel(!this.owner.config.axis_rotated,this.getXAxisLabelPosition())},p.xForYAxisLabel=function t(){return this.xForAxisLabel(this.owner.config.axis_rotated,this.getYAxisLabelPosition())},p.xForY2AxisLabel=function t(){return this.xForAxisLabel(this.owner.config.axis_rotated,this.getY2AxisLabelPosition())},p.dxForXAxisLabel=function t(){return this.dxForAxisLabel(!this.owner.config.axis_rotated,this.getXAxisLabelPosition())},p.dxForYAxisLabel=function t(){return this.dxForAxisLabel(this.owner.config.axis_rotated,this.getYAxisLabelPosition())},p.dxForY2AxisLabel=function t(){return this.dxForAxisLabel(this.owner.config.axis_rotated,this.getY2AxisLabelPosition())},p.dyForXAxisLabel=function t(){var e,n=this.owner.config,i=this.getXAxisLabelPosition();return n.axis_rotated?i.isInner?"1.2em":-25-this.getMaxTickWidth("x"):i.isInner?"-0.5em":n.axis_x_height?n.axis_x_height-10:"3em"},p.dyForYAxisLabel=function t(){var e=this.owner,n=this.getYAxisLabelPosition();return e.config.axis_rotated?n.isInner?"-0.5em":"3em":n.isInner?"1.2em":-10-(e.config.axis_y_inner?0:this.getMaxTickWidth("y")+10)},p.dyForY2AxisLabel=function t(){var e=this.owner,n=this.getY2AxisLabelPosition();return e.config.axis_rotated?n.isInner?"1.2em":"-2.2em":n.isInner?"-0.5em":15+(e.config.axis_y2_inner?0:this.getMaxTickWidth("y2")+15)},p.textAnchorForXAxisLabel=function t(){var e=this.owner;return this.textAnchorForAxisLabel(!e.config.axis_rotated,this.getXAxisLabelPosition())},p.textAnchorForYAxisLabel=function t(){var e=this.owner;return this.textAnchorForAxisLabel(e.config.axis_rotated,this.getYAxisLabelPosition())},p.textAnchorForY2AxisLabel=function t(){var e=this.owner;return this.textAnchorForAxisLabel(e.config.axis_rotated,this.getY2AxisLabelPosition())},p.getMaxTickWidth=function t(e,n){var i=this.owner,r=i.config,a=0,o,s,u,c,l;return n&&i.currentMaxTickWidths[e]||(i.svg&&(o=i.filterTargetsToShow(i.data.targets),"y"===e?(s=i.y.copy().domain(i.getYDomain(o,"y")),u=this.getYAxis(s,i.yOrient,r.axis_y_tick_format,i.yAxisTickValues,!1,!0,!0)):"y2"===e?(s=i.y2.copy().domain(i.getYDomain(o,"y2")),u=this.getYAxis(s,i.y2Orient,r.axis_y2_tick_format,i.y2AxisTickValues,!1,!0,!0)):(s=i.x.copy().domain(i.getXDomain(o)),u=this.getXAxis(s,i.xOrient,i.xAxisTickFormat,i.xAxisTickValues,!1,!0,!0),this.updateXAxisTickValues(o,u)),(l=(c=i.d3.select("body").append("div").classed("c3",!0)).append("svg").style("visibility","hidden").style("position","fixed").style("top",0).style("left",0)).append("g").call(u).each(function(){i.d3.select(this).selectAll("text").each(function(){var t=this.getBoundingClientRect();a<t.width&&(a=t.width)}),c.remove()})),i.currentMaxTickWidths[e]=a<=0?i.currentMaxTickWidths[e]:a),i.currentMaxTickWidths[e]},p.updateLabels=function t(e){var n=this.owner,i=n.main.select("."+X.axisX+" ."+X.axisXLabel),r=n.main.select("."+X.axisY+" ."+X.axisYLabel),a=n.main.select("."+X.axisY2+" ."+X.axisY2Label);(e?i.transition():i).attr("x",this.xForXAxisLabel.bind(this)).attr("dx",this.dxForXAxisLabel.bind(this)).attr("dy",this.dyForXAxisLabel.bind(this)).text(this.textForXAxisLabel.bind(this)),(e?r.transition():r).attr("x",this.xForYAxisLabel.bind(this)).attr("dx",this.dxForYAxisLabel.bind(this)).attr("dy",this.dyForYAxisLabel.bind(this)).text(this.textForYAxisLabel.bind(this)),(e?a.transition():a).attr("x",this.xForY2AxisLabel.bind(this)).attr("dx",this.dxForY2AxisLabel.bind(this)).attr("dy",this.dyForY2AxisLabel.bind(this)).text(this.textForY2AxisLabel.bind(this))},p.getPadding=function t(e,n,i,r){var a="number"==typeof e?e:e[n];return C(a)?"ratio"===e.unit?e[n]*r:this.convertPixelsToAxisPadding(a,r):i},p.convertPixelsToAxisPadding=function t(e,n){var i=this.owner,r;return n*(e/(i.config.axis_rotated?i.width:i.height))},p.generateTickValues=function t(e,n,i){var r=e,a,o,s,u,c,l,h;if(n)
// compute ticks according to tickCount
if(1===(a=d(n)?n():n))r=[e[0]];else if(2===a)r=[e[0],e[e.length-1]];else if(2<a){for(u=a-2,o=e[0],c=((s=e[e.length-1])-o)/(u+1),
// re-construct unique values
r=[o],l=0;l<u;l++)h=+o+c*(l+1),r.push(i?new Date(h):h);r.push(s)}return i||(r=r.sort(function(t,e){return t-e})),r},p.generateTransitions=function t(e){var n,i=this.owner.axes;return{axisX:e?i.x.transition().duration(e):i.x,axisY:e?i.y.transition().duration(e):i.y,axisY2:e?i.y2.transition().duration(e):i.y2,axisSubX:e?i.subx.transition().duration(e):i.subx}},p.redraw=function t(e,n){var i=this.owner;i.axes.x.style("opacity",n?0:1),i.axes.y.style("opacity",n?0:1),i.axes.y2.style("opacity",n?0:1),i.axes.subx.style("opacity",n?0:1),e.axisX.call(i.xAxis),e.axisY.call(i.yAxis),e.axisY2.call(i.y2Axis),e.axisSubX.call(i.subXAxis)};var m={version:"0.4.21"},w,S;return m.generate=function(t){return new e(t)},m.chart={fn:e.prototype,internal:{fn:n.prototype}},w=m.chart.fn,(S=m.chart.internal.fn).beforeInit=function(){
// can do something
},S.afterInit=function(){
// can do something
},S.init=function(){var t=this,e=t.config;if(t.initParams(),e.data_url)t.convertUrlToData(e.data_url,e.data_mimeType,e.data_headers,e.data_keys,t.initWithData);else if(e.data_json)t.initWithData(t.convertJsonToData(e.data_json,e.data_keys));else if(e.data_rows)t.initWithData(t.convertRowsToData(e.data_rows));else{if(!e.data_columns)throw Error("url or json or rows or columns is required.");t.initWithData(t.convertColumnsToData(e.data_columns))}},S.initParams=function(){var t=this,e=t.d3,n=t.config;
// MEMO: clipId needs to be unique because it conflicts when multiple charts exist
t.clipId="c3-"+ +new Date+"-clip",t.clipIdForXAxis=t.clipId+"-xaxis",t.clipIdForYAxis=t.clipId+"-yaxis",t.clipIdForGrid=t.clipId+"-grid",t.clipIdForSubchart=t.clipId+"-subchart",t.clipPath=t.getClipPath(t.clipId),t.clipPathForXAxis=t.getClipPath(t.clipIdForXAxis),t.clipPathForYAxis=t.getClipPath(t.clipIdForYAxis),t.clipPathForGrid=t.getClipPath(t.clipIdForGrid),t.clipPathForSubchart=t.getClipPath(t.clipIdForSubchart),t.dragStart=null,t.dragging=!1,t.flowing=!1,t.cancelClick=!1,t.mouseover=!1,t.transiting=!1,t.color=t.generateColor(),t.levelColor=t.generateLevelColor(),t.dataTimeFormat=n.data_xLocaltime?e.time.format:e.time.format.utc,t.axisTimeFormat=n.axis_x_localtime?e.time.format:e.time.format.utc,t.defaultAxisTimeFormat=t.axisTimeFormat.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%-m/%-d",function(t){return t.getDay()&&1!==t.getDate()}],["%-m/%-d",function(t){return 1!==t.getDate()}],["%-m/%-d",function(t){return t.getMonth()}],["%Y/%-m/%-d",function(){return!0}]]),t.hiddenTargetIds=[],t.hiddenLegendIds=[],t.focusedTargetIds=[],t.defocusedTargetIds=[],t.xOrient=n.axis_rotated?"left":"bottom",t.yOrient=n.axis_rotated?n.axis_y_inner?"top":"bottom":n.axis_y_inner?"right":"left",t.y2Orient=n.axis_rotated?n.axis_y2_inner?"bottom":"top":n.axis_y2_inner?"left":"right",t.subXOrient=n.axis_rotated?"left":"bottom",t.isLegendRight="right"===n.legend_position,t.isLegendInset="inset"===n.legend_position,t.isLegendTop="top-left"===n.legend_inset_anchor||"top-right"===n.legend_inset_anchor,t.isLegendLeft="top-left"===n.legend_inset_anchor||"bottom-left"===n.legend_inset_anchor,t.legendStep=0,t.legendItemWidth=0,t.legendItemHeight=0,t.currentMaxTickWidths={x:0,y:0,y2:0},t.rotated_padding_left=30,t.rotated_padding_right=n.axis_rotated&&!n.axis_x_show?0:30,t.rotated_padding_top=5,t.withoutFadeIn={},t.intervalForObserveInserted=void 0,t.axes.subx=e.selectAll([])},S.initChartElements=function(){this.initBar&&this.initBar(),this.initLine&&this.initLine(),this.initArc&&this.initArc(),this.initGauge&&this.initGauge(),this.initText&&this.initText()},S.initWithData=function(t){var e=this,n=e.d3,i=e.config,r,a,o=!0;e.axis=new y(e),e.initPie&&e.initPie(),e.initBrush&&e.initBrush(),e.initZoom&&e.initZoom(),i.bindto?"function"==typeof i.bindto.node?e.selectChart=i.bindto:e.selectChart=n.select(i.bindto):e.selectChart=n.selectAll([]),e.selectChart.empty()&&(e.selectChart=n.select(document.createElement("div")).style("opacity",0),e.observeInserted(e.selectChart),o=!1),e.selectChart.html("").classed("c3",!0),
// Init data as targets
e.data.xs={},e.data.targets=e.convertDataToTargets(t),i.data_filter&&(e.data.targets=e.data.targets.filter(i.data_filter)),
// Set targets to hide if needed
i.data_hide&&e.addHiddenTargetIds(!0===i.data_hide?e.mapToIds(e.data.targets):i.data_hide),i.legend_hide&&e.addHiddenLegendIds(!0===i.legend_hide?e.mapToIds(e.data.targets):i.legend_hide),
// Init sizes and scales
e.updateSizes(),e.updateScales(),
// Set domains for each scale
e.x.domain(n.extent(e.getXDomain(e.data.targets))),e.y.domain(e.getYDomain(e.data.targets,"y")),e.y2.domain(e.getYDomain(e.data.targets,"y2")),e.subX.domain(e.x.domain()),e.subY.domain(e.y.domain()),e.subY2.domain(e.y2.domain()),
// Save original x domain for zoom update
e.orgXDomain=e.x.domain(),
// Set initialized scales to brush and zoom
e.brush&&e.brush.scale(e.subX),i.zoom_enabled&&e.zoom.scale(e.x),
/*-- Basic Elements --*/
// Define svgs
e.svg=e.selectChart.append("svg").style("overflow","hidden").on("mouseenter",function(){return i.onmouseover.call(e)}).on("mouseleave",function(){return i.onmouseout.call(e)}),e.config.svg_classname&&e.svg.attr("class",e.config.svg_classname),
// Define defs
r=e.svg.append("defs"),e.clipChart=e.appendClip(r,e.clipId),e.clipXAxis=e.appendClip(r,e.clipIdForXAxis),e.clipYAxis=e.appendClip(r,e.clipIdForYAxis),e.clipGrid=e.appendClip(r,e.clipIdForGrid),e.clipSubchart=e.appendClip(r,e.clipIdForSubchart),e.updateSvgSize(),
// Define regions
a=e.main=e.svg.append("g").attr("transform",e.getTranslate("main")),e.initSubchart&&e.initSubchart(),e.initTooltip&&e.initTooltip(),e.initLegend&&e.initLegend(),e.initTitle&&e.initTitle(),
/*-- Main Region --*/
// text when empty
a.append("text").attr("class",X.text+" "+X.empty).attr("text-anchor","middle").attr("dominant-baseline","middle"),// vertical centering of text at y position in all browsers, except IE.
// Regions
e.initRegion(),
// Grids
e.initGrid(),
// Define g for chart area
a.append("g").attr("clip-path",e.clipPath).attr("class",X.chart),
// Grid lines
i.grid_lines_front&&e.initGridLines(),
// Cover whole with rects for events
e.initEventRect(),
// Define g for chart
e.initChartElements(),
// if zoom privileged, insert rect to forefront
// TODO: is this needed?
a.insert("rect",i.zoom_privileged?null:"g."+X.regions).attr("class",X.zoomRect).attr("width",e.width).attr("height",e.height).style("opacity",0).on("dblclick.zoom",null),
// Set default extent if defined
i.axis_x_extent&&e.brush.extent(e.getDefaultExtent()),
// Add Axis
e.axis.init(),
// Set targets
e.updateTargets(e.data.targets),
// Draw with targets
o&&(e.updateDimension(),e.config.oninit.call(e),e.redraw({withTransition:!1,withTransform:!0,withUpdateXDomain:!0,withUpdateOrgXDomain:!0,withTransitionForAxis:!1})),
// Bind resize event
e.bindResize(),
// export element of the chart
e.api.element=e.selectChart.node()},S.smoothLines=function(t,e){var a=this;"grid"===e&&t.each(function(){var t=a.d3.select(this),e=t.attr("x1"),n=t.attr("x2"),i=t.attr("y1"),r=t.attr("y2");t.attr({x1:Math.ceil(e),x2:Math.ceil(n),y1:Math.ceil(i),y2:Math.ceil(r)})})},S.updateSizes=function(){var t=this,e=t.config,n=t.legend?t.getLegendHeight():0,i=t.legend?t.getLegendWidth():0,r=t.isLegendRight||t.isLegendInset?0:n,a=t.hasArcType(),o=e.axis_rotated||a?0:t.getHorizontalAxisHeight("x"),s=e.subchart_show&&!a?e.subchart_size_height+o:0;t.currentWidth=t.getCurrentWidth(),t.currentHeight=t.getCurrentHeight(),
// for main
t.margin=e.axis_rotated?{top:t.getHorizontalAxisHeight("y2")+t.getCurrentPaddingTop(),right:a?0:t.getCurrentPaddingRight(),bottom:t.getHorizontalAxisHeight("y")+r+t.getCurrentPaddingBottom(),left:s+(a?0:t.getCurrentPaddingLeft())}:{top:4+t.getCurrentPaddingTop(),// for top tick text
right:a?0:t.getCurrentPaddingRight(),bottom:o+s+r+t.getCurrentPaddingBottom(),left:a?0:t.getCurrentPaddingLeft()},
// for subchart
t.margin2=e.axis_rotated?{top:t.margin.top,right:NaN,bottom:20+r,left:t.rotated_padding_left}:{top:t.currentHeight-s-r,right:NaN,bottom:o+r,left:t.margin.left},
// for legend
t.margin3={top:0,right:NaN,bottom:0,left:0},t.updateSizeForLegend&&t.updateSizeForLegend(n,i),t.width=t.currentWidth-t.margin.left-t.margin.right,t.height=t.currentHeight-t.margin.top-t.margin.bottom,t.width<0&&(t.width=0),t.height<0&&(t.height=0),t.width2=e.axis_rotated?t.margin.left-t.rotated_padding_left-t.rotated_padding_right:t.width,t.height2=e.axis_rotated?t.height:t.currentHeight-t.margin2.top-t.margin2.bottom,t.width2<0&&(t.width2=0),t.height2<0&&(t.height2=0),
// for arc
t.arcWidth=t.width-(t.isLegendRight?i+10:0),t.arcHeight=t.height-(t.isLegendRight?0:10),t.hasType("gauge")&&!e.gauge_fullCircle&&(t.arcHeight+=t.height-t.getGaugeLabelHeight()),t.updateRadius&&t.updateRadius(),t.isLegendRight&&a&&(t.margin3.left=t.arcWidth/2+1.1*t.radiusExpanded)},S.updateTargets=function(t){var e=this;
/*-- Main --*/
//-- Text --//
e.updateTargetsForText(t),
//-- Bar --//
e.updateTargetsForBar(t),
//-- Line --//
e.updateTargetsForLine(t),
//-- Arc --//
e.hasArcType()&&e.updateTargetsForArc&&e.updateTargetsForArc(t)
/*-- Sub --*/,e.updateTargetsForSubchart&&e.updateTargetsForSubchart(t),
// Fade-in each chart
e.showTargets()},S.showTargets=function(){var e=this;e.svg.selectAll("."+X.target).filter(function(t){return e.isTargetToShow(t.id)}).transition().duration(e.config.transition_duration).style("opacity",1)},S.redraw=function(t,e){var n=this,i=n.main,r=n.d3,a=n.config,o=n.getShapeIndices(n.isAreaType),s=n.getShapeIndices(n.isBarType),u=n.getShapeIndices(n.isLineType),c,l,h,d,f,g,p,x,_,v,y,m,w,S=n.hasArcType(),b,A,T,P,C,L,M,E,V,G,k=n.filterTargetsToShow(n.data.targets),R,O,I,D,N=n.xv.bind(n),F,z;
// show/hide if manual culling needed
if(c=H(t=t||{},"withY",!0),l=H(t,"withSubchart",!0),h=H(t,"withTransition",!0),g=H(t,"withTransform",!1),p=H(t,"withUpdateXDomain",!1),x=H(t,"withUpdateOrgXDomain",!1),_=H(t,"withTrimXDomain",!0),w=H(t,"withUpdateXAxis",p),v=H(t,"withLegend",!1),y=H(t,"withEventRect",!0),m=H(t,"withDimension",!0),d=H(t,"withTransitionForExit",h),f=H(t,"withTransitionForAxis",h),L=h?a.transition_duration:0,M=d?L:0,E=f?L:0,e=e||n.axis.generateTransitions(E),
// update legend and transform each g
v&&a.legend_show?n.updateLegend(n.mapToIds(n.data.targets),t,e):m&&
// need to update dimension (e.g. axis.y.tick.values) because y tick values should change
// no need to update axis in it because they will be updated in redraw()
n.updateDimension(!0),
// MEMO: needed for grids calculation
n.isCategorized()&&0===k.length&&n.x.domain([0,n.axes.x.selectAll(".tick").size()]),k.length?(n.updateXDomain(k,p,x,_),a.axis_x_tick_values||(R=n.axis.updateXAxisTickValues(k))):(n.xAxis.tickValues([]),n.subXAxis.tickValues([])),a.zoom_rescale&&!t.flow&&(D=n.x.orgDomain()),n.y.domain(n.getYDomain(k,"y",D)),n.y2.domain(n.getYDomain(k,"y2",D)),!a.axis_y_tick_values&&a.axis_y_tick_count&&n.yAxis.tickValues(n.axis.generateTickValues(n.y.domain(),a.axis_y_tick_count)),!a.axis_y2_tick_values&&a.axis_y2_tick_count&&n.y2Axis.tickValues(n.axis.generateTickValues(n.y2.domain(),a.axis_y2_tick_count)),
// axes
n.axis.redraw(e,S),
// Update axis label
n.axis.updateLabels(h),(p||w)&&k.length)if(a.axis_x_tick_culling&&R){for(O=1;O<R.length;O++)if(R.length/O<a.axis_x_tick_culling_max){I=O;break}n.svg.selectAll("."+X.axisX+" .tick text").each(function(t){var e=R.indexOf(t);0<=e&&r.select(this).style("display",e%I?"none":"block")})}else n.svg.selectAll("."+X.axisX+" .tick text").style("display","block");
// setup drawer - MEMO: these must be called after axis updated
b=n.generateDrawArea?n.generateDrawArea(o,!1):void 0,A=n.generateDrawBar?n.generateDrawBar(s):void 0,T=n.generateDrawLine?n.generateDrawLine(u,!1):void 0,P=n.generateXYForText(o,s,u,!0),C=n.generateXYForText(o,s,u,!1),
// Update sub domain
c&&(n.subY.domain(n.getYDomain(k,"y")),n.subY2.domain(n.getYDomain(k,"y2"))),
// xgrid focus
n.updateXgridFocus(),
// Data empty label positioning and text.
i.select("text."+X.text+"."+X.empty).attr("x",n.width/2).attr("y",n.height/2).text(a.data_empty_label_text).transition().style("opacity",k.length?0:1),
// grid
n.updateGrid(L),
// rect for regions
n.updateRegion(L),
// bars
n.updateBar(M),
// lines, areas and cricles
n.updateLine(M),n.updateArea(M),n.updateCircle(),
// text
n.hasDataLabel()&&n.updateText(M),
// title
n.redrawTitle&&n.redrawTitle(),
// arc
n.redrawArc&&n.redrawArc(L,M,g),
// subchart
n.redrawSubchart&&n.redrawSubchart(l,e,L,M,o,s,u),
// circles for select
i.selectAll("."+X.selectedCircles).filter(n.isBarType.bind(n)).selectAll("circle").remove(),
// event rects will redrawn when flow called
a.interaction_enabled&&!t.flow&&y&&(n.redrawEventRect(),n.updateZoom&&n.updateZoom()),
// update circleY based on updated parameters
n.updateCircleY(),
// generate circle x/y functions depending on updated params
F=(n.config.axis_rotated?n.circleY:n.circleX).bind(n),z=(n.config.axis_rotated?n.circleX:n.circleY).bind(n),t.flow&&(G=n.generateFlow({targets:k,flow:t.flow,duration:t.flow.duration,drawBar:A,drawLine:T,drawArea:b,cx:F,cy:z,xv:N,xForText:P,yForText:C})),(L||G)&&n.isTabVisible()?
// Only use transition if tab visible. See #938.
// transition should be derived from one transition
r.transition().duration(L).each(function(){var e=[];
// redraw and gather transitions
[n.redrawBar(A,!0),n.redrawLine(T,!0),n.redrawArea(b,!0),n.redrawCircle(F,z,!0),n.redrawText(P,C,t.flow,!0),n.redrawRegion(!0),n.redrawGrid(!0)].forEach(function(t){t.forEach(function(t){e.push(t)})}),
// Wait for end of transitions to call flow and onrendered callback
V=n.generateWait(),e.forEach(function(t){V.add(t)})}).call(V,function(){G&&G(),a.onrendered&&a.onrendered.call(n)}):(n.redrawBar(A),n.redrawLine(T),n.redrawArea(b),n.redrawCircle(F,z),n.redrawText(P,C,t.flow),n.redrawRegion(),n.redrawGrid(),a.onrendered&&a.onrendered.call(n)),
// update fadein condition
n.mapToIds(n.data.targets).forEach(function(t){n.withoutFadeIn[t]=!0})},S.updateAndRedraw=function(t){var e=this,n=e.config,i;
// same with redraw
(t=t||{}).withTransition=H(t,"withTransition",!0),t.withTransform=H(t,"withTransform",!1),t.withLegend=H(t,"withLegend",!1),
// NOT same with redraw
t.withUpdateXDomain=!0,t.withUpdateOrgXDomain=!0,t.withTransitionForExit=!1,t.withTransitionForTransform=H(t,"withTransitionForTransform",t.withTransition),
// MEMO: this needs to be called before updateLegend and it means this ALWAYS needs to be called)
e.updateSizes(),
// MEMO: called in updateLegend in redraw if withLegend
t.withLegend&&n.legend_show||(i=e.axis.generateTransitions(t.withTransitionForAxis?n.transition_duration:0),
// Update scales
e.updateScales(),e.updateSvgSize(),
// Update g positions
e.transformAll(t.withTransitionForTransform,i)),
// Draw with new sizes & scales
e.redraw(t,i)},S.redrawWithoutRescale=function(){this.redraw({withY:!1,withSubchart:!1,withEventRect:!1,withTransitionForAxis:!1})},S.isTimeSeries=function(){return"timeseries"===this.config.axis_x_type},S.isCategorized=function(){return 0<=this.config.axis_x_type.indexOf("categor")},S.isCustomX=function(){var t=this,e=t.config;return!t.isTimeSeries()&&(e.data_x||L(e.data_xs))},S.isTimeSeriesY=function(){return"timeseries"===this.config.axis_y_type},S.getTranslate=function(t){var e=this,n=e.config,i,r;return"main"===t?(i=f(e.margin.left),r=f(e.margin.top)):"context"===t?(i=f(e.margin2.left),r=f(e.margin2.top)):"legend"===t?(i=e.margin3.left,r=e.margin3.top):"x"===t?(i=0,r=n.axis_rotated?0:e.height):"y"===t?(i=0,r=n.axis_rotated?e.height:0):"y2"===t?(i=n.axis_rotated?0:e.width,r=n.axis_rotated?1:0):"subx"===t?(i=0,r=n.axis_rotated?0:e.height2):"arc"===t&&(i=e.arcWidth/2,r=e.arcHeight/2-(e.hasType("gauge")?6:0)),"translate("+i+","+r+")"},S.initialOpacity=function(t){return null!==t.value&&this.withoutFadeIn[t.id]?1:0},S.initialOpacityForCircle=function(t){return null!==t.value&&this.withoutFadeIn[t.id]?this.opacityForCircle(t):0},S.opacityForCircle=function(t){var e,n=(d(this.config.point_show)?this.config.point_show(t):this.config.point_show)?1:0;return C(t.value)?this.isScatterType(t)?.5:n:0},S.opacityForText=function(){return this.hasDataLabel()?1:0},S.xx=function(t){return t?this.x(t.x):null},S.xv=function(t){var e=this,n=t.value;return e.isTimeSeries()?n=e.parseDate(t.value):e.isCategorized()&&"string"==typeof t.value&&(n=e.config.axis_x_categories.indexOf(t.value)),Math.ceil(e.x(n))},S.yv=function(t){var e=this,n=t.axis&&"y2"===t.axis?e.y2:e.y;return Math.ceil(n(t.value))},S.subxx=function(t){return t?this.subX(t.x):null},S.transformMain=function(t,e){var n=this,i,r,a;e&&e.axisX?i=e.axisX:(i=n.main.select("."+X.axisX),t&&(i=i.transition())),e&&e.axisY?r=e.axisY:(r=n.main.select("."+X.axisY),t&&(r=r.transition())),e&&e.axisY2?a=e.axisY2:(a=n.main.select("."+X.axisY2),t&&(a=a.transition())),(t?n.main.transition():n.main).attr("transform",n.getTranslate("main")),i.attr("transform",n.getTranslate("x")),r.attr("transform",n.getTranslate("y")),a.attr("transform",n.getTranslate("y2")),n.main.select("."+X.chartArcs).attr("transform",n.getTranslate("arc"))},S.transformAll=function(t,e){var n=this;n.transformMain(t,e),n.config.subchart_show&&n.transformContext(t,e),n.legend&&n.transformLegend(t)},S.updateSvgSize=function(){var t=this,e=t.svg.select(".c3-brush .background");t.svg.attr("width",t.currentWidth).attr("height",t.currentHeight),t.svg.selectAll(["#"+t.clipId,"#"+t.clipIdForGrid]).select("rect").attr("width",t.width).attr("height",t.height),t.svg.select("#"+t.clipIdForXAxis).select("rect").attr("x",t.getXAxisClipX.bind(t)).attr("y",t.getXAxisClipY.bind(t)).attr("width",t.getXAxisClipWidth.bind(t)).attr("height",t.getXAxisClipHeight.bind(t)),t.svg.select("#"+t.clipIdForYAxis).select("rect").attr("x",t.getYAxisClipX.bind(t)).attr("y",t.getYAxisClipY.bind(t)).attr("width",t.getYAxisClipWidth.bind(t)).attr("height",t.getYAxisClipHeight.bind(t)),t.svg.select("#"+t.clipIdForSubchart).select("rect").attr("width",t.width).attr("height",e.size()?e.attr("height"):0),t.svg.select("."+X.zoomRect).attr("width",t.width).attr("height",t.height),
// MEMO: parent div's height will be bigger than svg when <!DOCTYPE html>
t.selectChart.style("max-height",t.currentHeight+"px")},S.updateDimension=function(t){var e=this;t||(e.config.axis_rotated?(e.axes.x.call(e.xAxis),e.axes.subx.call(e.subXAxis)):(e.axes.y.call(e.yAxis),e.axes.y2.call(e.y2Axis))),e.updateSizes(),e.updateScales(),e.updateSvgSize(),e.transformAll(!1)},S.observeInserted=function(e){var n=this,i;"undefined"!=typeof MutationObserver?(i=new MutationObserver(function(t){t.forEach(function(t){"childList"===t.type&&t.previousSibling&&(i.disconnect(),
// need to wait for completion of load because size calculation requires the actual sizes determined after that completion
n.intervalForObserveInserted=window.setInterval(function(){
// parentNode will NOT be null when completed
e.node().parentNode&&(window.clearInterval(n.intervalForObserveInserted),n.updateDimension(),n.brush&&n.brush.update(),n.config.oninit.call(n),n.redraw({withTransform:!0,withUpdateXDomain:!0,withUpdateOrgXDomain:!0,withTransition:!1,withTransitionForTransform:!1,withLegend:!0}),e.transition().style("opacity",1))},10))})})).observe(e.node(),{attributes:!0,childList:!0,characterData:!0}):window.console.error("MutationObserver not defined.")},S.bindResize=function(){var t=this,e=t.config;if(t.resizeFunction=t.generateResize(),// need to call .remove
t.resizeFunction.add(function(){e.onresize.call(t)}),e.resize_auto&&t.resizeFunction.add(function(){void 0!==t.resizeTimeout&&window.clearTimeout(t.resizeTimeout),t.resizeTimeout=window.setTimeout(function(){delete t.resizeTimeout,t.api.flush()},100)}),t.resizeFunction.add(function(){e.onresized.call(t)}),t.resizeIfElementDisplayed=function(){
// if element not displayed skip it
null!=t.api&&t.api.element.offsetParent&&t.resizeFunction()},window.attachEvent)window.attachEvent("onresize",t.resizeIfElementDisplayed);else if(window.addEventListener)window.addEventListener("resize",t.resizeIfElementDisplayed,!1);else{
// fallback to this, if this is a very old browser
var n=window.onresize;n?n.add&&n.remove||(
// there is already a handler registered, make sure we call it too
n=t.generateResize()).add(window.onresize):
// create a wrapper that will call all charts
n=t.generateResize(),
// add this graph to the wrapper, we will be removed if the user calls destroy
n.add(t.resizeFunction),window.onresize=function(){
// if element not displayed skip it
t.api.element.offsetParent&&n()}}},S.generateResize=function(){function t(){n.forEach(function(t){t()})}var n=[];return t.add=function(t){n.push(t)},t.remove=function(t){for(var e=0;e<n.length;e++)if(n[e]===t){n.splice(e,1);break}},t},S.endall=function(t,e){var n=0;t.each(function(){++n}).each("end",function(){--n||e.apply(this,arguments)})},S.generateWait=function(){var r=[],t=function t(e,n){var i=setInterval(function(){var e=0;r.forEach(function(t){if(t.empty())e+=1;else try{t.transition()}catch(t){e+=1}}),e===r.length&&(clearInterval(i),n&&n())},10)};return t.add=function(t){r.push(t)},t},S.parseDate=function(t){var e=this,n;return t instanceof Date?n=t:"string"==typeof t?n=e.dataTimeFormat(e.config.data_xFormat).parse(t):"object"===(void 0===t?"undefined":u(t))?n=new Date(+t):"number"!=typeof t||isNaN(t)||(n=new Date(+t)),n&&!isNaN(+n)||window.console.error("Failed to parse x '"+t+"' to Date object"),n},S.isTabVisible=function(){var t;return void 0!==document.hidden?
// Opera 12.10 and Firefox 18 and later support
t="hidden":void 0!==document.mozHidden?t="mozHidden":void 0!==document.msHidden?t="msHidden":void 0!==document.webkitHidden&&(t="webkitHidden"),!document[t]},S.isValue=C,S.isFunction=d,S.isString=l,S.isUndefined=A,S.isDefined=I,S.ceil10=h,S.asHalfPixel=f,S.diffDomain=O,S.isEmpty=g,S.notEmpty=L,S.notEmpty=L,S.getOption=H,S.hasValue=i,S.sanitise=x,S.getPathBox=v,S.CLASS=X,
/* jshint ignore:start */
// PhantomJS doesn't have support for Function.prototype.bind, which has caused confusion. Use
// this polyfill to avoid the confusion.
// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind#Polyfill
Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)
// closest thing possible to the ECMAScript 5
// internal IsCallable function
throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var n=Array.prototype.slice.call(arguments,1),i=this,r=function t(){},t=function t(){return i.apply(this instanceof r?this:e,n.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,t.prototype=new r,t}),"SVGPathSeg"in window||(
// Spec: http://www.w3.org/TR/SVG11/single-page.html#paths-InterfaceSVGPathSeg
window.SVGPathSeg=function(t,e,n){this.pathSegType=t,this.pathSegTypeAsLetter=e,this._owningPathSegList=n},window.SVGPathSeg.prototype.classname="SVGPathSeg",window.SVGPathSeg.PATHSEG_UNKNOWN=0,window.SVGPathSeg.PATHSEG_CLOSEPATH=1,window.SVGPathSeg.PATHSEG_MOVETO_ABS=2,window.SVGPathSeg.PATHSEG_MOVETO_REL=3,window.SVGPathSeg.PATHSEG_LINETO_ABS=4,window.SVGPathSeg.PATHSEG_LINETO_REL=5,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS=6,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL=7,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS=8,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL=9,window.SVGPathSeg.PATHSEG_ARC_ABS=10,window.SVGPathSeg.PATHSEG_ARC_REL=11,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS=12,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL=13,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS=14,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL=15,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS=16,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL=17,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS=18,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL=19,
// Notify owning PathSegList on any changes so they can be synchronized back to the path element.
window.SVGPathSeg.prototype._segmentChanged=function(){this._owningPathSegList&&this._owningPathSegList.segmentChanged(this)},window.SVGPathSegClosePath=function(t){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CLOSEPATH,"z",t)},window.SVGPathSegClosePath.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegClosePath.prototype.toString=function(){return"[object SVGPathSegClosePath]"},window.SVGPathSegClosePath.prototype._asPathString=function(){return this.pathSegTypeAsLetter},window.SVGPathSegClosePath.prototype.clone=function(){return new window.SVGPathSegClosePath(void 0)},window.SVGPathSegMovetoAbs=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_MOVETO_ABS,"M",t),this._x=e,this._y=n},window.SVGPathSegMovetoAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegMovetoAbs.prototype.toString=function(){return"[object SVGPathSegMovetoAbs]"},window.SVGPathSegMovetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegMovetoAbs.prototype.clone=function(){return new window.SVGPathSegMovetoAbs(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegMovetoAbs.prototype,"x",{get:function t(){return this._x},set:function t(e){this._x=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegMovetoAbs.prototype,"y",{get:function t(){return this._y},set:function t(e){this._y=e,this._segmentChanged()},enumerable:!0}),window.SVGPathSegMovetoRel=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_MOVETO_REL,"m",t),this._x=e,this._y=n},window.SVGPathSegMovetoRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegMovetoRel.prototype.toString=function(){return"[object SVGPathSegMovetoRel]"},window.SVGPathSegMovetoRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegMovetoRel.prototype.clone=function(){return new window.SVGPathSegMovetoRel(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegMovetoRel.prototype,"x",{get:function t(){return this._x},set:function t(e){this._x=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegMovetoRel.prototype,"y",{get:function t(){return this._y},set:function t(e){this._y=e,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoAbs=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_ABS,"L",t),this._x=e,this._y=n},window.SVGPathSegLinetoAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoAbs.prototype.toString=function(){return"[object SVGPathSegLinetoAbs]"},window.SVGPathSegLinetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegLinetoAbs.prototype.clone=function(){return new window.SVGPathSegLinetoAbs(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegLinetoAbs.prototype,"x",{get:function t(){return this._x},set:function t(e){this._x=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegLinetoAbs.prototype,"y",{get:function t(){return this._y},set:function t(e){this._y=e,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoRel=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_REL,"l",t),this._x=e,this._y=n},window.SVGPathSegLinetoRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoRel.prototype.toString=function(){return"[object SVGPathSegLinetoRel]"},window.SVGPathSegLinetoRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegLinetoRel.prototype.clone=function(){return new window.SVGPathSegLinetoRel(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegLinetoRel.prototype,"x",{get:function t(){return this._x},set:function t(e){this._x=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegLinetoRel.prototype,"y",{get:function t(){return this._y},set:function t(e){this._y=e,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicAbs=function(t,e,n,i,r,a,o){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS,"C",t),this._x=e,this._y=n,this._x1=i,this._y1=r,this._x2=a,this._y2=o},window.SVGPathSegCurvetoCubicAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicAbs]"},window.SVGPathSegCurvetoCubicAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicAbs(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"x",{get:function t(){return this._x},set:function t(e){this._x=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"y",{get:function t(){return this._y},set:function t(e){this._y=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"x1",{get:function t(){return this._x1},set:function t(e){this._x1=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"y1",{get:function t(){return this._y1},set:function t(e){this._y1=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"x2",{get:function t(){return this._x2},set:function t(e){this._x2=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"y2",{get:function t(){return this._y2},set:function t(e){this._y2=e,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicRel=function(t,e,n,i,r,a,o){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL,"c",t),this._x=e,this._y=n,this._x1=i,this._y1=r,this._x2=a,this._y2=o},window.SVGPathSegCurvetoCubicRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicRel]"},window.SVGPathSegCurvetoCubicRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicRel.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicRel(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"x",{get:function t(){return this._x},set:function t(e){this._x=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"y",{get:function t(){return this._y},set:function t(e){this._y=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"x1",{get:function t(){return this._x1},set:function t(e){this._x1=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"y1",{get:function t(){return this._y1},set:function t(e){this._y1=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"x2",{get:function t(){return this._x2},set:function t(e){this._x2=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"y2",{get:function t(){return this._y2},set:function t(e){this._y2=e,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticAbs=function(t,e,n,i,r){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS,"Q",t),this._x=e,this._y=n,this._x1=i,this._y1=r},window.SVGPathSegCurvetoQuadraticAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticAbs]"},window.SVGPathSegCurvetoQuadraticAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticAbs(void 0,this._x,this._y,this._x1,this._y1)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"x",{get:function t(){return this._x},set:function t(e){this._x=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"y",{get:function t(){return this._y},set:function t(e){this._y=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"x1",{get:function t(){return this._x1},set:function t(e){this._x1=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"y1",{get:function t(){return this._y1},set:function t(e){this._y1=e,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticRel=function(t,e,n,i,r){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL,"q",t),this._x=e,this._y=n,this._x1=i,this._y1=r},window.SVGPathSegCurvetoQuadraticRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticRel]"},window.SVGPathSegCurvetoQuadraticRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticRel.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticRel(void 0,this._x,this._y,this._x1,this._y1)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"x",{get:function t(){return this._x},set:function t(e){this._x=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"y",{get:function t(){return this._y},set:function t(e){this._y=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"x1",{get:function t(){return this._x1},set:function t(e){this._x1=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"y1",{get:function t(){return this._y1},set:function t(e){this._y1=e,this._segmentChanged()},enumerable:!0}),window.SVGPathSegArcAbs=function(t,e,n,i,r,a,o,s){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_ARC_ABS,"A",t),this._x=e,this._y=n,this._r1=i,this._r2=r,this._angle=a,this._largeArcFlag=o,this._sweepFlag=s},window.SVGPathSegArcAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegArcAbs.prototype.toString=function(){return"[object SVGPathSegArcAbs]"},window.SVGPathSegArcAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y},window.SVGPathSegArcAbs.prototype.clone=function(){return new window.SVGPathSegArcAbs(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)},Object.defineProperty(window.SVGPathSegArcAbs.prototype,"x",{get:function t(){return this._x},set:function t(e){this._x=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"y",{get:function t(){return this._y},set:function t(e){this._y=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"r1",{get:function t(){return this._r1},set:function t(e){this._r1=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"r2",{get:function t(){return this._r2},set:function t(e){this._r2=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"angle",{get:function t(){return this._angle},set:function t(e){this._angle=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"largeArcFlag",{get:function t(){return this._largeArcFlag},set:function t(e){this._largeArcFlag=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"sweepFlag",{get:function t(){return this._sweepFlag},set:function t(e){this._sweepFlag=e,this._segmentChanged()},enumerable:!0}),window.SVGPathSegArcRel=function(t,e,n,i,r,a,o,s){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_ARC_REL,"a",t),this._x=e,this._y=n,this._r1=i,this._r2=r,this._angle=a,this._largeArcFlag=o,this._sweepFlag=s},window.SVGPathSegArcRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegArcRel.prototype.toString=function(){return"[object SVGPathSegArcRel]"},window.SVGPathSegArcRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y},window.SVGPathSegArcRel.prototype.clone=function(){return new window.SVGPathSegArcRel(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)},Object.defineProperty(window.SVGPathSegArcRel.prototype,"x",{get:function t(){return this._x},set:function t(e){this._x=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"y",{get:function t(){return this._y},set:function t(e){this._y=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"r1",{get:function t(){return this._r1},set:function t(e){this._r1=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"r2",{get:function t(){return this._r2},set:function t(e){this._r2=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"angle",{get:function t(){return this._angle},set:function t(e){this._angle=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"largeArcFlag",{get:function t(){return this._largeArcFlag},set:function t(e){this._largeArcFlag=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"sweepFlag",{get:function t(){return this._sweepFlag},set:function t(e){this._sweepFlag=e,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoHorizontalAbs=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS,"H",t),this._x=e},window.SVGPathSegLinetoHorizontalAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoHorizontalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalAbs]"},window.SVGPathSegLinetoHorizontalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x},window.SVGPathSegLinetoHorizontalAbs.prototype.clone=function(){return new window.SVGPathSegLinetoHorizontalAbs(void 0,this._x)},Object.defineProperty(window.SVGPathSegLinetoHorizontalAbs.prototype,"x",{get:function t(){return this._x},set:function t(e){this._x=e,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoHorizontalRel=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL,"h",t),this._x=e},window.SVGPathSegLinetoHorizontalRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoHorizontalRel.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalRel]"},window.SVGPathSegLinetoHorizontalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x},window.SVGPathSegLinetoHorizontalRel.prototype.clone=function(){return new window.SVGPathSegLinetoHorizontalRel(void 0,this._x)},Object.defineProperty(window.SVGPathSegLinetoHorizontalRel.prototype,"x",{get:function t(){return this._x},set:function t(e){this._x=e,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoVerticalAbs=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS,"V",t),this._y=e},window.SVGPathSegLinetoVerticalAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoVerticalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalAbs]"},window.SVGPathSegLinetoVerticalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y},window.SVGPathSegLinetoVerticalAbs.prototype.clone=function(){return new window.SVGPathSegLinetoVerticalAbs(void 0,this._y)},Object.defineProperty(window.SVGPathSegLinetoVerticalAbs.prototype,"y",{get:function t(){return this._y},set:function t(e){this._y=e,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoVerticalRel=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL,"v",t),this._y=e},window.SVGPathSegLinetoVerticalRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoVerticalRel.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalRel]"},window.SVGPathSegLinetoVerticalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y},window.SVGPathSegLinetoVerticalRel.prototype.clone=function(){return new window.SVGPathSegLinetoVerticalRel(void 0,this._y)},Object.defineProperty(window.SVGPathSegLinetoVerticalRel.prototype,"y",{get:function t(){return this._y},set:function t(e){this._y=e,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicSmoothAbs=function(t,e,n,i,r){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS,"S",t),this._x=e,this._y=n,this._x2=i,this._y2=r},window.SVGPathSegCurvetoCubicSmoothAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothAbs]"},window.SVGPathSegCurvetoCubicSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicSmoothAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicSmoothAbs(void 0,this._x,this._y,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"x",{get:function t(){return this._x},set:function t(e){this._x=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"y",{get:function t(){return this._y},set:function t(e){this._y=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"x2",{get:function t(){return this._x2},set:function t(e){this._x2=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"y2",{get:function t(){return this._y2},set:function t(e){this._y2=e,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicSmoothRel=function(t,e,n,i,r){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL,"s",t),this._x=e,this._y=n,this._x2=i,this._y2=r},window.SVGPathSegCurvetoCubicSmoothRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothRel]"},window.SVGPathSegCurvetoCubicSmoothRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicSmoothRel.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicSmoothRel(void 0,this._x,this._y,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"x",{get:function t(){return this._x},set:function t(e){this._x=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"y",{get:function t(){return this._y},set:function t(e){this._y=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"x2",{get:function t(){return this._x2},set:function t(e){this._x2=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"y2",{get:function t(){return this._y2},set:function t(e){this._y2=e,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticSmoothAbs=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS,"T",t),this._x=e,this._y=n},window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothAbs]"},window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticSmoothAbs(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype,"x",{get:function t(){return this._x},set:function t(e){this._x=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype,"y",{get:function t(){return this._y},set:function t(e){this._y=e,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticSmoothRel=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL,"t",t),this._x=e,this._y=n},window.SVGPathSegCurvetoQuadraticSmoothRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothRel]"},window.SVGPathSegCurvetoQuadraticSmoothRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticSmoothRel.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticSmoothRel(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothRel.prototype,"x",{get:function t(){return this._x},set:function t(e){this._x=e,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothRel.prototype,"y",{get:function t(){return this._y},set:function t(e){this._y=e,this._segmentChanged()},enumerable:!0}),
// Add createSVGPathSeg* functions to window.SVGPathElement.
// Spec: http://www.w3.org/TR/SVG11/single-page.html#paths-Interfacewindow.SVGPathElement.
window.SVGPathElement.prototype.createSVGPathSegClosePath=function(){return new window.SVGPathSegClosePath(void 0)},window.SVGPathElement.prototype.createSVGPathSegMovetoAbs=function(t,e){return new window.SVGPathSegMovetoAbs(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegMovetoRel=function(t,e){return new window.SVGPathSegMovetoRel(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegLinetoAbs=function(t,e){return new window.SVGPathSegLinetoAbs(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegLinetoRel=function(t,e){return new window.SVGPathSegLinetoRel(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicAbs=function(t,e,n,i,r,a){return new window.SVGPathSegCurvetoCubicAbs(void 0,t,e,n,i,r,a)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicRel=function(t,e,n,i,r,a){return new window.SVGPathSegCurvetoCubicRel(void 0,t,e,n,i,r,a)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticAbs=function(t,e,n,i){return new window.SVGPathSegCurvetoQuadraticAbs(void 0,t,e,n,i)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticRel=function(t,e,n,i){return new window.SVGPathSegCurvetoQuadraticRel(void 0,t,e,n,i)},window.SVGPathElement.prototype.createSVGPathSegArcAbs=function(t,e,n,i,r,a,o){return new window.SVGPathSegArcAbs(void 0,t,e,n,i,r,a,o)},window.SVGPathElement.prototype.createSVGPathSegArcRel=function(t,e,n,i,r,a,o){return new window.SVGPathSegArcRel(void 0,t,e,n,i,r,a,o)},window.SVGPathElement.prototype.createSVGPathSegLinetoHorizontalAbs=function(t){return new window.SVGPathSegLinetoHorizontalAbs(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegLinetoHorizontalRel=function(t){return new window.SVGPathSegLinetoHorizontalRel(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegLinetoVerticalAbs=function(t){return new window.SVGPathSegLinetoVerticalAbs(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegLinetoVerticalRel=function(t){return new window.SVGPathSegLinetoVerticalRel(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothAbs=function(t,e,n,i){return new window.SVGPathSegCurvetoCubicSmoothAbs(void 0,t,e,n,i)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothRel=function(t,e,n,i){return new window.SVGPathSegCurvetoCubicSmoothRel(void 0,t,e,n,i)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothAbs=function(t,e){return new window.SVGPathSegCurvetoQuadraticSmoothAbs(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothRel=function(t,e){return new window.SVGPathSegCurvetoQuadraticSmoothRel(void 0,t,e)},"getPathSegAtLength"in window.SVGPathElement.prototype||(
// Add getPathSegAtLength to SVGPathElement.
// Spec: https://www.w3.org/TR/SVG11/single-page.html#paths-__svg__SVGPathElement__getPathSegAtLength
// This polyfill requires SVGPathElement.getTotalLength to implement the distance-along-a-path algorithm.
window.SVGPathElement.prototype.getPathSegAtLength=function(t){if(void 0===t||!isFinite(t))throw"Invalid arguments.";var e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("d",this.getAttribute("d"));var n=e.pathSegList.numberOfItems-1;
// If the path is empty, return 0.
if(n<=0)return 0;do{if(e.pathSegList.removeItem(n),t>e.getTotalLength())break;n--}while(0<n);return n})),"SVGPathSegList"in window||(
// Spec: http://www.w3.org/TR/SVG11/single-page.html#paths-InterfaceSVGPathSegList
window.SVGPathSegList=function(t){this._pathElement=t,this._list=this._parsePath(this._pathElement.getAttribute("d")),
// Use a MutationObserver to catch changes to the path's "d" attribute.
this._mutationObserverConfig={attributes:!0,attributeFilter:["d"]},this._pathElementMutationObserver=new MutationObserver(this._updateListFromPathMutations.bind(this)),this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)},window.SVGPathSegList.prototype.classname="SVGPathSegList",Object.defineProperty(window.SVGPathSegList.prototype,"numberOfItems",{get:function t(){return this._checkPathSynchronizedToList(),this._list.length},enumerable:!0}),
// Add the pathSegList accessors to window.SVGPathElement.
// Spec: http://www.w3.org/TR/SVG11/single-page.html#paths-InterfaceSVGAnimatedPathData
Object.defineProperty(window.SVGPathElement.prototype,"pathSegList",{get:function t(){return this._pathSegList||(this._pathSegList=new window.SVGPathSegList(this)),this._pathSegList},enumerable:!0}),
// FIXME: The following are not implemented and simply return window.SVGPathElement.pathSegList.
Object.defineProperty(window.SVGPathElement.prototype,"normalizedPathSegList",{get:function t(){return this.pathSegList},enumerable:!0}),Object.defineProperty(window.SVGPathElement.prototype,"animatedPathSegList",{get:function t(){return this.pathSegList},enumerable:!0}),Object.defineProperty(window.SVGPathElement.prototype,"animatedNormalizedPathSegList",{get:function t(){return this.pathSegList},enumerable:!0}),
// Process any pending mutations to the path element and update the list as needed.
// This should be the first call of all public functions and is needed because
// MutationObservers are not synchronous so we can have pending asynchronous mutations.
window.SVGPathSegList.prototype._checkPathSynchronizedToList=function(){this._updateListFromPathMutations(this._pathElementMutationObserver.takeRecords())},window.SVGPathSegList.prototype._updateListFromPathMutations=function(t){if(this._pathElement){var e=!1;t.forEach(function(t){"d"==t.attributeName&&(e=!0)}),e&&(this._list=this._parsePath(this._pathElement.getAttribute("d")))}},
// Serialize the list and update the path's 'd' attribute.
window.SVGPathSegList.prototype._writeListToPath=function(){this._pathElementMutationObserver.disconnect(),this._pathElement.setAttribute("d",window.SVGPathSegList._pathSegArrayAsString(this._list)),this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)},
// When a path segment changes the list needs to be synchronized back to the path element.
window.SVGPathSegList.prototype.segmentChanged=function(t){this._writeListToPath()},window.SVGPathSegList.prototype.clear=function(){this._checkPathSynchronizedToList(),this._list.forEach(function(t){t._owningPathSegList=null}),this._list=[],this._writeListToPath()},window.SVGPathSegList.prototype.initialize=function(t){return this._checkPathSynchronizedToList(),this._list=[t],(t._owningPathSegList=this)._writeListToPath(),t},window.SVGPathSegList.prototype._checkValidIndex=function(t){if(isNaN(t)||t<0||t>=this.numberOfItems)throw"INDEX_SIZE_ERR"},window.SVGPathSegList.prototype.getItem=function(t){return this._checkPathSynchronizedToList(),this._checkValidIndex(t),this._list[t]},window.SVGPathSegList.prototype.insertItemBefore=function(t,e){return this._checkPathSynchronizedToList(),
// Spec: If the index is greater than or equal to numberOfItems, then the new item is appended to the end of the list.
e>this.numberOfItems&&(e=this.numberOfItems),t._owningPathSegList&&(
// SVG2 spec says to make a copy.
t=t.clone()),this._list.splice(e,0,t),(t._owningPathSegList=this)._writeListToPath(),t},window.SVGPathSegList.prototype.replaceItem=function(t,e){return this._checkPathSynchronizedToList(),t._owningPathSegList&&(
// SVG2 spec says to make a copy.
t=t.clone()),this._checkValidIndex(e),((this._list[e]=t)._owningPathSegList=this)._writeListToPath(),t},window.SVGPathSegList.prototype.removeItem=function(t){this._checkPathSynchronizedToList(),this._checkValidIndex(t);var e=this._list[t];return this._list.splice(t,1),this._writeListToPath(),e},window.SVGPathSegList.prototype.appendItem=function(t){return this._checkPathSynchronizedToList(),t._owningPathSegList&&(
// SVG2 spec says to make a copy.
t=t.clone()),this._list.push(t),
// TODO: Optimize this to just append to the existing attribute.
(t._owningPathSegList=this)._writeListToPath(),t},window.SVGPathSegList._pathSegArrayAsString=function(t){var e="",n=!0;return t.forEach(function(t){n?(n=!1,e+=t._asPathString()):e+=" "+t._asPathString()}),e},
// This closely follows SVGPathParser::parsePath from Source/core/svg/SVGPathParser.cpp.
window.SVGPathSegList.prototype._parsePath=function(t){if(!t||0==t.length)return[];var i=this,e=function t(){this.pathSegList=[]};e.prototype.appendSegment=function(t){this.pathSegList.push(t)};var n=function t(e){this._string=e,this._currentIndex=0,this._endIndex=this._string.length,this._previousCommand=window.SVGPathSeg.PATHSEG_UNKNOWN,this._skipOptionalSpaces()};n.prototype._isCurrentSpace=function(){var t=this._string[this._currentIndex];return t<=" "&&(" "==t||"\n"==t||"\t"==t||"\r"==t||"\f"==t)},n.prototype._skipOptionalSpaces=function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex++;return this._currentIndex<this._endIndex},n.prototype._skipOptionalSpacesOrDelimiter=function(){return!(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!=this._string.charAt(this._currentIndex))&&(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","==this._string.charAt(this._currentIndex)&&(this._currentIndex++,this._skipOptionalSpaces()),this._currentIndex<this._endIndex)},n.prototype.hasMoreData=function(){return this._currentIndex<this._endIndex},n.prototype.peekSegmentType=function(){var t=this._string[this._currentIndex];return this._pathSegTypeFromChar(t)},n.prototype._pathSegTypeFromChar=function(t){switch(t){case"Z":case"z":return window.SVGPathSeg.PATHSEG_CLOSEPATH;case"M":return window.SVGPathSeg.PATHSEG_MOVETO_ABS;case"m":return window.SVGPathSeg.PATHSEG_MOVETO_REL;case"L":return window.SVGPathSeg.PATHSEG_LINETO_ABS;case"l":return window.SVGPathSeg.PATHSEG_LINETO_REL;case"C":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS;case"c":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL;case"Q":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS;case"q":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL;case"A":return window.SVGPathSeg.PATHSEG_ARC_ABS;case"a":return window.SVGPathSeg.PATHSEG_ARC_REL;case"H":return window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS;case"h":return window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL;case"V":return window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS;case"v":return window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL;case"S":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS;case"s":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL;case"T":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS;case"t":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL;default:return window.SVGPathSeg.PATHSEG_UNKNOWN}},n.prototype._nextCommandHelper=function(t,e){
// Check for remaining coordinates in the current command.
return("+"==t||"-"==t||"."==t||"0"<=t&&t<="9")&&e!=window.SVGPathSeg.PATHSEG_CLOSEPATH?e==window.SVGPathSeg.PATHSEG_MOVETO_ABS?window.SVGPathSeg.PATHSEG_LINETO_ABS:e==window.SVGPathSeg.PATHSEG_MOVETO_REL?window.SVGPathSeg.PATHSEG_LINETO_REL:e:window.SVGPathSeg.PATHSEG_UNKNOWN},n.prototype.initialCommandIsMoveTo=function(){
// If the path is empty it is still valid, so return true.
if(!this.hasMoreData())return!0;var t=this.peekSegmentType();
// Path must start with moveTo.
return t==window.SVGPathSeg.PATHSEG_MOVETO_ABS||t==window.SVGPathSeg.PATHSEG_MOVETO_REL},
// Parse a number from an SVG path. This very closely follows genericParseNumber(...) from Source/core/svg/SVGParserUtilities.cpp.
// Spec: http://www.w3.org/TR/SVG11/single-page.html#paths-PathDataBNF
n.prototype._parseNumber=function(){var t=0,e=0,n=1,i=0,r=1,a=1,o=this._currentIndex;if(this._skipOptionalSpaces(),
// Read the sign.
this._currentIndex<this._endIndex&&"+"==this._string.charAt(this._currentIndex)?this._currentIndex++:this._currentIndex<this._endIndex&&"-"==this._string.charAt(this._currentIndex)&&(this._currentIndex++,r=-1),!(this._currentIndex==this._endIndex||(this._string.charAt(this._currentIndex)<"0"||"9"<this._string.charAt(this._currentIndex))&&"."!=this._string.charAt(this._currentIndex))){for(
// Read the integer part, build right-to-left.
var s=this._currentIndex;this._currentIndex<this._endIndex&&"0"<=this._string.charAt(this._currentIndex)&&this._string.charAt(this._currentIndex)<="9";)this._currentIndex++;// Advance to first non-digit.
if(this._currentIndex!=s)for(var u=this._currentIndex-1,c=1;s<=u;)e+=c*(this._string.charAt(u--)-"0"),c*=10;
// Read the decimals.
if(this._currentIndex<this._endIndex&&"."==this._string.charAt(this._currentIndex)){
// There must be a least one digit following the .
if(this._currentIndex++,this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||"9"<this._string.charAt(this._currentIndex))return;for(;this._currentIndex<this._endIndex&&"0"<=this._string.charAt(this._currentIndex)&&this._string.charAt(this._currentIndex)<="9";)n*=10,i+=(this._string.charAt(this._currentIndex)-"0")/n,this._currentIndex+=1}
// Read the exponent part.
if(this._currentIndex!=o&&this._currentIndex+1<this._endIndex&&("e"==this._string.charAt(this._currentIndex)||"E"==this._string.charAt(this._currentIndex))&&"x"!=this._string.charAt(this._currentIndex+1)&&"m"!=this._string.charAt(this._currentIndex+1)){
// There must be an exponent.
if(this._currentIndex++,
// Read the sign of the exponent.
"+"==this._string.charAt(this._currentIndex)?this._currentIndex++:"-"==this._string.charAt(this._currentIndex)&&(this._currentIndex++,a=-1),this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||"9"<this._string.charAt(this._currentIndex))return;for(;this._currentIndex<this._endIndex&&"0"<=this._string.charAt(this._currentIndex)&&this._string.charAt(this._currentIndex)<="9";)t*=10,t+=this._string.charAt(this._currentIndex)-"0",this._currentIndex++}var l=e+i;if(l*=r,t&&(l*=Math.pow(10,a*t)),o!=this._currentIndex)return this._skipOptionalSpacesOrDelimiter(),l}},n.prototype._parseArcFlag=function(){if(!(this._currentIndex>=this._endIndex)){var t=!1,e=this._string.charAt(this._currentIndex++);if("0"==e)t=!1;else{if("1"!=e)return;t=!0}return this._skipOptionalSpacesOrDelimiter(),t}},n.prototype.parseSegment=function(){var t=this._string[this._currentIndex],e=this._pathSegTypeFromChar(t);if(e==window.SVGPathSeg.PATHSEG_UNKNOWN){
// Possibly an implicit command. Not allowed if this is the first command.
if(this._previousCommand==window.SVGPathSeg.PATHSEG_UNKNOWN)return null;if((e=this._nextCommandHelper(t,this._previousCommand))==window.SVGPathSeg.PATHSEG_UNKNOWN)return null}else this._currentIndex++;switch(this._previousCommand=e){case window.SVGPathSeg.PATHSEG_MOVETO_REL:return new window.SVGPathSegMovetoRel(i,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_MOVETO_ABS:return new window.SVGPathSegMovetoAbs(i,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_REL:return new window.SVGPathSegLinetoRel(i,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_ABS:return new window.SVGPathSegLinetoAbs(i,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL:return new window.SVGPathSegLinetoHorizontalRel(i,this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS:return new window.SVGPathSegLinetoHorizontalAbs(i,this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL:return new window.SVGPathSegLinetoVerticalRel(i,this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS:return new window.SVGPathSegLinetoVerticalAbs(i,this._parseNumber());case window.SVGPathSeg.PATHSEG_CLOSEPATH:return this._skipOptionalSpaces(),new window.SVGPathSegClosePath(i);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL:var n={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegCurvetoCubicRel(i,n.x,n.y,n.x1,n.y1,n.x2,n.y2);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:var n={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegCurvetoCubicAbs(i,n.x,n.y,n.x1,n.y1,n.x2,n.y2);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL:var n={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegCurvetoCubicSmoothRel(i,n.x,n.y,n.x2,n.y2);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS:var n={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegCurvetoCubicSmoothAbs(i,n.x,n.y,n.x2,n.y2);case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL:var n={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegCurvetoQuadraticRel(i,n.x,n.y,n.x1,n.y1);case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS:var n={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegCurvetoQuadraticAbs(i,n.x,n.y,n.x1,n.y1);case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL:return new window.SVGPathSegCurvetoQuadraticSmoothRel(i,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS:return new window.SVGPathSegCurvetoQuadraticSmoothAbs(i,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_ARC_REL:var n={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegArcRel(i,n.x,n.y,n.x1,n.y1,n.arcAngle,n.arcLarge,n.arcSweep);case window.SVGPathSeg.PATHSEG_ARC_ABS:var n={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegArcAbs(i,n.x,n.y,n.x1,n.y1,n.arcAngle,n.arcLarge,n.arcSweep);default:throw"Unknown path seg type."}};var r=new e,a=new n(t);if(!a.initialCommandIsMoveTo())return[];for(;a.hasMoreData();){var o=a.parseSegment();if(!o)return[];r.appendSegment(o)}return r.pathSegList}),
/* jshint ignore:end */
w.axis=function(){},w.axis.labels=function(e){var n=this.internal;arguments.length&&(Object.keys(e).forEach(function(t){n.axis.setLabelText(t,e[t])}),n.axis.updateLabels());
// TODO: return some values?
},w.axis.max=function(t){var e=this.internal,n=e.config;if(!arguments.length)return{x:n.axis_x_max,y:n.axis_y_max,y2:n.axis_y2_max};"object"===(void 0===t?"undefined":u(t))?(C(t.x)&&(n.axis_x_max=t.x),C(t.y)&&(n.axis_y_max=t.y),C(t.y2)&&(n.axis_y2_max=t.y2)):n.axis_y_max=n.axis_y2_max=t,e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})},w.axis.min=function(t){var e=this.internal,n=e.config;if(!arguments.length)return{x:n.axis_x_min,y:n.axis_y_min,y2:n.axis_y2_min};"object"===(void 0===t?"undefined":u(t))?(C(t.x)&&(n.axis_x_min=t.x),C(t.y)&&(n.axis_y_min=t.y),C(t.y2)&&(n.axis_y2_min=t.y2)):n.axis_y_min=n.axis_y2_min=t,e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})},w.axis.range=function(t){if(!arguments.length)return{max:this.axis.max(),min:this.axis.min()};I(t.max)&&this.axis.max(t.max),I(t.min)&&this.axis.min(t.min)},w.category=function(t,e){var n=this.internal,i=n.config;return 1<arguments.length&&(i.axis_x_categories[t]=e,n.redraw()),i.axis_x_categories[t]},w.categories=function(t){var e=this.internal,n=e.config;return arguments.length&&(n.axis_x_categories=t,e.redraw()),n.axis_x_categories},w.resize=function(t){var e,n=this.internal.config;n.size_width=t?t.width:null,n.size_height=t?t.height:null,this.flush()},w.flush=function(){var t;this.internal.updateAndRedraw({withLegend:!0,withTransition:!1,withTransitionForTransform:!1})},w.destroy=function(){var e=this.internal;if(window.clearInterval(e.intervalForObserveInserted),void 0!==e.resizeTimeout&&window.clearTimeout(e.resizeTimeout),window.detachEvent)window.detachEvent("onresize",e.resizeIfElementDisplayed);else if(window.removeEventListener)window.removeEventListener("resize",e.resizeIfElementDisplayed);else{var t=window.onresize;
// check if no one else removed our wrapper and remove our resizeFunction from it
t&&t.add&&t.remove&&t.remove(e.resizeFunction)}
// remove the inner resize functions
return e.resizeFunction.remove(),e.selectChart.classed("c3",!1).html(""),
// MEMO: this is needed because the reference of some elements will not be released, then memory leak will happen.
Object.keys(e).forEach(function(t){e[t]=null}),null},
// TODO: fix
w.color=function(t){var e;return this.internal.color(t);// more patterns
},w.data=function(e){var t=this.internal.data.targets;return void 0===e?t:t.filter(function(t){return 0<=[].concat(e).indexOf(t.id)})},w.data.shown=function(t){return this.internal.filterTargetsToShow(this.data(t))},w.data.values=function(t){var e,n=null;return t&&(n=(e=this.data(t))[0]?e[0].values.map(function(t){return t.value}):null),n},w.data.names=function(t){return this.internal.clearLegendItemTextBoxCache(),this.internal.updateDataAttributes("names",t)},w.data.colors=function(t){return this.internal.updateDataAttributes("colors",t)},w.data.axes=function(t){return this.internal.updateDataAttributes("axes",t)},w.flow=function(t){var r=this.internal,a,e,o=[],n=r.getMaxDataCount(),i,s,u,c,l=0,h=0,d,f;if(t.json)e=r.convertJsonToData(t.json,t.keys);else if(t.rows)e=r.convertRowsToData(t.rows);else{if(!t.columns)return;e=r.convertColumnsToData(t.columns)}a=r.convertDataToTargets(e,!0),
// Update/Add data
r.data.targets.forEach(function(t){var e=!1,n,i;for(n=0;n<a.length;n++)if(t.id===a[n].id){for(e=!0,t.values[t.values.length-1]&&(h=t.values[t.values.length-1].index+1),l=a[n].values.length,i=0;i<l;i++)a[n].values[i].index=h+i,r.isTimeSeries()||(a[n].values[i].x=h+i);t.values=t.values.concat(a[n].values),a.splice(n,1);break}e||o.push(t.id)}),
// Append null for not found targets
r.data.targets.forEach(function(t){var e,n;for(e=0;e<o.length;e++)if(t.id===o[e])for(h=t.values[t.values.length-1].index+1,n=0;n<l;n++)t.values.push({id:t.id,index:h+n,x:r.isTimeSeries()?r.getOtherTargetX(h+n):h+n,value:null})}),
// Generate null values for new target
r.data.targets.length&&a.forEach(function(t){var e,n=[];for(e=r.data.targets[0].values[0].index;e<h;e++)n.push({id:t.id,index:e,x:r.isTimeSeries()?r.getOtherTargetX(e):e,value:null});t.values.forEach(function(t){t.index+=h,r.isTimeSeries()||(t.x+=h)}),t.values=n.concat(t.values)}),r.data.targets=r.data.targets.concat(a),// add remained
// check data count because behavior needs to change when it's only one
i=r.getMaxDataCount(),c=(u=r.data.targets[0]).values[0],
// Update length to flow if needed
I(t.to)?(l=0,f=r.isTimeSeries()?r.parseDate(t.to):t.to,u.values.forEach(function(t){t.x<f&&l++})):I(t.length)&&(l=t.length),
// If only one data, update the domain to flow from left edge of the chart
n?1===n&&r.isTimeSeries()&&(d=(u.values[u.values.length-1].x-c.x)/2,s=[new Date(+c.x-d),new Date(+c.x+d)],r.updateXDomain(null,!0,!0,!1,s)):(d=r.isTimeSeries()?1<u.values.length?u.values[u.values.length-1].x-c.x:c.x-r.getXDomain(r.data.targets)[0]:1,s=[c.x-d,c.x],r.updateXDomain(null,!0,!0,!1,s)),
// Set targets
r.updateTargets(r.data.targets),
// Redraw with new targets
r.redraw({flow:{index:c.index,length:l,duration:C(t.duration)?t.duration:r.config.transition_duration,done:t.done,orgDataCount:n},withLegend:!0,withTransition:1<n,withTrimXDomain:!1,withUpdateXAxis:!0})},S.generateFlow=function(V){var G=this,k=G.config,R=G.d3;return function(){var t=V.targets,e=V.flow,r=V.drawBar,a=V.drawLine,o=V.drawArea,s=V.cx,u=V.cy,c=V.xv,l=V.xForText,h=V.yForText,n=V.duration,i,d=1,f,g=e.index,p=e.length,x=G.getValueOnIndex(G.data.targets[0].values,g),_=G.getValueOnIndex(G.data.targets[0].values,g+p),v=G.x.domain(),y,m=e.duration||n,w=e.done||function(){},S=G.generateWait(),b=G.xgrid||R.selectAll([]),A=G.xgridLines||R.selectAll([]),T=G.mainRegion||R.selectAll([]),P=G.mainText||R.selectAll([]),C=G.mainBar||R.selectAll([]),L=G.mainLine||R.selectAll([]),M=G.mainArea||R.selectAll([]),E=G.mainCircle||R.selectAll([]);
// set flag
G.flowing=!0,
// remove head data after rendered
G.data.targets.forEach(function(t){t.values.splice(0,p)}),
// update x domain to generate axis elements for flow
y=G.updateXDomain(t,!0,!0),
// update elements related to x scale
G.updateXGrid&&G.updateXGrid(!0),
// generate transform to flow
i=e.orgDataCount?1===e.orgDataCount||(x&&x.x)===(_&&_.x)?G.x(v[0])-G.x(y[0]):G.isTimeSeries()?G.x(v[0])-G.x(y[0]):G.x(x.x)-G.x(_.x):
// if empty
1!==G.data.targets[0].values.length?G.x(v[0])-G.x(y[0]):G.isTimeSeries()?(x=G.getValueOnIndex(G.data.targets[0].values,0),_=G.getValueOnIndex(G.data.targets[0].values,G.data.targets[0].values.length-1),G.x(x.x)-G.x(_.x)):O(y)/2,d=O(v)/O(y),f="translate("+i+",0) scale("+d+",1)",G.hideXGridFocus(),R.transition().ease("linear").duration(m).each(function(){S.add(G.axes.x.transition().call(G.xAxis)),S.add(C.transition().attr("transform",f)),S.add(L.transition().attr("transform",f)),S.add(M.transition().attr("transform",f)),S.add(E.transition().attr("transform",f)),S.add(P.transition().attr("transform",f)),S.add(T.filter(G.isRegionOnX).transition().attr("transform",f)),S.add(b.transition().attr("transform",f)),S.add(A.transition().attr("transform",f))}).call(S,function(){var t,e=[],n=[],i=[];
// remove flowed elements
if(p){for(t=0;t<p;t++)e.push("."+X.shape+"-"+(g+t)),n.push("."+X.text+"-"+(g+t)),i.push("."+X.eventRect+"-"+(g+t));G.svg.selectAll("."+X.shapes).selectAll(e).remove(),G.svg.selectAll("."+X.texts).selectAll(n).remove(),G.svg.selectAll("."+X.eventRects).selectAll(i).remove(),G.svg.select("."+X.xgrid).remove()}
// draw again for removing flowed elements and reverting attr
b.attr("transform",null).attr(G.xgridAttr),A.attr("transform",null),A.select("line").attr("x1",k.axis_rotated?0:c).attr("x2",k.axis_rotated?G.width:c),A.select("text").attr("x",k.axis_rotated?G.width:0).attr("y",c),C.attr("transform",null).attr("d",r),L.attr("transform",null).attr("d",a),M.attr("transform",null).attr("d",o),E.attr("transform",null).attr("cx",s).attr("cy",u),P.attr("transform",null).attr("x",l).attr("y",h).style("fill-opacity",G.opacityForText.bind(G)),T.attr("transform",null),T.select("rect").filter(G.isRegionOnX).attr("x",G.regionX.bind(G)).attr("width",G.regionWidth.bind(G)),k.interaction_enabled&&G.redrawEventRect(),
// callback for end of flow
w(),G.flowing=!1})}},w.focus=function(e){var t=this.internal,n;e=t.mapToTargetIds(e),n=t.svg.selectAll(t.selectorTargets(e.filter(t.isTargetToShow,t))),this.revert(),this.defocus(),n.classed(X.focused,!0).classed(X.defocused,!1),t.hasArcType()&&t.expandArc(e),t.toggleFocusLegend(e,!0),t.focusedTargetIds=e,t.defocusedTargetIds=t.defocusedTargetIds.filter(function(t){return e.indexOf(t)<0})},w.defocus=function(e){var t=this.internal,n;e=t.mapToTargetIds(e),(n=t.svg.selectAll(t.selectorTargets(e.filter(t.isTargetToShow,t)))).classed(X.focused,!1).classed(X.defocused,!0),t.hasArcType()&&t.unexpandArc(e),t.toggleFocusLegend(e,!1),t.focusedTargetIds=t.focusedTargetIds.filter(function(t){return e.indexOf(t)<0}),t.defocusedTargetIds=e},w.revert=function(t){var e=this.internal,n;t=e.mapToTargetIds(t),// should be for all targets
(n=e.svg.selectAll(e.selectorTargets(t))).classed(X.focused,!1).classed(X.defocused,!1),e.hasArcType()&&e.unexpandArc(t),e.config.legend_show&&(e.showLegend(t.filter(e.isLegendToShow.bind(e))),e.legend.selectAll(e.selectorLegends(t)).filter(function(){return e.d3.select(this).classed(X.legendItemFocused)}).classed(X.legendItemFocused,!1)),e.focusedTargetIds=[],e.defocusedTargetIds=[]},w.xgrids=function(t){var e=this.internal,n=e.config;return t&&(n.grid_x_lines=t,e.redrawWithoutRescale()),n.grid_x_lines},w.xgrids.add=function(t){var e=this.internal;return this.xgrids(e.config.grid_x_lines.concat(t||[]))},w.xgrids.remove=function(t){
// TODO: multiple
var e;this.internal.removeGridLines(t,!0)},w.ygrids=function(t){var e=this.internal,n=e.config;return t&&(n.grid_y_lines=t,e.redrawWithoutRescale()),n.grid_y_lines},w.ygrids.add=function(t){var e=this.internal;return this.ygrids(e.config.grid_y_lines.concat(t||[]))},w.ygrids.remove=function(t){
// TODO: multiple
var e;this.internal.removeGridLines(t,!1)},w.groups=function(t){var e=this.internal,n=e.config;return A(t)||(n.data_groups=t,e.redraw()),n.data_groups},w.legend=function(){},w.legend.show=function(t){var e=this.internal;e.showLegend(e.mapToTargetIds(t)),e.updateAndRedraw({withLegend:!0})},w.legend.hide=function(t){var e=this.internal;e.hideLegend(e.mapToTargetIds(t)),e.updateAndRedraw({withLegend:!0})},w.load=function(e){var t=this.internal,n=t.config;
// update xs if specified
e.xs&&t.addXs(e.xs),
// update names if exists
"names"in e&&w.data.names.bind(this)(e.names),
// update classes if exists
"classes"in e&&Object.keys(e.classes).forEach(function(t){n.data_classes[t]=e.classes[t]}),
// update categories if exists
"categories"in e&&t.isCategorized()&&(n.axis_x_categories=e.categories),
// update axes if exists
"axes"in e&&Object.keys(e.axes).forEach(function(t){n.data_axes[t]=e.axes[t]}),
// update colors if exists
"colors"in e&&Object.keys(e.colors).forEach(function(t){n.data_colors[t]=e.colors[t]}),
// use cache if exists
"cacheIds"in e&&t.hasCaches(e.cacheIds)?t.load(t.getCaches(e.cacheIds),e.done):
// unload if needed
"unload"in e?
// TODO: do not unload if target will load (included in url/rows/columns)
t.unload(t.mapToTargetIds("boolean"==typeof e.unload&&e.unload?null:e.unload),function(){t.loadFromArgs(e)}):t.loadFromArgs(e)},w.unload=function(t){var e=this.internal;(t=t||{})instanceof Array?t={ids:t}:"string"==typeof t&&(t={ids:[t]}),e.unload(e.mapToTargetIds(t.ids),function(){e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0}),t.done&&t.done()})},w.regions=function(t){var e=this.internal,n=e.config;return t&&(n.regions=t,e.redrawWithoutRescale()),n.regions},w.regions.add=function(t){var e=this.internal,n=e.config;return t&&(n.regions=n.regions.concat(t),e.redrawWithoutRescale()),n.regions},w.regions.remove=function(t){var e=this.internal,n=e.config,i,r,a;return t=t||{},i=e.getOption(t,"duration",n.transition_duration),r=e.getOption(t,"classes",[X.region]),a=e.main.select("."+X.regions).selectAll(r.map(function(t){return"."+t})),(i?a.transition().duration(i):a).style("opacity",0).remove(),n.regions=n.regions.filter(function(t){var e=!1;return!t.class||(t.class.split(" ").forEach(function(t){0<=r.indexOf(t)&&(e=!0)}),!e)}),n.regions},w.selected=function(t){var e=this.internal,n=e.d3;return n.merge(e.main.selectAll("."+X.shapes+e.getTargetSelectorSuffix(t)).selectAll("."+X.shape).filter(function(){return n.select(this).classed(X.SELECTED)}).map(function(t){return t.map(function(t){var e=t.__data__;return e.data?e.data:e})}))},w.select=function(u,c,l){var h=this.internal,d=h.d3,f=h.config;f.data_selection_enabled&&h.main.selectAll("."+X.shapes).selectAll("."+X.shape).each(function(t,e){var n=d.select(this),i=t.data?t.data.id:t.id,r=h.getToggle(this,t).bind(h),a=f.data_selection_grouped||!u||0<=u.indexOf(i),o=!c||0<=c.indexOf(e),s=n.classed(X.SELECTED);
// line/area selection not supported yet
n.classed(X.line)||n.classed(X.area)||(a&&o?f.data_selection_isselectable(t)&&!s&&r(!0,n.classed(X.SELECTED,!0),t,e):I(l)&&l&&s&&r(!1,n.classed(X.SELECTED,!1),t,e))})},w.unselect=function(u,c){var l=this.internal,h=l.d3,d=l.config;d.data_selection_enabled&&l.main.selectAll("."+X.shapes).selectAll("."+X.shape).each(function(t,e){var n=h.select(this),i=t.data?t.data.id:t.id,r=l.getToggle(this,t).bind(l),a=d.data_selection_grouped||!u||0<=u.indexOf(i),o=!c||0<=c.indexOf(e),s=n.classed(X.SELECTED);
// line/area selection not supported yet
n.classed(X.line)||n.classed(X.area)||a&&o&&d.data_selection_isselectable(t)&&s&&r(!1,n.classed(X.SELECTED,!1),t,e)})},w.show=function(t,e){var n=this.internal,i;t=n.mapToTargetIds(t),e=e||{},n.removeHiddenTargetIds(t),(i=n.svg.selectAll(n.selectorTargets(t))).transition().style("opacity",1,"important").call(n.endall,function(){i.style("opacity",null).style("opacity",1)}),e.withLegend&&n.showLegend(t),n.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0})},w.hide=function(t,e){var n=this.internal,i;t=n.mapToTargetIds(t),e=e||{},n.addHiddenTargetIds(t),(i=n.svg.selectAll(n.selectorTargets(t))).transition().style("opacity",0,"important").call(n.endall,function(){i.style("opacity",null).style("opacity",0)}),e.withLegend&&n.hideLegend(t),n.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0})},w.toggle=function(t,e){var n=this,i=this.internal;i.mapToTargetIds(t).forEach(function(t){i.isTargetToShow(t)?n.hide(t,e):n.show(t,e)})},w.tooltip=function(){},w.tooltip.show=function(t){var e=this.internal,n,i;
// determine mouse position on the chart
t.mouse&&(i=t.mouse),
// determine focus data
t.data?n=e.isMultipleX()?(
// if multiple xs, target point will be determined by mouse
i=[e.x(t.data.x),e.getYScale(t.data.id)(t.data.value)],null):C(t.data.index)?t.data.index:e.getIndexByX(t.data.x):void 0!==t.x?n=e.getIndexByX(t.x):void 0!==t.index&&(n=t.index),
// emulate mouse events to show
e.dispatchEvent("mouseover",n,i),e.dispatchEvent("mousemove",n,i),e.config.tooltip_onshow.call(e,t.data)},w.tooltip.hide=function(){
// TODO: get target data by checking the state of focus
this.internal.dispatchEvent("mouseout",0),this.internal.config.tooltip_onhide.call(this)},w.transform=function(t,e){var n=this.internal,i=0<=["pie","donut"].indexOf(t)?{withTransform:!0}:null;n.transformTo(e,t,i)},S.transformTo=function(t,e,n){var i=this,r=!i.hasArcType(),a=n||{withTransitionForAxis:r};a.withTransitionForTransform=!1,i.transiting=!1,i.setTargetType(t,e),i.updateTargets(i.data.targets),// this is needed when transforming to arc
i.updateAndRedraw(a)},w.x=function(t){var e=this.internal;return arguments.length&&(e.updateTargetX(e.data.targets,t),e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})),e.data.xs},w.xs=function(t){var e=this.internal;return arguments.length&&(e.updateTargetXs(e.data.targets,t),e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})),e.data.xs},w.zoom=function(t){var e=this.internal;return t&&(e.isTimeSeries()&&(t=t.map(function(t){return e.parseDate(t)})),e.brush.extent(t),e.redraw({withUpdateXDomain:!0,withY:e.config.zoom_rescale}),e.config.zoom_onzoom.call(this,e.x.orgDomain())),e.brush.extent()},w.zoom.enable=function(t){var e=this.internal;e.config.zoom_enabled=t,e.updateAndRedraw()},w.unzoom=function(){var t=this.internal;t.brush.clear().update(),t.redraw({withUpdateXDomain:!0})},w.zoom.max=function(t){var e=this.internal,n=e.config,i=e.d3;if(0!==t&&!t)return n.zoom_x_max;n.zoom_x_max=i.max([e.orgXDomain[1],t])},w.zoom.min=function(t){var e=this.internal,n=e.config,i=e.d3;if(0!==t&&!t)return n.zoom_x_min;n.zoom_x_min=i.min([e.orgXDomain[0],t])},w.zoom.range=function(t){if(!arguments.length)return{max:this.domain.max(),min:this.domain.min()};I(t.max)&&this.domain.max(t.max),I(t.min)&&this.domain.min(t.min)},S.initPie=function(){var t=this,e=t.d3;t.pie=e.layout.pie().value(function(t){return t.values.reduce(function(t,e){return t+e.value},0)}),t.pie.sort(t.getOrderFunction()||null)},S.updateRadius=function(){var t=this,e=t.config,n=e.gauge_width||e.donut_width,i=t.filterTargetsToShow(t.data.targets).length*t.config.gauge_arcs_minWidth;t.radiusExpanded=Math.min(t.arcWidth,t.arcHeight)/2*(t.hasType("gauge")?.85:1),t.radius=.95*t.radiusExpanded,t.innerRadiusRatio=n?(t.radius-n)/t.radius:.6,t.innerRadius=t.hasType("donut")||t.hasType("gauge")?t.radius*t.innerRadiusRatio:0,t.gaugeArcWidth=n||(i<=t.radius-t.innerRadius?t.radius-t.innerRadius:i<=t.radius?i:t.radius)},S.updateArc=function(){var t=this;t.svgArc=t.getSvgArc(),t.svgArcExpanded=t.getSvgArcExpanded(),t.svgArcExpandedSub=t.getSvgArcExpanded(.98)},S.updateAngle=function(e){var t=this,n=t.config,i=!1,r=0,a,o,s,u;return n?(t.pie(t.filterTargetsToShow(t.data.targets)).forEach(function(t){i||t.data.id!==e.data.id||(i=!0,(e=t).index=r),r++}),isNaN(e.startAngle)&&(e.startAngle=0),isNaN(e.endAngle)&&(e.endAngle=e.startAngle),t.isGaugeType(e.data)&&(a=n.gauge_min,o=n.gauge_max,s=Math.PI*(n.gauge_fullCircle?2:1)/(o-a),u=e.value<a?0:e.value<o?e.value-a:o-a,e.startAngle=n.gauge_startingAngle,e.endAngle=e.startAngle+s*u),i?e:null):null},S.getSvgArc=function(){var r=this,e=r.hasType("gauge"),n=r.gaugeArcWidth/r.filterTargetsToShow(r.data.targets).length,a=r.d3.svg.arc().outerRadius(function(t){return e?r.radius-n*t.index:r.radius}).innerRadius(function(t){return e?r.radius-n*(t.index+1):r.innerRadius}),t=function t(e,n){var i;return n?a(e):(// for interpolate
i=r.updateAngle(e))?a(i):"M 0 0"};
// TODO: extends all function
return t.centroid=a.centroid,t},S.getSvgArcExpanded=function(e){e=e||1;var n=this,i=n.hasType("gauge"),r=n.gaugeArcWidth/n.filterTargetsToShow(n.data.targets).length,a=Math.min(n.radiusExpanded*e-n.radius,.8*r-100*(1-e)),o=n.d3.svg.arc().outerRadius(function(t){return i?n.radius-r*t.index+a:n.radiusExpanded*e}).innerRadius(function(t){return i?n.radius-r*(t.index+1):n.innerRadius});return function(t){var e=n.updateAngle(t);return e?o(e):"M 0 0"}},S.getArc=function(t,e,n){return n||this.isArcType(t.data)?this.svgArc(t,e):"M 0 0"},S.transformForArcLabel=function(t){var e=this,n=e.config,i=e.updateAngle(t),r,a,o,s,u,c="",l=e.hasType("gauge");if(i&&!l)r=this.svgArc.centroid(i),a=isNaN(r[0])?0:r[0],o=isNaN(r[1])?0:r[1],s=Math.sqrt(a*a+o*o),c="translate("+a*(u=e.hasType("donut")&&n.donut_label_ratio?d(n.donut_label_ratio)?n.donut_label_ratio(t,e.radius,s):n.donut_label_ratio:e.hasType("pie")&&n.pie_label_ratio?d(n.pie_label_ratio)?n.pie_label_ratio(t,e.radius,s):n.pie_label_ratio:e.radius&&s?(.375<36/e.radius?1.175-36/e.radius:.8)*e.radius/s:0)+","+o*u+")";else if(i&&l&&1<e.filterTargetsToShow(e.data.targets).length){var h=Math.sin(i.endAngle-Math.PI/2);c="translate("+(a=Math.cos(i.endAngle-Math.PI/2)*(e.radiusExpanded+25))+","+(o=h*(e.radiusExpanded+15-Math.abs(10*h))+3)+")"}return c},S.getArcRatio=function(t){var e=this,n=e.config,i=Math.PI*(e.hasType("gauge")&&!n.gauge_fullCircle?1:2);return t?(t.endAngle-t.startAngle)/i:null},S.convertToArcData=function(t){return this.addName({id:t.data.id,value:t.value,ratio:this.getArcRatio(t),index:t.index})},S.textForArcLabel=function(t){var e=this,n,i,r,a,o;return e.shouldShowArcLabel()?(i=(n=e.updateAngle(t))?n.value:null,r=e.getArcRatio(n),a=t.data.id,e.hasType("gauge")||e.meetsArcLabelThreshold(r)?(o=e.getArcLabelFormat())?o(i,r,a):e.defaultArcValueFormat(i,r):""):""},S.textForGaugeMinMax=function(t,e){var n,i=this.getGaugeLabelExtents();return i?i(t,e):t},S.expandArc=function(t){var e=this,n;
// MEMO: avoid to cancel transition
e.transiting?n=window.setInterval(function(){e.transiting||(window.clearInterval(n),0<e.legend.selectAll(".c3-legend-item-focused").size()&&e.expandArc(t))},10):(t=e.mapToTargetIds(t),e.svg.selectAll(e.selectorTargets(t,"."+X.chartArc)).each(function(t){e.shouldExpand(t.data.id)&&e.d3.select(this).selectAll("path").transition().duration(e.expandDuration(t.data.id)).attr("d",e.svgArcExpanded).transition().duration(2*e.expandDuration(t.data.id)).attr("d",e.svgArcExpandedSub).each(function(t){e.isDonutType(t.data)})}))},S.unexpandArc=function(t){var e=this;e.transiting||(t=e.mapToTargetIds(t),e.svg.selectAll(e.selectorTargets(t,"."+X.chartArc)).selectAll("path").transition().duration(function(t){return e.expandDuration(t.data.id)}).attr("d",e.svgArc),e.svg.selectAll("."+X.arc))},S.expandDuration=function(t){var e=this,n=e.config;return e.isDonutType(t)?n.donut_expand_duration:e.isGaugeType(t)?n.gauge_expand_duration:e.isPieType(t)?n.pie_expand_duration:50},S.shouldExpand=function(t){var e=this,n=e.config;return e.isDonutType(t)&&n.donut_expand||e.isGaugeType(t)&&n.gauge_expand||e.isPieType(t)&&n.pie_expand},S.shouldShowArcLabel=function(){var t=this,e=t.config,n=!0;
// when gauge, always true
return t.hasType("donut")?n=e.donut_label_show:t.hasType("pie")&&(n=e.pie_label_show),n},S.meetsArcLabelThreshold=function(t){var e=this,n=e.config,i;return(e.hasType("donut")?n.donut_label_threshold:n.pie_label_threshold)<=t},S.getArcLabelFormat=function(){var t=this,e=t.config,n=e.pie_label_format;return t.hasType("gauge")?n=e.gauge_label_format:t.hasType("donut")&&(n=e.donut_label_format),n},S.getGaugeLabelExtents=function(){var t,e;return this.config.gauge_label_extents},S.getArcTitle=function(){var t=this;return t.hasType("donut")?t.config.donut_title:""},S.updateTargetsForArc=function(t){var e=this,n=e.main,i,r,a=e.classChartArc.bind(e),o=e.classArcs.bind(e),s=e.classFocus.bind(e);(r=(i=n.select("."+X.chartArcs).selectAll("."+X.chartArc).data(e.pie(t)).attr("class",function(t){return a(t)+s(t.data)})).enter().append("g").attr("class",a)).append("g").attr("class",o),r.append("text").attr("dy",e.hasType("gauge")?"-.1em":".35em").style("opacity",0).style("text-anchor","middle").style("pointer-events","none")},S.initArc=function(){var t=this;t.arcs=t.main.select("."+X.chart).append("g").attr("class",X.chartArcs).attr("transform",t.getTranslate("arc")),t.arcs.append("text").attr("class",X.chartArcsTitle).style("text-anchor","middle").text(t.getArcTitle())},S.redrawArc=function(t,e,n){var h=this,d=h.d3,i=h.config,r=h.main,a,o,s,u=h.hasType("gauge");if((a=r.selectAll("."+X.arcs).selectAll("."+X.arc).data(h.arcData.bind(h))).enter().append("path").attr("class",h.classArc.bind(h)).style("fill",function(t){return h.color(t.data)}).style("cursor",function(t){return i.interaction_enabled&&i.data_selection_isselectable(t)?"pointer":null}).each(function(t){h.isGaugeType(t.data)&&(t.startAngle=t.endAngle=i.gauge_startingAngle),this._current=t}),u&&((s=r.selectAll("."+X.arcs).selectAll("."+X.arcLabelLine).data(h.arcData.bind(h))).enter().append("rect").attr("class",function(t){return X.arcLabelLine+" "+X.target+" "+X.target+"-"+t.data.id}),1===h.filterTargetsToShow(h.data.targets).length?s.style("display","none"):s.style("fill",function(t){return 0<i.color_pattern.length?h.levelColor(t.data.values[0].value):h.color(t.data)}).style("display",i.gauge_labelLine_show?"":"none").each(function(t){var e=0,n=2,i=0,r=0,a="";if(h.hiddenTargetIds.indexOf(t.data.id)<0){var o=h.updateAngle(t),s=h.gaugeArcWidth/h.filterTargetsToShow(h.data.targets).length*(o.index+1),u=o.endAngle-Math.PI/2,c=h.radius-s,l=u-(0===c?0:1/c);e=h.radiusExpanded-h.radius+s,i=Math.cos(l)*c,r=Math.sin(l)*c,a="rotate("+180*u/Math.PI+", "+i+", "+r+")"}d.select(this).attr({x:i,y:r,width:e,height:2,transform:a}).style("stroke-dasharray","0, "+(e+2)+", 0")})),a.attr("transform",function(t){return!h.isGaugeType(t.data)&&n?"scale(0)":""}).on("mouseover",i.interaction_enabled?function(t){var e,n;h.transiting||(e=h.updateAngle(t))&&(n=h.convertToArcData(e),
// transitions
h.expandArc(e.data.id),h.api.focus(e.data.id),h.toggleFocusLegend(e.data.id,!0),h.config.data_onmouseover(n,this))}:null).on("mousemove",i.interaction_enabled?function(t){var e=h.updateAngle(t),n,i;e&&(i=[n=h.convertToArcData(e)],h.showTooltip(i,this))}:null).on("mouseout",i.interaction_enabled?function(t){var e,n;h.transiting||(e=h.updateAngle(t))&&(n=h.convertToArcData(e),
// transitions
h.unexpandArc(e.data.id),h.api.revert(),h.revertLegend(),h.hideTooltip(),h.config.data_onmouseout(n,this))}:null).on("click",i.interaction_enabled?function(t,e){var n=h.updateAngle(t),i;n&&(i=h.convertToArcData(n),h.toggleShape&&h.toggleShape(this,i,e),h.config.data_onclick.call(h.api,i,this))}:null).each(function(){h.transiting=!0}).transition().duration(t).attrTween("d",function(n){var t=h.updateAngle(n),i;return t?(
//                if (this._current === d) {
//                    this._current = {
//                        startAngle: Math.PI*2,
//                        endAngle: Math.PI*2,
//                    };
//                }
isNaN(this._current.startAngle)&&(this._current.startAngle=0),isNaN(this._current.endAngle)&&(this._current.endAngle=this._current.startAngle),i=d.interpolate(this._current,t),this._current=i(0),function(t){var e=i(t);// data.id will be updated by interporator
return e.data=n.data,h.getArc(e,!0)}):function(){return"M 0 0"}}).attr("transform",n?"scale(1)":"").style("fill",function(t){return h.levelColor?h.levelColor(t.data.values[0].value):h.color(t.data.id)}).call(h.endall,function(){h.transiting=!1}),a.exit().transition().duration(e).style("opacity",0).remove(),r.selectAll("."+X.chartArc).select("text").style("opacity",0).attr("class",function(t){return h.isGaugeType(t.data)?X.gaugeValue:""}).text(h.textForArcLabel.bind(h)).attr("transform",h.transformForArcLabel.bind(h)).style("font-size",function(t){return h.isGaugeType(t.data)&&1===h.filterTargetsToShow(h.data.targets).length?Math.round(h.radius/5)+"px":""}).transition().duration(t).style("opacity",function(t){return h.isTargetToShow(t.data.id)&&h.isArcType(t.data)?1:0}),r.select("."+X.chartArcsTitle).style("opacity",h.hasType("donut")||u?1:0),u){var c=0;(o=h.arcs.select("g."+X.chartArcsBackground).selectAll("path."+X.chartArcsBackground).data(h.data.targets)).enter().append("path"),o.attr("class",function(t,e){return X.chartArcsBackground+" "+X.chartArcsBackground+"-"+e}).attr("d",function(t){if(0<=h.hiddenTargetIds.indexOf(t.id))return"M 0 0";var e={data:[{value:i.gauge_max}],startAngle:i.gauge_startingAngle,endAngle:-1*i.gauge_startingAngle*(i.gauge_fullCircle?Math.PI:1),index:c++};return h.getArc(e,!0,!0)}),o.exit().remove(),h.arcs.select("."+X.chartArcsGaugeUnit).attr("dy",".75em").text(i.gauge_label_show?i.gauge_units:""),h.arcs.select("."+X.chartArcsGaugeMin).attr("dx",-1*(h.innerRadius+(h.radius-h.innerRadius)/(i.gauge_fullCircle?1:2))+"px").attr("dy","1.2em").text(i.gauge_label_show?h.textForGaugeMinMax(i.gauge_min,!1):""),h.arcs.select("."+X.chartArcsGaugeMax).attr("dx",h.innerRadius+(h.radius-h.innerRadius)/(i.gauge_fullCircle?1:2)+"px").attr("dy","1.2em").text(i.gauge_label_show?h.textForGaugeMinMax(i.gauge_max,!0):"")}},S.initGauge=function(){var t=this.arcs;this.hasType("gauge")&&(t.append("g").attr("class",X.chartArcsBackground),t.append("text").attr("class",X.chartArcsGaugeUnit).style("text-anchor","middle").style("pointer-events","none"),t.append("text").attr("class",X.chartArcsGaugeMin).style("text-anchor","middle").style("pointer-events","none"),t.append("text").attr("class",X.chartArcsGaugeMax).style("text-anchor","middle").style("pointer-events","none"))},S.getGaugeLabelHeight=function(){return this.config.gauge_label_show?20:0},S.hasCaches=function(t){for(var e=0;e<t.length;e++)if(!(t[e]in this.cache))return!1;return!0},S.addCache=function(t,e){this.cache[t]=this.cloneTarget(e)},S.getCaches=function(t){var e=[],n;for(n=0;n<t.length;n++)t[n]in this.cache&&e.push(this.cloneTarget(this.cache[t[n]]));return e},S.categoryName=function(t){var e=this.config;return t<e.axis_x_categories.length?e.axis_x_categories[t]:t},S.generateClass=function(t,e){return" "+t+" "+t+this.getTargetSelectorSuffix(e)},S.classText=function(t){return this.generateClass(X.text,t.index)},S.classTexts=function(t){return this.generateClass(X.texts,t.id)},S.classShape=function(t){return this.generateClass(X.shape,t.index)},S.classShapes=function(t){return this.generateClass(X.shapes,t.id)},S.classLine=function(t){return this.classShape(t)+this.generateClass(X.line,t.id)},S.classLines=function(t){return this.classShapes(t)+this.generateClass(X.lines,t.id)},S.classCircle=function(t){return this.classShape(t)+this.generateClass(X.circle,t.index)},S.classCircles=function(t){return this.classShapes(t)+this.generateClass(X.circles,t.id)},S.classBar=function(t){return this.classShape(t)+this.generateClass(X.bar,t.index)},S.classBars=function(t){return this.classShapes(t)+this.generateClass(X.bars,t.id)},S.classArc=function(t){return this.classShape(t.data)+this.generateClass(X.arc,t.data.id)},S.classArcs=function(t){return this.classShapes(t.data)+this.generateClass(X.arcs,t.data.id)},S.classArea=function(t){return this.classShape(t)+this.generateClass(X.area,t.id)},S.classAreas=function(t){return this.classShapes(t)+this.generateClass(X.areas,t.id)},S.classRegion=function(t,e){return this.generateClass(X.region,e)+" "+("class"in t?t.class:"")},S.classEvent=function(t){return this.generateClass(X.eventRect,t.index)},S.classTarget=function(t){var e=this,n=e.config.data_classes[t],i="";return n&&(i=" "+X.target+"-"+n),e.generateClass(X.target,t)+i},S.classFocus=function(t){return this.classFocused(t)+this.classDefocused(t)},S.classFocused=function(t){return" "+(0<=this.focusedTargetIds.indexOf(t.id)?X.focused:"")},S.classDefocused=function(t){return" "+(0<=this.defocusedTargetIds.indexOf(t.id)?X.defocused:"")},S.classChartText=function(t){return X.chartText+this.classTarget(t.id)},S.classChartLine=function(t){return X.chartLine+this.classTarget(t.id)},S.classChartBar=function(t){return X.chartBar+this.classTarget(t.id)},S.classChartArc=function(t){return X.chartArc+this.classTarget(t.data.id)},S.getTargetSelectorSuffix=function(t){return t||0===t?("-"+t).replace(/[\s?!@#$%^&*()_=+,.<>'":;\[\]\/|~`{}\\]/g,"-"):""},S.selectorTarget=function(t,e){return(e||"")+"."+X.target+this.getTargetSelectorSuffix(t)},S.selectorTargets=function(t,e){var n=this;return(t=t||[]).length?t.map(function(t){return n.selectorTarget(t,e)}):null},S.selectorLegend=function(t){return"."+X.legendItem+this.getTargetSelectorSuffix(t)},S.selectorLegends=function(t){var e=this;return t&&t.length?t.map(function(t){return e.selectorLegend(t)}):null},S.getClipPath=function(t){var e;return"url("+(0<=window.navigator.appVersion.toLowerCase().indexOf("msie 9.")?"":document.URL.split("#")[0])+"#"+t+")"},S.appendClip=function(t,e){return t.append("clipPath").attr("id",e).append("rect")},S.getAxisClipX=function(t){
// axis line width + padding for left
var e=Math.max(30,this.margin.left);return t?-(1+e):-(e-1)},S.getAxisClipY=function(t){return t?-20:-this.margin.top},S.getXAxisClipX=function(){var t=this;return t.getAxisClipX(!t.config.axis_rotated)},S.getXAxisClipY=function(){var t=this;return t.getAxisClipY(!t.config.axis_rotated)},S.getYAxisClipX=function(){var t=this;return t.config.axis_y_inner?-1:t.getAxisClipX(t.config.axis_rotated)},S.getYAxisClipY=function(){var t=this;return t.getAxisClipY(t.config.axis_rotated)},S.getAxisClipWidth=function(t){var e=this,n=Math.max(30,e.margin.left),i=Math.max(30,e.margin.right);
// width + axis line width + padding for left/right
return t?e.width+2+n+i:e.margin.left+20},S.getAxisClipHeight=function(t){
// less than 20 is not enough to show the axis label 'outer' without legend
return(t?this.margin.bottom:this.margin.top+this.height)+20},S.getXAxisClipWidth=function(){var t=this;return t.getAxisClipWidth(!t.config.axis_rotated)},S.getXAxisClipHeight=function(){var t=this;return t.getAxisClipHeight(!t.config.axis_rotated)},S.getYAxisClipWidth=function(){var t=this;return t.getAxisClipWidth(t.config.axis_rotated)+(t.config.axis_y_inner?20:0)},S.getYAxisClipHeight=function(){var t=this;return t.getAxisClipHeight(t.config.axis_rotated)},S.generateColor=function(){var t=this,e=t.config,n=t.d3,i=e.data_colors,r=L(e.color_pattern)?e.color_pattern:n.scale.category10().range(),a=e.data_color,o=[];return function(t){var e=t.id||t.data&&t.data.id||t,n;
// if callback function is provided
return i[e]instanceof Function?n=i[e](t):i[e]?n=i[e]:(o.indexOf(e)<0&&o.push(e),n=r[o.indexOf(e)%r.length],i[e]=n),a instanceof Function?a(n,t):n}},S.generateLevelColor=function(){var t,e=this.config,r=e.color_pattern,n=e.color_threshold,a="value"===n.unit,o=n.values&&n.values.length?n.values:[],s=n.max||100;return L(e.color_threshold)?function(t){var e,n,i=r[r.length-1];for(e=0;e<o.length;e++)if((n=a?t:100*t/s)<o[e]){i=r[e];break}return i}:null},S.getDefaultConfig=function(){var e={bindto:"#chart",svg_classname:void 0,size_width:void 0,size_height:void 0,padding_left:void 0,padding_right:void 0,padding_top:void 0,padding_bottom:void 0,resize_auto:!0,zoom_enabled:!1,zoom_extent:void 0,zoom_privileged:!1,zoom_rescale:!1,zoom_onzoom:function t(){},zoom_onzoomstart:function t(){},zoom_onzoomend:function t(){},zoom_x_min:void 0,zoom_x_max:void 0,interaction_brighten:!0,interaction_enabled:!0,onmouseover:function t(){},onmouseout:function t(){},onresize:function t(){},onresized:function t(){},oninit:function t(){},onrendered:function t(){},transition_duration:350,data_x:void 0,data_xs:{},data_xFormat:"%Y-%m-%d",data_xLocaltime:!0,data_xSort:!0,data_idConverter:function t(e){return e},data_names:{},data_classes:{},data_groups:[],data_axes:{},data_type:void 0,data_types:{},data_labels:{},data_order:"desc",data_regions:{},data_color:void 0,data_colors:{},data_hide:!1,data_filter:void 0,data_selection_enabled:!1,data_selection_grouped:!1,data_selection_isselectable:function t(){return!0},data_selection_multiple:!0,data_selection_draggable:!1,data_onclick:function t(){},data_onmouseover:function t(){},data_onmouseout:function t(){},data_onselected:function t(){},data_onunselected:function t(){},data_url:void 0,data_headers:void 0,data_json:void 0,data_rows:void 0,data_columns:void 0,data_mimeType:void 0,data_keys:void 0,
// configuration for no plot-able data supplied.
data_empty_label_text:"",
// subchart
subchart_show:!1,subchart_size_height:60,subchart_axis_x_show:!0,subchart_onbrush:function t(){},
// color
color_pattern:[],color_threshold:{},
// legend
legend_show:!0,legend_hide:!1,legend_position:"bottom",legend_inset_anchor:"top-left",legend_inset_x:10,legend_inset_y:0,legend_inset_step:void 0,legend_item_onclick:void 0,legend_item_onmouseover:void 0,legend_item_onmouseout:void 0,legend_equally:!1,legend_padding:0,legend_item_tile_width:10,legend_item_tile_height:10,
// axis
axis_rotated:!1,axis_x_show:!0,axis_x_type:"indexed",axis_x_localtime:!0,axis_x_categories:[],axis_x_tick_centered:!1,axis_x_tick_format:void 0,axis_x_tick_culling:{},axis_x_tick_culling_max:10,axis_x_tick_count:void 0,axis_x_tick_fit:!0,axis_x_tick_values:null,axis_x_tick_rotate:0,axis_x_tick_outer:!0,axis_x_tick_multiline:!0,axis_x_tick_width:null,axis_x_max:void 0,axis_x_min:void 0,axis_x_padding:{},axis_x_height:void 0,axis_x_extent:void 0,axis_x_label:{},axis_y_show:!0,axis_y_type:void 0,axis_y_max:void 0,axis_y_min:void 0,axis_y_inverted:!1,axis_y_center:void 0,axis_y_inner:void 0,axis_y_label:{},axis_y_tick_format:void 0,axis_y_tick_outer:!0,axis_y_tick_values:null,axis_y_tick_rotate:0,axis_y_tick_count:void 0,axis_y_tick_time_value:void 0,axis_y_tick_time_interval:void 0,axis_y_padding:{},axis_y_default:void 0,axis_y2_show:!1,axis_y2_max:void 0,axis_y2_min:void 0,axis_y2_inverted:!1,axis_y2_center:void 0,axis_y2_inner:void 0,axis_y2_label:{},axis_y2_tick_format:void 0,axis_y2_tick_outer:!0,axis_y2_tick_values:null,axis_y2_tick_count:void 0,axis_y2_padding:{},axis_y2_default:void 0,
// grid
grid_x_show:!1,grid_x_type:"tick",grid_x_lines:[],grid_y_show:!1,
// not used
// grid_y_type: 'tick',
grid_y_lines:[],grid_y_ticks:10,grid_focus_show:!0,grid_lines_front:!0,
// point - point of each data
point_show:!0,point_r:2.5,point_sensitivity:10,point_focus_expand_enabled:!0,point_focus_expand_r:void 0,point_select_r:void 0,
// line
line_connectNull:!1,line_step_type:"step",
// bar
bar_width:void 0,bar_width_ratio:.6,bar_width_max:void 0,bar_zerobased:!0,bar_space:0,
// area
area_zerobased:!0,area_above:!1,
// pie
pie_label_show:!0,pie_label_format:void 0,pie_label_threshold:.05,pie_label_ratio:void 0,pie_expand:{},pie_expand_duration:50,
// gauge
gauge_fullCircle:!1,gauge_label_show:!0,gauge_labelLine_show:!0,gauge_label_format:void 0,gauge_min:0,gauge_max:100,gauge_startingAngle:-1*Math.PI/2,gauge_label_extents:void 0,gauge_units:void 0,gauge_width:void 0,gauge_arcs_minWidth:5,gauge_expand:{},gauge_expand_duration:50,
// donut
donut_label_show:!0,donut_label_format:void 0,donut_label_threshold:.05,donut_label_ratio:void 0,donut_width:void 0,donut_title:"",donut_expand:{},donut_expand_duration:50,
// spline
spline_interpolation_type:"cardinal",
// region - region to change style
regions:[],
// tooltip - show when mouseover on each data
tooltip_show:!0,tooltip_grouped:!0,tooltip_order:void 0,tooltip_format_title:void 0,tooltip_format_name:void 0,tooltip_format_value:void 0,tooltip_position:void 0,tooltip_contents:function t(e,n,i,r){return this.getTooltipContent?this.getTooltipContent(e,n,i,r):""},tooltip_init_show:!1,tooltip_init_x:0,tooltip_init_position:{top:"0px",left:"50px"},tooltip_onshow:function t(){},tooltip_onhide:function t(){},
// title
title_text:void 0,title_padding:{top:0,right:0,bottom:0,left:0},title_position:"top-center"};return Object.keys(this.additionalConfig).forEach(function(t){e[t]=this.additionalConfig[t]},this),e},S.additionalConfig={},S.loadConfig=function(e){function n(){var t=a.shift();
//        console.log("key =>", key, ", target =>", target);
return t&&r&&"object"===(void 0===r?"undefined":u(r))&&t in r?(r=r[t],n()):t?void 0:r}var i=this.config,r,a,o;Object.keys(i).forEach(function(t){r=e,a=t.split("_"),o=n(),
//        console.log("CONFIG : ", key, read);
I(o)&&(i[t]=o)})},S.convertUrlToData=function(t,e,n,r,a){var o=this,s=e||"csv",i=o.d3.xhr(t);n&&Object.keys(n).forEach(function(t){i.header(t,n[t])}),i.get(function(t,e){var n,i=e.response||e.responseText;// Fixes IE9 XHR issue; see #1345
if(!e)throw new Error(t.responseURL+" "+t.status+" ("+t.statusText+")");n="json"===s?o.convertJsonToData(JSON.parse(i),r):"tsv"===s?o.convertTsvToData(i):o.convertCsvToData(i),a.call(o,n)})},S.convertXsvToData=function(t,e){var n=e.parseRows(t),i;return 1===n.length?(i=[{}],n[0].forEach(function(t){i[0][t]=null})):i=e.parse(t),i},S.convertCsvToData=function(t){return this.convertXsvToData(t,this.d3.csv)},S.convertTsvToData=function(t){return this.convertXsvToData(t,this.d3.tsv)},S.convertJsonToData=function(e,t){var r=this,a=[],o,n;return n=t?(
// when keys specified, json would be an array that includes objects
t.x?(o=t.value.concat(t.x),r.config.data_x=t.x):o=t.value,a.push(o),e.forEach(function(n){var i=[];o.forEach(function(t){
// convert undefined to null because undefined data will be removed in convertDataToTargets()
var e=r.findValueInJson(n,t);A(e)&&(e=null),i.push(e)}),a.push(i)}),r.convertRowsToData(a)):(Object.keys(e).forEach(function(t){a.push([t].concat(e[t]))}),r.convertColumnsToData(a))},S.findValueInJson=function(t,e){for(// strip a leading dot
var n=(// convert indexes to properties (replace [] with .)
e=(e=e.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),i=0;i<n.length;++i){var r=n[i];if(!(r in t))return;t=t[r]}return t},
/**
 * Converts the rows to normalized data.
 * @param {any[][]} rows The row data
 * @return {Object[]}
 */
S.convertRowsToData=function(t){for(var e=[],n=t[0],i=1;i<t.length;i++){for(var r={},a=0;a<t[i].length;a++){if(A(t[i][a]))throw new Error("Source data is missing a component at ("+i+","+a+")!");r[n[a]]=t[i][a]}e.push(r)}return e},
/**
 * Converts the columns to normalized data.
 * @param {any[][]} columns The column data
 * @return {Object[]}
 */
S.convertColumnsToData=function(t){for(var e=[],n=0;n<t.length;n++)for(var i=t[n][0],r=1;r<t[n].length;r++){if(A(e[r-1])&&(e[r-1]={}),A(t[n][r]))throw new Error("Source data is missing a component at ("+n+","+r+")!");e[r-1][i]=t[n][r]}return e},S.convertDataToTargets=function(t,i){var c=this,l=c.config,e=c.d3.keys(t[0]).filter(c.isNotX,c),r=c.d3.keys(t[0]).filter(c.isX,c),n;
// save x for update data by load when custom x and c3.x API
return e.forEach(function(n){var e=c.getXKey(n);c.isCustomX()||c.isTimeSeries()?
// if included in input data
0<=r.indexOf(e)?c.data.xs[n]=(i&&c.data.xs[n]?c.data.xs[n]:[]).concat(t.map(function(t){return t[e]}).filter(C).map(function(t,e){return c.generateTargetX(t,n,e)})):l.data_x?c.data.xs[n]=c.getOtherTargetXs():L(l.data_xs)&&(c.data.xs[n]=c.getXValuesOfXKey(e,c.data.targets)):c.data.xs[n]=t.map(function(t,e){return e})}),
// check x is defined
e.forEach(function(t){if(!c.data.xs[t])throw new Error('x is not defined for id = "'+t+'".')}),
// finish targets
(
// convert to target
n=e.map(function(o,s){var u=l.data_idConverter(o);return{id:u,id_org:o,values:t.map(function(t,e){var n,i=t[c.getXKey(o)],r=null===t[o]||isNaN(t[o])?null:+t[o],a;
// use x as categories if custom x and categorized
return c.isCustomX()&&c.isCategorized()&&!A(i)?(0===s&&0===e&&(l.axis_x_categories=[]),-1===(a=l.axis_x_categories.indexOf(i))&&(a=l.axis_x_categories.length,l.axis_x_categories.push(i))):a=c.generateTargetX(i,o,e),
// mark as x = undefined if value is undefined and filter to remove after mapped
(A(t[o])||c.data.xs[o].length<=e)&&(a=void 0),{x:a,value:r,id:u}}).filter(function(t){return I(t.x)})}})).forEach(function(t){var e;
// sort values by its x
l.data_xSort&&(t.values=t.values.sort(function(t,e){var n,i;return(t.x||0===t.x?t.x:1/0)-(e.x||0===e.x?e.x:1/0)})),
// indexing each value
e=0,t.values.forEach(function(t){t.index=e++}),
// this needs to be sorted because its index and value.index is identical
c.data.xs[t.id].sort(function(t,e){return t-e})}),
// cache information about values
c.hasNegativeValue=c.hasNegativeValueInTargets(n),c.hasPositiveValue=c.hasPositiveValueInTargets(n),
// set target types
l.data_type&&c.setTargetType(c.mapToIds(n).filter(function(t){return!(t in l.data_types)}),l.data_type),
// cache as original id keyed
n.forEach(function(t){c.addCache(t.id_org,t)}),n},S.isX=function(t){var e,n=this.config;return n.data_x&&t===n.data_x||L(n.data_xs)&&i(n.data_xs,t)},S.isNotX=function(t){return!this.isX(t)},S.getXKey=function(t){var e,n=this.config;return n.data_x?n.data_x:L(n.data_xs)?n.data_xs[t]:null},S.getXValuesOfXKey=function(e,t){var n=this,i,r;return(t&&L(t)?n.mapToIds(t):[]).forEach(function(t){n.getXKey(t)===e&&(i=n.data.xs[t])}),i},S.getIndexByX=function(t){var e=this,n=e.filterByX(e.data.targets,t);return n.length?n[0].index:null},S.getXValue=function(t,e){var n=this;return t in n.data.xs&&n.data.xs[t]&&C(n.data.xs[t][e])?n.data.xs[t][e]:e},S.getOtherTargetXs=function(){var t=this,e=Object.keys(t.data.xs);return e.length?t.data.xs[e[0]]:null},S.getOtherTargetX=function(t){var e=this.getOtherTargetXs();return e&&t<e.length?e[t]:null},S.addXs=function(e){var n=this;Object.keys(e).forEach(function(t){n.config.data_xs[t]=e[t]})},S.hasMultipleX=function(e){return 1<this.d3.set(Object.keys(e).map(function(t){return e[t]})).size()},S.isMultipleX=function(){return L(this.config.data_xs)||!this.config.data_xSort||this.hasType("scatter")},S.addName=function(t){var e,n;return t&&(n=this.config.data_names[t.id],t.name=void 0!==n?n:t.id),t},S.getValueOnIndex=function(t,e){var n=t.filter(function(t){return t.index===e});return n.length?n[0]:null},S.updateTargetX=function(t,i){var r=this;t.forEach(function(n){n.values.forEach(function(t,e){t.x=r.generateTargetX(i[e],n.id,e)}),r.data.xs[n.id]=i})},S.updateTargetXs=function(t,e){var n=this;t.forEach(function(t){e[t.id]&&n.updateTargetX([t],e[t.id])})},S.generateTargetX=function(t,e,n){var i=this,r;return r=i.isTimeSeries()?t?i.parseDate(t):i.parseDate(i.getXValue(e,n)):i.isCustomX()&&!i.isCategorized()?C(t)?+t:i.getXValue(e,n):n},S.cloneTarget=function(t){return{id:t.id,id_org:t.id_org,values:t.values.map(function(t){return{x:t.x,value:t.value,id:t.id}})}},S.updateXs=function(){var e=this;e.data.targets.length&&(e.xs=[],e.data.targets[0].values.forEach(function(t){e.xs[t.index]=t.x}))},S.getPrevX=function(t){var e=this.xs[t-1];return void 0!==e?e:null},S.getNextX=function(t){var e=this.xs[t+1];return void 0!==e?e:null},S.getMaxDataCount=function(){var t=this;return t.d3.max(t.data.targets,function(t){return t.values.length})},S.getMaxDataCountTarget=function(t){var e=t.length,n=0,i;return 1<e?t.forEach(function(t){t.values.length>n&&(n=(i=t).values.length)}):i=e?t[0]:null,i},S.getEdgeX=function(t){var e=this;return t.length?[e.d3.min(t,function(t){return t.values[0].x}),e.d3.max(t,function(t){return t.values[t.values.length-1].x})]:[0,0]},S.mapToIds=function(t){return t.map(function(t){return t.id})},S.mapToTargetIds=function(t){var e=this;return t?[].concat(t):e.mapToIds(e.data.targets)},S.hasTarget=function(t,e){var n=this.mapToIds(t),i;for(i=0;i<n.length;i++)if(n[i]===e)return!0;return!1},S.isTargetToShow=function(t){return this.hiddenTargetIds.indexOf(t)<0},S.isLegendToShow=function(t){return this.hiddenLegendIds.indexOf(t)<0},S.filterTargetsToShow=function(t){var e=this;return t.filter(function(t){return e.isTargetToShow(t.id)})},S.mapTargetsToUniqueXs=function(t){var e=this,n=e.d3.set(e.d3.merge(t.map(function(t){return t.values.map(function(t){return+t.x})}))).values();return(n=e.isTimeSeries()?n.map(function(t){return new Date(+t)}):n.map(function(t){return+t})).sort(function(t,e){return t<e?-1:e<t?1:e<=t?0:NaN})},S.addHiddenTargetIds=function(t){t=t instanceof Array?t:new Array(t);for(var e=0;e<t.length;e++)this.hiddenTargetIds.indexOf(t[e])<0&&(this.hiddenTargetIds=this.hiddenTargetIds.concat(t[e]))},S.removeHiddenTargetIds=function(e){this.hiddenTargetIds=this.hiddenTargetIds.filter(function(t){return e.indexOf(t)<0})},S.addHiddenLegendIds=function(t){t=t instanceof Array?t:new Array(t);for(var e=0;e<t.length;e++)this.hiddenLegendIds.indexOf(t[e])<0&&(this.hiddenLegendIds=this.hiddenLegendIds.concat(t[e]))},S.removeHiddenLegendIds=function(e){this.hiddenLegendIds=this.hiddenLegendIds.filter(function(t){return e.indexOf(t)<0})},S.getValuesAsIdKeyed=function(t){var n={};return t.forEach(function(e){n[e.id]=[],e.values.forEach(function(t){n[e.id].push(t.value)})}),n},S.checkValueInTargets=function(t,e){var n=Object.keys(t),i,r,a;for(i=0;i<n.length;i++)for(a=t[n[i]].values,r=0;r<a.length;r++)if(e(a[r].value))return!0;return!1},S.hasNegativeValueInTargets=function(t){return this.checkValueInTargets(t,function(t){return t<0})},S.hasPositiveValueInTargets=function(t){return this.checkValueInTargets(t,function(t){return 0<t})},S.isOrderDesc=function(){var t=this.config;return"string"==typeof t.data_order&&"desc"===t.data_order.toLowerCase()},S.isOrderAsc=function(){var t=this.config;return"string"==typeof t.data_order&&"asc"===t.data_order.toLowerCase()},S.getOrderFunction=function(){var t=this,e=t.config,n=t.isOrderAsc(),a=t.isOrderDesc();if(n||a)return function(t,e){var n=function t(e,n){return e+Math.abs(n.value)},i=t.values.reduce(n,0),r=e.values.reduce(n,0);return a?r-i:i-r};if(d(e.data_order))return e.data_order;if(c(e.data_order)){var i=e.data_order;return function(t,e){return i.indexOf(t.id)-i.indexOf(e.id)}}},S.orderTargets=function(t){var e=this.getOrderFunction();return e&&(t.sort(e),(this.isOrderAsc()||this.isOrderDesc())&&t.reverse()),t},S.filterByX=function(t,e){return this.d3.merge(t.map(function(t){return t.values})).filter(function(t){return t.x-e==0})},S.filterRemoveNull=function(t){return t.filter(function(t){return C(t.value)})},S.filterByXDomain=function(t,e){return t.map(function(t){return{id:t.id,id_org:t.id_org,values:t.values.filter(function(t){return e[0]<=t.x&&t.x<=e[1]})}})},S.hasDataLabel=function(){var t=this.config;return!("boolean"!=typeof t.data_labels||!t.data_labels)||!("object"!==u(t.data_labels)||!L(t.data_labels))},S.getDataLabelLength=function(t,e,n){var i=this,r=[0,0],a=1.3;return i.selectChart.select("svg").selectAll(".dummy").data([t,e]).enter().append("text").text(function(t){return i.dataLabelFormat(t.id)(t)}).each(function(t,e){r[e]=1.3*this.getBoundingClientRect()[n]}).remove(),r},S.isNoneArc=function(t){return this.hasTarget(this.data.targets,t.id)},S.isArc=function(t){return"data"in t&&this.hasTarget(this.data.targets,t.data.id)},S.findSameXOfValues=function(t,e){var n,i=t[e].x,r=[];for(n=e-1;0<=n&&i===t[n].x;n--)r.push(t[n]);for(n=e;n<t.length&&i===t[n].x;n++)r.push(t[n]);return r},S.findClosestFromTargets=function(t,e){var n=this,i;
// map to array of closest points of each target
// decide closest point and return
return i=t.map(function(t){return n.findClosest(t.values,e)}),n.findClosest(i,e)},S.findClosest=function(t,n){var i=this,r=i.config.point_sensitivity,a;
// find mouseovering bar
return t.filter(function(t){return t&&i.isBarType(t.id)}).forEach(function(t){var e=i.main.select("."+X.bars+i.getTargetSelectorSuffix(t.id)+" ."+X.bar+"-"+t.index).node();!a&&i.isWithinBar(e)&&(a=t)}),
// find closest point from non-bar
t.filter(function(t){return t&&!i.isBarType(t.id)}).forEach(function(t){var e=i.dist(t,n);e<r&&(r=e,a=t)}),a},S.dist=function(t,e){var n=this,i=n.config,r=i.axis_rotated?1:0,a=i.axis_rotated?0:1,o=n.circleY(t,t.index),s=n.x(t.x);return Math.sqrt(Math.pow(s-e[r],2)+Math.pow(o-e[a],2))},S.convertValuesToStep=function(t){var e=[].concat(t),n;if(!this.isCategorized())return t;for(n=t.length+1;0<n;n--)e[n]=e[n-1];return e[0]={x:e[0].x-1,value:e[0].value,id:e[0].id},e[t.length+1]={x:e[t.length].x+1,value:e[t.length].value,id:e[t.length].id},e},S.updateDataAttributes=function(t,e){var n=this,i,r=n.config["data_"+t];return void 0===e||(Object.keys(e).forEach(function(t){r[t]=e[t]}),n.redraw({withLegend:!0})),r},S.load=function(n,i){var r=this;n&&(
// filter loading targets if needed
i.filter&&(n=n.filter(i.filter)),
// set type if args.types || args.type specified
(i.type||i.types)&&n.forEach(function(t){var e=i.types&&i.types[t.id]?i.types[t.id]:i.type;r.setTargetType(t.id,e)}),
// Update/Add data
r.data.targets.forEach(function(t){for(var e=0;e<n.length;e++)if(t.id===n[e].id){t.values=n[e].values,n.splice(e,1);break}}),r.data.targets=r.data.targets.concat(n)),
// Set targets
r.updateTargets(r.data.targets),
// Redraw with new targets
r.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0}),i.done&&i.done()},S.loadFromArgs=function(e){var n=this;e.data?n.load(n.convertDataToTargets(e.data),e):e.url?n.convertUrlToData(e.url,e.mimeType,e.headers,e.keys,function(t){n.load(n.convertDataToTargets(t),e)}):e.json?n.load(n.convertDataToTargets(n.convertJsonToData(e.json,e.keys)),e):e.rows?n.load(n.convertDataToTargets(n.convertRowsToData(e.rows)),e):e.columns?n.load(n.convertDataToTargets(n.convertColumnsToData(e.columns)),e):n.load(null,e)},S.unload=function(t,e){var n=this;e||(e=function t(){}),
// If no target, call done and return
(
// filter existing target
t=t.filter(function(t){return n.hasTarget(n.data.targets,t)}))&&0!==t.length?(n.svg.selectAll(t.map(function(t){return n.selectorTarget(t)})).transition().style("opacity",0).remove().call(n.endall,e),t.forEach(function(e){
// Reset fadein for future load
n.withoutFadeIn[e]=!1,
// Remove target's elements
n.legend&&n.legend.selectAll("."+X.legendItem+n.getTargetSelectorSuffix(e)).remove(),
// Remove target
n.data.targets=n.data.targets.filter(function(t){return t.id!==e})})):e()},S.getYDomainMin=function(t){var n=this,e=n.config,i=n.mapToIds(t),r=n.getValuesAsIdKeyed(t),a,o,s,u,c,l;if(0<e.data_groups.length)for(l=n.hasNegativeValueInTargets(t),a=0;a<e.data_groups.length;a++)if(0!==(
// Determine baseId
u=e.data_groups[a].filter(function(t){return 0<=i.indexOf(t)})).length)
// Compute min
for(s=u[0],
// Consider negative values
l&&r[s]&&r[s].forEach(function(t,e){r[s][e]=t<0?t:0}),o=1;o<u.length;o++)c=u[o],r[c]&&r[c].forEach(function(t,e){n.axis.getId(c)!==n.axis.getId(s)||!r[s]||l&&0<+t||(r[s][e]+=+t)});return n.d3.min(Object.keys(r).map(function(t){return n.d3.min(r[t])}))},S.getYDomainMax=function(t){var n=this,e=n.config,i=n.mapToIds(t),r=n.getValuesAsIdKeyed(t),a,o,s,u,c,l;if(0<e.data_groups.length)for(l=n.hasPositiveValueInTargets(t),a=0;a<e.data_groups.length;a++)if(0!==(
// Determine baseId
u=e.data_groups[a].filter(function(t){return 0<=i.indexOf(t)})).length)
// Compute max
for(s=u[0],
// Consider positive values
l&&r[s]&&r[s].forEach(function(t,e){r[s][e]=0<t?t:0}),o=1;o<u.length;o++)c=u[o],r[c]&&r[c].forEach(function(t,e){n.axis.getId(c)!==n.axis.getId(s)||!r[s]||l&&+t<0||(r[s][e]+=+t)});return n.d3.max(Object.keys(r).map(function(t){return n.d3.max(r[t])}))},S.getYDomain=function(t,e,n){var i=this,r=i.config,a=t.filter(function(t){return i.axis.getId(t.id)===e}),o=n?i.filterByXDomain(a,n):a,s="y2"===e?r.axis_y2_min:r.axis_y_min,u="y2"===e?r.axis_y2_max:r.axis_y_max,c=i.getYDomainMin(o),l=i.getYDomainMax(o),h,d,f,g,p,x="y2"===e?r.axis_y2_center:r.axis_y_center,_,v,y,m,w,S,b=i.hasType("bar",o)&&r.bar_zerobased||i.hasType("area",o)&&r.area_zerobased,A="y2"===e?r.axis_y2_inverted:r.axis_y_inverted,T=i.hasDataLabel()&&r.axis_rotated,P=i.hasDataLabel()&&!r.axis_rotated;
// MEMO: avoid inverting domain unexpectedly
return c=C(s)?s:C(u)?c<u?c:u-10:c,l=C(u)?u:C(s)?s<l?l:s+10:l,0===o.length?"y2"===e?i.y2.domain():i.y.domain():(isNaN(c)&&(
// set minimum to zero when not number
c=0),isNaN(l)&&(
// set maximum to have same value as yDomainMin
l=c),c===l&&(c<0?l=0:c=0),w=0<=c&&0<=l,S=c<=0&&l<=0,
// Cancel zerobased if axis_*_min / axis_*_max specified
(C(s)&&w||C(u)&&S)&&(b=!1),
// Bar/Area chart should be 0-based if all positive|negative
b&&(w&&(c=0),S&&(l=0)),f=g=p=.1*(d=Math.abs(l-c)),void 0!==x&&(l=x+(_=Math.max(Math.abs(c),Math.abs(l))),c=x-_),
// add padding for data label
T?(v=i.getDataLabelLength(c,l,"width"),y=O(i.y.range()),g+=d*((m=[v[0]/y,v[1]/y])[1]/(1-m[0]-m[1])),p+=d*(m[0]/(1-m[0]-m[1]))):P&&(v=i.getDataLabelLength(c,l,"height"),g+=i.axis.convertPixelsToAxisPadding(v[1],d),p+=i.axis.convertPixelsToAxisPadding(v[0],d)),"y"===e&&L(r.axis_y_padding)&&(g=i.axis.getPadding(r.axis_y_padding,"top",g,d),p=i.axis.getPadding(r.axis_y_padding,"bottom",p,d)),"y2"===e&&L(r.axis_y2_padding)&&(g=i.axis.getPadding(r.axis_y2_padding,"top",g,d),p=i.axis.getPadding(r.axis_y2_padding,"bottom",p,d)),
// Bar/Area chart should be 0-based if all positive|negative
b&&(w&&(p=c),S&&(g=-l)),h=[c-p,l+g],A?h.reverse():h)},S.getXDomainMin=function(t){var e=this,n=e.config;return I(n.axis_x_min)?e.isTimeSeries()?this.parseDate(n.axis_x_min):n.axis_x_min:e.d3.min(t,function(t){return e.d3.min(t.values,function(t){return t.x})})},S.getXDomainMax=function(t){var e=this,n=e.config;return I(n.axis_x_max)?e.isTimeSeries()?this.parseDate(n.axis_x_max):n.axis_x_max:e.d3.max(t,function(t){return e.d3.max(t.values,function(t){return t.x})})},S.getXDomainPadding=function(t){var e=this,n=e.config,i=t[1]-t[0],r,a,o,s;return a=e.isCategorized()?0:e.hasType("bar")?1<(r=e.getMaxDataCount())?i/(r-1)/2:.5:.01*i,"object"===u(n.axis_x_padding)&&L(n.axis_x_padding)?(o=C(n.axis_x_padding.left)?n.axis_x_padding.left:a,s=C(n.axis_x_padding.right)?n.axis_x_padding.right:a):o=s="number"==typeof n.axis_x_padding?n.axis_x_padding:a,{left:o,right:s}},S.getXDomain=function(t){var e=this,n=[e.getXDomainMin(t),e.getXDomainMax(t)],i=n[0],r=n[1],a=e.getXDomainPadding(n),o=0,s=0;
// show center of x domain if min and max are the same
return i-r!=0||e.isCategorized()||(r=e.isTimeSeries()?(i=new Date(.5*i.getTime()),new Date(1.5*r.getTime())):(i=0===i?1:.5*i,0===r?-1:1.5*r)),(i||0===i)&&(o=e.isTimeSeries()?new Date(i.getTime()-a.left):i-a.left),(r||0===r)&&(s=e.isTimeSeries()?new Date(r.getTime()+a.right):r+a.right),[o,s]},S.updateXDomain=function(t,e,n,i,r){var a=this,o=a.config;return n&&(a.x.domain(r||a.d3.extent(a.getXDomain(t))),a.orgXDomain=a.x.domain(),o.zoom_enabled&&a.zoom.scale(a.x).updateScaleExtent(),a.subX.domain(a.x.domain()),a.brush&&a.brush.scale(a.subX)),e&&(a.x.domain(r||(!a.brush||a.brush.empty()?a.orgXDomain:a.brush.extent())),o.zoom_enabled&&a.zoom.scale(a.x).updateScaleExtent()),
// Trim domain when too big by zoom mousemove event
i&&a.x.domain(a.trimXDomain(a.x.orgDomain())),a.x.domain()},S.trimXDomain=function(t){var e=this.getZoomDomain(),n=e[0],i=e[1];return t[0]<=n&&(t[1]=+t[1]+(n-t[0]),t[0]=n),i<=t[1]&&(t[0]=+t[0]-(t[1]-i),t[1]=i),t},S.drag=function(t){var d=this,e=d.config,n=d.main,f=d.d3,i,r,a,o,g,p,x,_;d.hasArcType()||e.data_selection_enabled&&(// do nothing if not selectable
e.zoom_enabled&&!d.zoom.altDomain||// skip if zoomable because of conflict drag dehavior
e.data_selection_multiple&&(// skip when single selection because drag is used for multiple selection
i=d.dragStart[0],r=d.dragStart[1],a=t[0],o=t[1],g=Math.min(i,a),p=Math.max(i,a),x=e.data_selection_grouped?d.margin.top:Math.min(r,o),_=e.data_selection_grouped?d.height:Math.max(r,o),n.select("."+X.dragarea).attr("x",g).attr("y",x).attr("width",p-g).attr("height",_-x),
// TODO: binary search when multiple xs
n.selectAll("."+X.shapes).selectAll("."+X.shape).filter(function(t){return e.data_selection_isselectable(t)}).each(function(t,e){var n=f.select(this),i=n.classed(X.SELECTED),r=n.classed(X.INCLUDED),a,o,s,u,c,l=!1,h;if(n.classed(X.circle))a=1*n.attr("cx"),o=1*n.attr("cy"),c=d.togglePoint,l=g<a&&a<p&&x<o&&o<_;else{if(!n.classed(X.bar))
// line/area selection not supported yet
return;a=(h=v(this)).x,o=h.y,s=h.width,u=h.height,c=d.togglePath,l=!(p<a||a+s<g||_<o||o+u<x)}l^r&&(n.classed(X.INCLUDED,!r),
// TODO: included/unincluded callback here
n.classed(X.SELECTED,!i),c.call(d,!i,n,t,e))})))},S.dragstart=function(t){var e=this,n=e.config;e.hasArcType()||n.data_selection_enabled&&(// do nothing if not selectable
e.dragStart=t,e.main.select("."+X.chart).append("rect").attr("class",X.dragarea).style("opacity",.1),e.dragging=!0)},S.dragend=function(){var t=this,e=t.config;t.hasArcType()||e.data_selection_enabled&&(// do nothing if not selectable
t.main.select("."+X.dragarea).transition().duration(100).style("opacity",0).remove(),t.main.selectAll("."+X.shape).classed(X.INCLUDED,!1),t.dragging=!1)},S.getYFormat=function(t){var r=this,a=t&&!r.hasType("gauge")?r.defaultArcValueFormat:r.yFormat,o=t&&!r.hasType("gauge")?r.defaultArcValueFormat:r.y2Format;return function(t,e,n){var i;return("y2"===r.axis.getId(n)?o:a).call(r,t,e)}},S.yFormat=function(t){var e=this,n=e.config,i;return(n.axis_y_tick_format?n.axis_y_tick_format:e.defaultValueFormat)(t)},S.y2Format=function(t){var e=this,n=e.config,i;return(n.axis_y2_tick_format?n.axis_y2_tick_format:e.defaultValueFormat)(t)},S.defaultValueFormat=function(t){return C(t)?+t:""},S.defaultArcValueFormat=function(t,e){return(100*e).toFixed(1)+"%"},S.dataLabelFormat=function(t){var e,n=this.config.data_labels,i,r=function t(e){return C(e)?+e:""};
// find format according to axis id
return i="function"==typeof n.format?n.format:"object"===u(n.format)?n.format[t]?!0===n.format[t]?r:n.format[t]:function t(){return""}:r},S.initGrid=function(){var t=this,e=t.config,n=t.d3;t.grid=t.main.append("g").attr("clip-path",t.clipPathForGrid).attr("class",X.grid),e.grid_x_show&&t.grid.append("g").attr("class",X.xgrids),e.grid_y_show&&t.grid.append("g").attr("class",X.ygrids),e.grid_focus_show&&t.grid.append("g").attr("class",X.xgridFocus).append("line").attr("class",X.xgridFocus),t.xgrid=n.selectAll([]),e.grid_lines_front||t.initGridLines()},S.initGridLines=function(){var t=this,e=t.d3;t.gridLines=t.main.append("g").attr("clip-path",t.clipPathForGrid).attr("class",X.grid+" "+X.gridLines),t.gridLines.append("g").attr("class",X.xgridLines),t.gridLines.append("g").attr("class",X.ygridLines),t.xgridLines=e.selectAll([])},S.updateXGrid=function(t){var n=this,e=n.config,i=n.d3,r=n.generateGridData(e.grid_x_type,n.x),a=n.isCategorized()?n.xAxis.tickOffset():0;n.xgridAttr=e.axis_rotated?{x1:0,x2:n.width,y1:function t(e){return n.x(e)-a},y2:function t(e){return n.x(e)-a}}:{x1:function t(e){return n.x(e)+a},x2:function t(e){return n.x(e)+a},y1:0,y2:n.height},n.xgrid=n.main.select("."+X.xgrids).selectAll("."+X.xgrid).data(r),n.xgrid.enter().append("line").attr("class",X.xgrid),t||n.xgrid.attr(n.xgridAttr).style("opacity",function(){return+i.select(this).attr(e.axis_rotated?"y1":"x1")===(e.axis_rotated?n.height:0)?0:1}),n.xgrid.exit().remove()},S.updateYGrid=function(){var t=this,e=t.config,n=t.yAxis.tickValues()||t.y.ticks(e.grid_y_ticks);t.ygrid=t.main.select("."+X.ygrids).selectAll("."+X.ygrid).data(n),t.ygrid.enter().append("line").attr("class",X.ygrid),t.ygrid.attr("x1",e.axis_rotated?t.y:0).attr("x2",e.axis_rotated?t.y:t.width).attr("y1",e.axis_rotated?0:t.y).attr("y2",e.axis_rotated?t.height:t.y),t.ygrid.exit().remove(),t.smoothLines(t.ygrid,"grid")},S.gridTextAnchor=function(t){return t.position?t.position:"end"},S.gridTextDx=function(t){return"start"===t.position?4:"middle"===t.position?0:-4},S.xGridTextX=function(t){return"start"===t.position?-this.height:"middle"===t.position?-this.height/2:0},S.yGridTextX=function(t){return"start"===t.position?0:"middle"===t.position?this.width/2:this.width},S.updateGrid=function(t){var e=this,n=e.main,i=e.config,r,a,o;
// hide if arc type
e.grid.style("visibility",e.hasArcType()?"hidden":"visible"),n.select("line."+X.xgridFocus).style("visibility","hidden"),i.grid_x_show&&e.updateXGrid(),e.xgridLines=n.select("."+X.xgridLines).selectAll("."+X.xgridLine).data(i.grid_x_lines),(
// enter
r=e.xgridLines.enter().append("g").attr("class",function(t){return X.xgridLine+(t.class?" "+t.class:"")})).append("line").style("opacity",0),r.append("text").attr("text-anchor",e.gridTextAnchor).attr("transform",i.axis_rotated?"":"rotate(-90)").attr("dx",e.gridTextDx).attr("dy",-5).style("opacity",0),
// udpate
// done in d3.transition() of the end of this function
// exit
e.xgridLines.exit().transition().duration(t).style("opacity",0).remove(),
// Y-Grid
i.grid_y_show&&e.updateYGrid(),e.ygridLines=n.select("."+X.ygridLines).selectAll("."+X.ygridLine).data(i.grid_y_lines),(
// enter
a=e.ygridLines.enter().append("g").attr("class",function(t){return X.ygridLine+(t.class?" "+t.class:"")})).append("line").style("opacity",0),a.append("text").attr("text-anchor",e.gridTextAnchor).attr("transform",i.axis_rotated?"rotate(-90)":"").attr("dx",e.gridTextDx).attr("dy",-5).style("opacity",0),
// update
o=e.yv.bind(e),e.ygridLines.select("line").transition().duration(t).attr("x1",i.axis_rotated?o:0).attr("x2",i.axis_rotated?o:e.width).attr("y1",i.axis_rotated?0:o).attr("y2",i.axis_rotated?e.height:o).style("opacity",1),e.ygridLines.select("text").transition().duration(t).attr("x",i.axis_rotated?e.xGridTextX.bind(e):e.yGridTextX.bind(e)).attr("y",o).text(function(t){return t.text}).style("opacity",1),
// exit
e.ygridLines.exit().transition().duration(t).style("opacity",0).remove()},S.redrawGrid=function(t){var e=this,n=e.config,i=e.xv.bind(e),r=e.xgridLines.select("line"),a=e.xgridLines.select("text");return[(t?r.transition():r).attr("x1",n.axis_rotated?0:i).attr("x2",n.axis_rotated?e.width:i).attr("y1",n.axis_rotated?i:0).attr("y2",n.axis_rotated?i:e.height).style("opacity",1),(t?a.transition():a).attr("x",n.axis_rotated?e.yGridTextX.bind(e):e.xGridTextX.bind(e)).attr("y",i).text(function(t){return t.text}).style("opacity",1)]},S.showXGridFocus=function(t){var e=this,n=e.config,i=t.filter(function(t){return t&&C(t.value)}),r=e.main.selectAll("line."+X.xgridFocus),a=e.xx.bind(e);n.tooltip_show&&(
// Hide when scatter plot exists
e.hasType("scatter")||e.hasArcType()||(r.style("visibility","visible").data([i[0]]).attr(n.axis_rotated?"y1":"x1",a).attr(n.axis_rotated?"y2":"x2",a),e.smoothLines(r,"grid")))},S.hideXGridFocus=function(){this.main.select("line."+X.xgridFocus).style("visibility","hidden")},S.updateXgridFocus=function(){var t=this,e=t.config;t.main.select("line."+X.xgridFocus).attr("x1",e.axis_rotated?0:-10).attr("x2",e.axis_rotated?t.width:-10).attr("y1",e.axis_rotated?-10:0).attr("y2",e.axis_rotated?-10:t.height)},S.generateGridData=function(t,e){var n=this,i=[],r,a,o,s,u=n.main.select("."+X.axisX).selectAll(".tick").size();if("year"===t)for(a=(r=n.getXDomain())[0].getFullYear(),o=r[1].getFullYear(),s=a;s<=o;s++)i.push(new Date(s+"-01-01 00:00:00"));else(i=e.ticks(10)).length>u&&(
// use only int
i=i.filter(function(t){return(""+t).indexOf(".")<0}));return i},S.getGridFilterToRemove=function(t){return t?function(e){var n=!1;return[].concat(t).forEach(function(t){("value"in t&&e.value===t.value||"class"in t&&e.class===t.class)&&(n=!0)}),n}:function(){return!0}},S.removeGridLines=function(t,e){var n=this,i=n.config,r=n.getGridFilterToRemove(t),a=function t(e){return!r(e)},o=e?X.xgridLines:X.ygridLines,s=e?X.xgridLine:X.ygridLine;n.main.select("."+o).selectAll("."+s).filter(r).transition().duration(i.transition_duration).style("opacity",0).remove(),e?i.grid_x_lines=i.grid_x_lines.filter(a):i.grid_y_lines=i.grid_y_lines.filter(a)},S.initEventRect=function(){var t;this.main.select("."+X.chart).append("g").attr("class",X.eventRects).style("fill-opacity",0)},S.redrawEventRect=function(){var t=this,e=t.config,n,i,r=t.isMultipleX(),a=t.main.select("."+X.eventRects).style("cursor",e.zoom_enabled?e.axis_rotated?"ns-resize":"ew-resize":null).classed(X.eventRectsMultiple,r).classed(X.eventRectsSingle,!r);
// rects for mouseover
// clear old rects
a.selectAll("."+X.eventRect).remove(),
// open as public variable
t.eventRect=a.selectAll("."+X.eventRect),r?(n=t.eventRect.data([0]),
// enter : only one rect will be added
t.generateEventRectsForMultipleXs(n.enter()),
// update
t.updateEventRect(n)):(
// Set data and update $$.eventRect
i=t.getMaxDataCountTarget(t.data.targets),a.datum(i?i.values:[]),t.eventRect=a.selectAll("."+X.eventRect),n=t.eventRect.data(function(t){return t}),
// enter
t.generateEventRectsForSingleX(n.enter()),
// update
t.updateEventRect(n),
// exit
n.exit().remove())},S.updateEventRect=function(t){var a=this,r=a.config,e,n,i,o,s,u;
// set update selection if null
t=t||a.eventRect.data(function(t){return t}),o=a.isMultipleX()?(
// TODO: rotated not supported yet
n=e=0,i=a.width,a.height):(u=!a.isCustomX()&&!a.isTimeSeries()||a.isCategorized()?(s=a.getEventRectWidth(),function t(e){return a.x(e.x)-s/2}):(
// update index for x that is used by prevX and nextX
a.updateXs(),s=function t(e){var n=a.getPrevX(e.index),i=a.getNextX(e.index);
// if there this is a single data point make the eventRect full width (or height)
return null===n&&null===i?r.axis_rotated?a.height:a.width:(null===n&&(n=a.x.domain()[0]),null===i&&(i=a.x.domain()[1]),Math.max(0,(a.x(i)-a.x(n))/2))},function t(e){var n=a.getPrevX(e.index),i=a.getNextX(e.index),r=a.data.xs[e.id][e.index];
// if there this is a single data point position the eventRect at 0
return null===n&&null===i?0:(null===n&&(n=a.x.domain()[0]),(a.x(r)+a.x(n))/2)}),e=r.axis_rotated?0:u,n=r.axis_rotated?u:0,i=r.axis_rotated?a.width:s,r.axis_rotated?s:a.height),t.attr("class",a.classEvent.bind(a)).attr("x",e).attr("y",n).attr("width",i).attr("height",o)},S.generateEventRectsForSingleX=function(t){var r=this,a=r.d3,o=r.config;t.append("rect").attr("class",r.classEvent.bind(r)).style("cursor",o.data_selection_enabled&&o.data_selection_grouped?"pointer":null).on("mouseover",function(t){var e=t.index;r.dragging||r.flowing||r.hasArcType()||(
// Expand shapes for selection
o.point_focus_expand_enabled&&r.expandCircles(e,null,!0),r.expandBars(e,null,!0),
// Call event handler
r.main.selectAll("."+X.shape+"-"+e).each(function(t){o.data_onmouseover.call(r.api,t)}));// do nothing while dragging/flowing
}).on("mouseout",function(t){var e=t.index;r.config&&(// chart is destroyed
r.hasArcType()||(r.hideXGridFocus(),r.hideTooltip(),
// Undo expanded shapes
r.unexpandCircles(),r.unexpandBars(),
// Call event handler
r.main.selectAll("."+X.shape+"-"+e).each(function(t){o.data_onmouseout.call(r.api,t)})))}).on("mousemove",function(t){var e,n=t.index,i=r.svg.select("."+X.eventRect+"-"+n);r.dragging||r.flowing||r.hasArcType()||(r.isStepType(t)&&"step-after"===r.config.line_step_type&&a.mouse(this)[0]<r.x(r.getXValue(t.id,n))&&(n-=1),
// Show tooltip
e=r.filterTargetsToShow(r.data.targets).map(function(t){return r.addName(r.getValueOnIndex(t.values,n))}),o.tooltip_grouped&&(r.showTooltip(e,this),r.showXGridFocus(e)),(!o.tooltip_grouped||o.data_selection_enabled&&!o.data_selection_grouped)&&r.main.selectAll("."+X.shape+"-"+n).each(function(){a.select(this).classed(X.EXPANDED,!0),o.data_selection_enabled&&i.style("cursor",o.data_selection_grouped?"pointer":null),o.tooltip_grouped||(r.hideXGridFocus(),r.hideTooltip(),o.data_selection_grouped||(r.unexpandCircles(n),r.unexpandBars(n)))}).filter(function(t){return r.isWithinShape(this,t)}).each(function(t){o.data_selection_enabled&&(o.data_selection_grouped||o.data_selection_isselectable(t))&&i.style("cursor","pointer"),o.tooltip_grouped||(r.showTooltip([t],this),r.showXGridFocus([t]),o.point_focus_expand_enabled&&r.expandCircles(n,t.id,!0),r.expandBars(n,t.id,!0))}));// do nothing while dragging/flowing
}).on("click",function(t){var e=t.index;!r.hasArcType()&&r.toggleShape&&(r.cancelClick?r.cancelClick=!1:(r.isStepType(t)&&"step-after"===o.line_step_type&&a.mouse(this)[0]<r.x(r.getXValue(t.id,e))&&(e-=1),r.main.selectAll("."+X.shape+"-"+e).each(function(t){(o.data_selection_grouped||r.isWithinShape(this,t))&&(r.toggleShape(this,t,e),r.config.data_onclick.call(r.api,t,this))})))}).call(o.data_selection_draggable&&r.drag?a.behavior.drag().origin(Object).on("drag",function(){r.drag(a.mouse(this))}).on("dragstart",function(){r.dragstart(a.mouse(this))}).on("dragend",function(){r.dragend()}):function(){})},S.generateEventRectsForMultipleXs=function(t){function a(){o.svg.select("."+X.eventRect).style("cursor",null),o.hideXGridFocus(),o.hideTooltip(),o.unexpandCircles(),o.unexpandBars()}var o=this,s=o.d3,u=o.config;t.append("rect").attr("x",0).attr("y",0).attr("width",o.width).attr("height",o.height).attr("class",X.eventRect).on("mouseout",function(){o.config&&(// chart is destroyed
o.hasArcType()||a())}).on("mousemove",function(){var t=o.filterTargetsToShow(o.data.targets),e,n,i,r;o.dragging||o.hasArcType(t)||(e=s.mouse(this),n=o.findClosestFromTargets(t,e),!o.mouseover||n&&n.id===o.mouseover.id||(u.data_onmouseout.call(o.api,o.mouseover),o.mouseover=void 0),n?(
// show tooltip when cursor is close to some point
r=(i=o.isScatterType(n)||!u.tooltip_grouped?[n]:o.filterByX(t,n.x)).map(function(t){return o.addName(t)}),o.showTooltip(r,this),
// expand points
u.point_focus_expand_enabled&&o.expandCircles(n.index,n.id,!0),o.expandBars(n.index,n.id,!0),
// Show xgrid focus line
o.showXGridFocus(r),
// Show cursor as pointer if point is close to mouse position
(o.isBarType(n.id)||o.dist(n,e)<u.point_sensitivity)&&(o.svg.select("."+X.eventRect).style("cursor","pointer"),o.mouseover||(u.data_onmouseover.call(o.api,n),o.mouseover=n))):a());// do nothing when dragging
}).on("click",function(){var t=o.filterTargetsToShow(o.data.targets),e,n;o.hasArcType(t)||(e=s.mouse(this),(n=o.findClosestFromTargets(t,e))&&(o.isBarType(n.id)||o.dist(n,e)<u.point_sensitivity)&&o.main.selectAll("."+X.shapes+o.getTargetSelectorSuffix(n.id)).selectAll("."+X.shape+"-"+n.index).each(function(){(u.data_selection_grouped||o.isWithinShape(this,n))&&(o.toggleShape(this,n,n.index),o.config.data_onclick.call(o.api,n,this))}))}).call(u.data_selection_draggable&&o.drag?s.behavior.drag().origin(Object).on("drag",function(){o.drag(s.mouse(this))}).on("dragstart",function(){o.dragstart(s.mouse(this))}).on("dragend",function(){o.dragend()}):function(){})},S.dispatchEvent=function(t,e,n){var i=this,r="."+X.eventRect+(i.isMultipleX()?"":"-"+e),a=i.main.select(r).node(),o=a.getBoundingClientRect(),s=o.left+(n?n[0]:0),u=o.top+(n?n[1]:0),c=document.createEvent("MouseEvents");c.initMouseEvent(t,!0,!0,window,0,s,u,s,u,!1,!1,!1,!1,0,null),a.dispatchEvent(c)},S.initLegend=function(){var t=this;if(t.legendItemTextBox={},t.legendHasRendered=!1,t.legend=t.svg.append("g").attr("transform",t.getTranslate("legend")),!t.config.legend_show)return t.legend.style("visibility","hidden"),void(t.hiddenLegendIds=t.mapToIds(t.data.targets));
// MEMO: call here to update legend box and tranlate for all
// MEMO: translate will be upated by this, so transform not needed in updateLegend()
t.updateLegendWithDefaults()},S.updateLegendWithDefaults=function(){var t=this;t.updateLegend(t.mapToIds(t.data.targets),{withTransform:!1,withTransitionForTransform:!1,withTransition:!1})},S.updateSizeForLegend=function(t,e){var n=this,i=n.config,r={top:n.isLegendTop?n.getCurrentPaddingTop()+i.legend_inset_y+5.5:n.currentHeight-t-n.getCurrentPaddingBottom()-i.legend_inset_y,left:n.isLegendLeft?n.getCurrentPaddingLeft()+i.legend_inset_x+.5:n.currentWidth-e-n.getCurrentPaddingRight()-i.legend_inset_x+.5};n.margin3={top:n.isLegendRight?0:n.isLegendInset?r.top:n.currentHeight-t,right:NaN,bottom:0,left:n.isLegendRight?n.currentWidth-e:n.isLegendInset?r.left:0}},S.transformLegend=function(t){var e=this;(t?e.legend.transition():e.legend).attr("transform",e.getTranslate("legend"))},S.updateLegendStep=function(t){this.legendStep=t},S.updateLegendItemWidth=function(t){this.legendItemWidth=t},S.updateLegendItemHeight=function(t){this.legendItemHeight=t},S.getLegendWidth=function(){var t=this;return t.config.legend_show?t.isLegendRight||t.isLegendInset?t.legendItemWidth*(t.legendStep+1):t.currentWidth:0},S.getLegendHeight=function(){var t=this,e=0;return t.config.legend_show&&(e=t.isLegendRight?t.currentHeight:Math.max(20,t.legendItemHeight)*(t.legendStep+1)),e},S.opacityForLegend=function(t){return t.classed(X.legendItemHidden)?null:1},S.opacityForUnfocusedLegend=function(t){return t.classed(X.legendItemHidden)?null:.3},S.toggleFocusLegend=function(e,n){var i=this;e=i.mapToTargetIds(e),i.legend.selectAll("."+X.legendItem).filter(function(t){return 0<=e.indexOf(t)}).classed(X.legendItemFocused,n).transition().duration(100).style("opacity",function(){var t;return(n?i.opacityForLegend:i.opacityForUnfocusedLegend).call(i,i.d3.select(this))})},S.revertLegend=function(){var t=this,e=t.d3;t.legend.selectAll("."+X.legendItem).classed(X.legendItemFocused,!1).transition().duration(100).style("opacity",function(){return t.opacityForLegend(e.select(this))})},S.showLegend=function(t){var e=this,n=e.config;n.legend_show||(n.legend_show=!0,e.legend.style("visibility","visible"),e.legendHasRendered||e.updateLegendWithDefaults()),e.removeHiddenLegendIds(t),e.legend.selectAll(e.selectorLegends(t)).style("visibility","visible").transition().style("opacity",function(){return e.opacityForLegend(e.d3.select(this))})},S.hideLegend=function(t){var e=this,n=e.config;n.legend_show&&g(t)&&(n.legend_show=!1,e.legend.style("visibility","hidden")),e.addHiddenLegendIds(t),e.legend.selectAll(e.selectorLegends(t)).style("opacity",0).style("visibility","hidden")},S.clearLegendItemTextBoxCache=function(){this.legendItemTextBox={}},S.updateLegend=function(f,t,e){function g(t,e){return p.legendItemTextBox[e]||(p.legendItemTextBox[e]=p.getTextRect(t.textContent,X.legendItem,t)),p.legendItemTextBox[e]}function n(t,e,n){
// MEMO: care about condifion of step, totalLength
function i(t,e){e||(h=(l-b-c)/2)<w&&(h=(l-c)/2,b=0,M++),L[t]=M,C[M]=p.isLegendInset?10:h,A[t]=b,b+=c}var r=0===n,a=n===f.length-1,o=g(t,e),s=o.width+S+(!a||p.isLegendRight||p.isLegendInset?v:0)+x.legend_padding,u=o.height+_,c=p.isLegendRight||p.isLegendInset?u:s,l=p.isLegendRight||p.isLegendInset?p.getLegendHeight():p.getLegendWidth(),h,d;r&&(m=y=M=b=0),!x.legend_show||p.isLegendToShow(e)?(T[e]=s,P[e]=u,(!y||y<=s)&&(y=s),(!m||m<=u)&&(m=u),d=p.isLegendRight||p.isLegendInset?m:y,x.legend_equally?(Object.keys(T).forEach(function(t){T[t]=y}),Object.keys(P).forEach(function(t){P[t]=m}),(h=(l-d*f.length)/2)<w?(M=b=0,f.forEach(function(t){i(t)})):i(e,!0)):i(e)):T[e]=P[e]=L[e]=A[e]=0}var p=this,x=p.config,i,r,a,o,s,u,c,l,h,_=4,v=10,y=0,m=0,w=10,S=x.legend_item_tile_width+5,d,b=0,A={},T={},P={},C=[0],L={},M=0,E,V,G,k,R,O;
// Skip elements when their name is set to null
f=f.filter(function(t){return!I(x.data_names[t])||null!==x.data_names[t]}),E=H(t=t||{},"withTransition",!0),V=H(t,"withTransitionForTransform",!0),p.isLegendInset&&(M=x.legend_inset_step?x.legend_inset_step:f.length,p.updateLegendStep(M)),o=p.isLegendRight?(i=function t(e){return y*L[e]},function t(e){return C[L[e]]+A[e]}):p.isLegendInset?(i=function t(e){return y*L[e]+10},function t(e){return C[L[e]]+A[e]}):(i=function t(e){return C[L[e]]+A[e]},function t(e){return m*L[e]}),r=function t(e,n){return i(e,n)+4+x.legend_item_tile_width},s=function t(e,n){return o(e,n)+9},a=function t(e,n){return i(e,n)},u=function t(e,n){return o(e,n)-5},c=function t(e,n){return i(e,n)-2},l=function t(e,n){return i(e,n)-2+x.legend_item_tile_width},h=function t(e,n){return o(e,n)+4},(
// Define g for legend area
d=p.legend.selectAll("."+X.legendItem).data(f).enter().append("g").attr("class",function(t){return p.generateClass(X.legendItem,t)}).style("visibility",function(t){return p.isLegendToShow(t)?"visible":"hidden"}).style("cursor","pointer").on("click",function(t){x.legend_item_onclick?x.legend_item_onclick.call(p,t):p.d3.event.altKey?(p.api.hide(),p.api.show(t)):(p.api.toggle(t),p.isTargetToShow(t)?p.api.focus(t):p.api.revert())}).on("mouseover",function(t){x.legend_item_onmouseover?x.legend_item_onmouseover.call(p,t):(p.d3.select(this).classed(X.legendItemFocused,!0),!p.transiting&&p.isTargetToShow(t)&&p.api.focus(t))}).on("mouseout",function(t){x.legend_item_onmouseout?x.legend_item_onmouseout.call(p,t):(p.d3.select(this).classed(X.legendItemFocused,!1),p.api.revert())})).append("text").text(function(t){return I(x.data_names[t])?x.data_names[t]:t}).each(function(t,e){n(this,t,e)}).style("pointer-events","none").attr("x",p.isLegendRight||p.isLegendInset?r:-200).attr("y",p.isLegendRight||p.isLegendInset?-200:s),d.append("rect").attr("class",X.legendItemEvent).style("fill-opacity",0).attr("x",p.isLegendRight||p.isLegendInset?a:-200).attr("y",p.isLegendRight||p.isLegendInset?-200:u),d.append("line").attr("class",X.legendItemTile).style("stroke",p.color).style("pointer-events","none").attr("x1",p.isLegendRight||p.isLegendInset?c:-200).attr("y1",p.isLegendRight||p.isLegendInset?-200:h).attr("x2",p.isLegendRight||p.isLegendInset?l:-200).attr("y2",p.isLegendRight||p.isLegendInset?-200:h).attr("stroke-width",x.legend_item_tile_height),
// Set background for inset legend
O=p.legend.select("."+X.legendBackground+" rect"),p.isLegendInset&&0<y&&0===O.size()&&(O=p.legend.insert("g","."+X.legendItem).attr("class",X.legendBackground).append("rect")),G=p.legend.selectAll("text").data(f).text(function(t){return I(x.data_names[t])?x.data_names[t]:t}).each(function(t,e){n(this,t,e)}),(E?G.transition():G).attr("x",r).attr("y",s),k=p.legend.selectAll("rect."+X.legendItemEvent).data(f),(E?k.transition():k).attr("width",function(t){return T[t]}).attr("height",function(t){return P[t]}).attr("x",a).attr("y",u),R=p.legend.selectAll("line."+X.legendItemTile).data(f),(E?R.transition():R).style("stroke",p.levelColor?function(t){return p.levelColor(p.cache[t].values[0].value)}:p.color).attr("x1",c).attr("y1",h).attr("x2",l).attr("y2",h),O&&(E?O.transition():O).attr("height",p.getLegendHeight()-12).attr("width",y*(M+1)+10),
// toggle legend state
p.legend.selectAll("."+X.legendItem).classed(X.legendItemHidden,function(t){return!p.isTargetToShow(t)}),
// Update all to reflect change of legend
p.updateLegendItemWidth(y),p.updateLegendItemHeight(m),p.updateLegendStep(M),
// Update size and scale
p.updateSizes(),p.updateScales(),p.updateSvgSize(),
// Update g positions
p.transformAll(V,e),p.legendHasRendered=!0},S.initRegion=function(){var t=this;t.region=t.main.append("g").attr("clip-path",t.clipPath).attr("class",X.regions)},S.updateRegion=function(t){var e=this,n=e.config;
// hide if arc type
e.region.style("visibility",e.hasArcType()?"hidden":"visible"),e.mainRegion=e.main.select("."+X.regions).selectAll("."+X.region).data(n.regions),e.mainRegion.enter().append("g").append("rect").style("fill-opacity",0),e.mainRegion.attr("class",e.classRegion.bind(e)),e.mainRegion.exit().transition().duration(t).style("opacity",0).remove()},S.redrawRegion=function(t){var e=this,n=e.mainRegion.selectAll("rect").each(function(){
// data is binded to g and it's not transferred to rect (child node) automatically,
// then data of each rect has to be updated manually.
// TODO: there should be more efficient way to solve this?
var t=e.d3.select(this.parentNode).datum();e.d3.select(this).datum(t)}),i=e.regionX.bind(e),r=e.regionY.bind(e),a=e.regionWidth.bind(e),o=e.regionHeight.bind(e);return[(t?n.transition():n).attr("x",i).attr("y",r).attr("width",a).attr("height",o).style("fill-opacity",function(t){return C(t.opacity)?t.opacity:.1})]},S.regionX=function(t){var e=this,n=e.config,i,r="y"===t.axis?e.y:e.y2;return i="y"===t.axis||"y2"===t.axis?n.axis_rotated&&"start"in t?r(t.start):0:n.axis_rotated?0:"start"in t?e.x(e.isTimeSeries()?e.parseDate(t.start):t.start):0},S.regionY=function(t){var e=this,n=e.config,i,r="y"===t.axis?e.y:e.y2;return i="y"===t.axis||"y2"===t.axis?n.axis_rotated?0:"end"in t?r(t.end):0:n.axis_rotated&&"start"in t?e.x(e.isTimeSeries()?e.parseDate(t.start):t.start):0},S.regionWidth=function(t){var e=this,n=e.config,i=e.regionX(t),r,a="y"===t.axis?e.y:e.y2;return(r="y"===t.axis||"y2"===t.axis?n.axis_rotated&&"end"in t?a(t.end):e.width:n.axis_rotated?e.width:"end"in t?e.x(e.isTimeSeries()?e.parseDate(t.end):t.end):e.width)<i?0:r-i},S.regionHeight=function(t){var e=this,n=e.config,i=this.regionY(t),r,a="y"===t.axis?e.y:e.y2;return(r="y"===t.axis||"y2"===t.axis?n.axis_rotated?e.height:"start"in t?a(t.start):e.height:n.axis_rotated&&"end"in t?e.x(e.isTimeSeries()?e.parseDate(t.end):t.end):e.height)<i?0:r-i},S.isRegionOnX=function(t){return!t.axis||"x"===t.axis},S.getScale=function(t,e,n){return(n?this.d3.time.scale():this.d3.scale.linear()).range([t,e])},S.getX=function(t,e,n,r){var i=this,a=i.getScale(t,e,i.isTimeSeries()),o=n?a.domain(n):a,s;
// Define customized scale if categorized axis
// define functions
for(s in a=i.isCategorized()?(r=r||function(){return 0},function t(e,n){var i=o(e)+r(e);return n?i:Math.ceil(i)}):function t(e,n){var i=o(e);return n?i:Math.ceil(i)},o)a[s]=o[s];return a.orgDomain=function(){return o.domain()},
// define custom domain() for categorized axis
i.isCategorized()&&(a.domain=function(t){return arguments.length?(o.domain(t),a):[(t=this.orgDomain())[0],t[1]+1]}),a},S.getY=function(t,e,n){var i=this.getScale(t,e,this.isTimeSeriesY());return n&&i.domain(n),i},S.getYScale=function(t){return"y2"===this.axis.getId(t)?this.y2:this.y},S.getSubYScale=function(t){return"y2"===this.axis.getId(t)?this.subY2:this.subY},S.updateScales=function(){var e=this,t=e.config,n=!e.x;
// update edges
e.xMin=t.axis_rotated?1:0,e.xMax=t.axis_rotated?e.height:e.width,e.yMin=t.axis_rotated?0:e.height,e.yMax=t.axis_rotated?e.width:1,e.subXMin=e.xMin,e.subXMax=e.xMax,e.subYMin=t.axis_rotated?0:e.height2,e.subYMax=t.axis_rotated?e.width2:1,
// update scales
e.x=e.getX(e.xMin,e.xMax,n?void 0:e.x.orgDomain(),function(){return e.xAxis.tickOffset()}),e.y=e.getY(e.yMin,e.yMax,n?t.axis_y_default:e.y.domain()),e.y2=e.getY(e.yMin,e.yMax,n?t.axis_y2_default:e.y2.domain()),e.subX=e.getX(e.xMin,e.xMax,e.orgXDomain,function(t){return t%1?0:e.subXAxis.tickOffset()}),e.subY=e.getY(e.subYMin,e.subYMax,n?t.axis_y_default:e.subY.domain()),e.subY2=e.getY(e.subYMin,e.subYMax,n?t.axis_y2_default:e.subY2.domain()),
// update axes
e.xAxisTickFormat=e.axis.getXAxisTickFormat(),e.xAxisTickValues=e.axis.getXAxisTickValues(),e.yAxisTickValues=e.axis.getYAxisTickValues(),e.y2AxisTickValues=e.axis.getY2AxisTickValues(),e.xAxis=e.axis.getXAxis(e.x,e.xOrient,e.xAxisTickFormat,e.xAxisTickValues,t.axis_x_tick_outer),e.subXAxis=e.axis.getXAxis(e.subX,e.subXOrient,e.xAxisTickFormat,e.xAxisTickValues,t.axis_x_tick_outer),e.yAxis=e.axis.getYAxis(e.y,e.yOrient,t.axis_y_tick_format,e.yAxisTickValues,t.axis_y_tick_outer),e.y2Axis=e.axis.getYAxis(e.y2,e.y2Orient,t.axis_y2_tick_format,e.y2AxisTickValues,t.axis_y2_tick_outer),
// Set initialized scales to brush and zoom
n||(e.brush&&e.brush.scale(e.subX),t.zoom_enabled&&e.zoom.scale(e.x)),
// update for arc
e.updateArc&&e.updateArc()},S.selectPoint=function(t,e,n){var i=this,r=i.config,a=(r.axis_rotated?i.circleY:i.circleX).bind(i),o=(r.axis_rotated?i.circleX:i.circleY).bind(i),s=i.pointSelectR.bind(i);r.data_onselected.call(i.api,e,t.node()),
// add selected-circle on low layer g
i.main.select("."+X.selectedCircles+i.getTargetSelectorSuffix(e.id)).selectAll("."+X.selectedCircle+"-"+n).data([e]).enter().append("circle").attr("class",function(){return i.generateClass(X.selectedCircle,n)}).attr("cx",a).attr("cy",o).attr("stroke",function(){return i.color(e)}).attr("r",function(t){return 1.4*i.pointSelectR(t)}).transition().duration(100).attr("r",s)},S.unselectPoint=function(t,e,n){var i=this;i.config.data_onunselected.call(i.api,e,t.node()),
// remove selected-circle from low layer g
i.main.select("."+X.selectedCircles+i.getTargetSelectorSuffix(e.id)).selectAll("."+X.selectedCircle+"-"+n).transition().duration(100).attr("r",0).remove()},S.togglePoint=function(t,e,n,i){t?this.selectPoint(e,n,i):this.unselectPoint(e,n,i)},S.selectPath=function(t,e){var n=this;n.config.data_onselected.call(n,e,t.node()),n.config.interaction_brighten&&t.transition().duration(100).style("fill",function(){return n.d3.rgb(n.color(e)).brighter(.75)})},S.unselectPath=function(t,e){var n=this;n.config.data_onunselected.call(n,e,t.node()),n.config.interaction_brighten&&t.transition().duration(100).style("fill",function(){return n.color(e)})},S.togglePath=function(t,e,n,i){t?this.selectPath(e,n,i):this.unselectPath(e,n,i)},S.getToggle=function(t,e){var n=this,i;return"circle"===t.nodeName?
// circle is hidden in step chart, so treat as within the click area
i=n.isStepType(e)?function t(){}:n.togglePoint:"path"===t.nodeName&&(i=n.togglePath),i},S.toggleShape=function(t,e,n){var i=this,r=i.d3,a=i.config,o=r.select(t),s=o.classed(X.SELECTED),u=i.getToggle(t,e).bind(i);a.data_selection_enabled&&a.data_selection_isselectable(e)&&(a.data_selection_multiple||i.main.selectAll("."+X.shapes+(a.data_selection_grouped?i.getTargetSelectorSuffix(e.id):"")).selectAll("."+X.shape).each(function(t,e){var n=r.select(this);n.classed(X.SELECTED)&&u(!1,n.classed(X.SELECTED,!1),t,e)}),o.classed(X.SELECTED,!s),u(!s,o,e,n))},S.initBar=function(){var t;this.main.select("."+X.chart).append("g").attr("class",X.chartBars)},S.updateTargetsForBar=function(t){var e=this,n=e.config,i,r,a=e.classChartBar.bind(e),o=e.classBars.bind(e),s=e.classFocus.bind(e);
// Bars for each data
(r=(i=e.main.select("."+X.chartBars).selectAll("."+X.chartBar).data(t).attr("class",function(t){return a(t)+s(t)})).enter().append("g").attr("class",a).style("pointer-events","none")).append("g").attr("class",o).style("cursor",function(t){return n.data_selection_isselectable(t)?"pointer":null})},S.updateBar=function(t){var n=this,e=n.barData.bind(n),i=n.classBar.bind(n),r=n.initialOpacity.bind(n),a=function t(e){return n.color(e.id)};n.mainBar=n.main.selectAll("."+X.bars).selectAll("."+X.bar).data(e),n.mainBar.enter().append("path").attr("class",i).style("stroke",a).style("fill",a),n.mainBar.style("opacity",r),n.mainBar.exit().transition().duration(t).remove()},S.redrawBar=function(t,e){return[(e?this.mainBar.transition(Math.random().toString()):this.mainBar).attr("d",t).style("stroke",this.color).style("fill",this.color).style("opacity",1)]},S.getBarW=function(t,e){var n,i=this.config,r="number"==typeof i.bar_width?i.bar_width:e?t.tickInterval()*i.bar_width_ratio/e:0;return i.bar_width_max&&r>i.bar_width_max?i.bar_width_max:r},S.getBars=function(t,e){var n=this;return(e?n.main.selectAll("."+X.bars+n.getTargetSelectorSuffix(e)):n.main).selectAll("."+X.bar+(C(t)?"-"+t:""))},S.expandBars=function(t,e,n){var i=this;n&&i.unexpandBars(),i.getBars(t,e).classed(X.EXPANDED,!0)},S.unexpandBars=function(t){var e;this.getBars(t).classed(X.EXPANDED,!1)},S.generateDrawBar=function(t,e){var n=this,o=n.config,s=n.generateGetBarPoints(t,e);return function(t,e){
// 4 points that make a bar
var n=s(t,e),i=o.axis_rotated?1:0,r=o.axis_rotated?0:1,a;
// switch points if axis is rotated, not applicable for sub chart
return"M "+n[0][i]+","+n[0][r]+" L"+n[1][i]+","+n[1][r]+" L"+n[2][i]+","+n[2][r]+" L"+n[3][i]+","+n[3][r]+" z"}},S.generateGetBarPoints=function(t,e){var o=this,n=e?o.subXAxis:o.xAxis,i=t.__max__+1,s=o.getBarW(n,i),u=o.getShapeX(s,i,t,!!e),c=o.getShapeY(!!e),l=o.getShapeOffset(o.isBarType,t,!!e),h=s*(o.config.bar_space/2),d=e?o.getSubYScale:o.getYScale;return function(t,e){var n=d.call(o,t.id)(0),i=l(t,e)||n,
// offset is for stacked bar chart
r=u(t),a=c(t);
// fix posY not to overflow opposite quadrant
// 4 points that make a bar
return o.config.axis_rotated&&(0<t.value&&a<n||t.value<0&&n<a)&&(a=n),[[r+h,i],[r+h,a-(n-i)],[r+s-h,a-(n-i)],[r+s-h,i]]}},S.isWithinBar=function(t){var e=this.d3.mouse(t),n=t.getBoundingClientRect(),i=t.pathSegList.getItem(0),r=t.pathSegList.getItem(1),a=Math.min(i.x,r.x),o=Math.min(i.y,r.y),s,u,c=2,l,h=a+n.width+2,d=o+n.height+2,f=o-2;return a-2<e[0]&&e[0]<h&&f<e[1]&&e[1]<d},S.getShapeIndices=function(t){var e=this,n=e.config,i={},r=0,a,o;return e.filterTargetsToShow(e.data.targets.filter(t,e)).forEach(function(t){for(a=0;a<n.data_groups.length;a++)if(!(n.data_groups[a].indexOf(t.id)<0))for(o=0;o<n.data_groups[a].length;o++)if(n.data_groups[a][o]in i){i[t.id]=i[n.data_groups[a][o]];break}A(i[t.id])&&(i[t.id]=r++)}),i.__max__=r-1,i},S.getShapeX=function(n,i,r,t){var e=this,a=t?e.subX:e.x;return function(t){var e=t.id in r?r[t.id]:0;return t.x||0===t.x?a(t.x)-n*(i/2-e):0}},S.getShapeY=function(n){var i=this;return function(t){var e;return(n?i.getSubYScale(t.id):i.getYScale(t.id))(t.value)}},S.getShapeOffset=function(t,s,e){var u=this,c=u.orderTargets(u.filterTargetsToShow(u.data.targets.filter(t,u))),l=c.map(function(t){return t.id});return function(n,i){var r=e?u.getSubYScale(n.id):u.getYScale(n.id),a=r(0),o=a;return c.forEach(function(t){var e=u.isStepType(n)?u.convertValuesToStep(t.values):t.values;t.id!==n.id&&s[t.id]===s[n.id]&&l.indexOf(t.id)<l.indexOf(n.id)&&(
// check if the x values line up
void 0!==e[i]&&+e[i].x==+n.x||(
// "+" for timeseries
// if not, try to find the value that does line up
i=-1,e.forEach(function(t,e){t.x===n.x&&(i=e)})),i in e&&0<=e[i].value*n.value&&(o+=r(e[i].value)-a))}),o}},S.isWithinShape=function(t,e){var n=this,i=n.d3.select(t),r;return n.isTargetToShow(e.id)?"circle"===t.nodeName?r=n.isStepType(e)?n.isWithinStep(t,n.getYScale(e.id)(e.value)):n.isWithinCircle(t,1.5*n.pointSelectR(e)):"path"===t.nodeName&&(r=!i.classed(X.bar)||n.isWithinBar(t)):r=!1,r},S.getInterpolate=function(t){var e=this,n=e.isInterpolationType(e.config.spline_interpolation_type)?e.config.spline_interpolation_type:"cardinal";return e.isSplineType(t)?n:e.isStepType(t)?e.config.line_step_type:"linear"},S.initLine=function(){var t;this.main.select("."+X.chart).append("g").attr("class",X.chartLines)},S.updateTargetsForLine=function(t){var n=this,e=n.config,i,r,a=n.classChartLine.bind(n),o=n.classLines.bind(n),s=n.classAreas.bind(n),u=n.classCircles.bind(n),c=n.classFocus.bind(n);
// Lines for each data
(r=(i=n.main.select("."+X.chartLines).selectAll("."+X.chartLine).data(t).attr("class",function(t){return a(t)+c(t)})).enter().append("g").attr("class",a).style("opacity",0).style("pointer-events","none")).append("g").attr("class",o),
// Areas
r.append("g").attr("class",s),
// Circles for each data point on lines
r.append("g").attr("class",function(t){return n.generateClass(X.selectedCircles,t.id)}),r.append("g").attr("class",u).style("cursor",function(t){return e.data_selection_isselectable(t)?"pointer":null}),
// Update date for selected circles
t.forEach(function(e){n.main.selectAll("."+X.selectedCircles+n.getTargetSelectorSuffix(e.id)).selectAll("."+X.selectedCircle).each(function(t){t.value=e.values[t.index].value})})},S.updateLine=function(t){var e=this;e.mainLine=e.main.selectAll("."+X.lines).selectAll("."+X.line).data(e.lineData.bind(e)),e.mainLine.enter().append("path").attr("class",e.classLine.bind(e)).style("stroke",e.color),e.mainLine.style("opacity",e.initialOpacity.bind(e)).style("shape-rendering",function(t){return e.isStepType(t)?"crispEdges":""}).attr("transform",null),e.mainLine.exit().transition().duration(t).style("opacity",0).remove()},S.redrawLine=function(t,e){return[(e?this.mainLine.transition(Math.random().toString()):this.mainLine).attr("d",t).style("stroke",this.color).style("opacity",1)]},S.generateDrawLine=function(t,s){var u=this,c=u.config,l=u.d3.svg.line(),i=u.generateGetLinePoints(t,s),h=s?u.getSubYScale:u.getYScale,e=function t(e){return(s?u.subxx:u.xx).call(u,e)},n=function t(e,n){return 0<c.data_groups.length?i(e,n)[0][1]:h.call(u,e.id)(e.value)};return l=c.axis_rotated?l.x(n).y(e):l.x(e).y(n),c.line_connectNull||(l=l.defined(function(t){return null!=t.value})),function(t){var e=c.line_connectNull?u.filterRemoveNull(t.values):t.values,n=s?u.x:u.subX,i=h.call(u,t.id),r=0,a=0,o;return(o=u.isLineType(t)?c.data_regions[t.id]?u.lineWithRegions(e,n,i,c.data_regions[t.id]):(u.isStepType(t)&&(e=u.convertValuesToStep(e)),l.interpolate(u.getInterpolate(t))(e)):(e[0]&&(r=n(e[0].x),a=i(e[0].value)),c.axis_rotated?"M "+a+" "+r:"M "+r+" "+a))||"M 0 0"}},S.generateGetLinePoints=function(t,e){
// partial duplication of generateGetBarPoints
var o=this,s=o.config,n=t.__max__+1,u=o.getShapeX(0,n,t,!!e),c=o.getShapeY(!!e),l=o.getShapeOffset(o.isLineType,t,!!e),h=e?o.getSubYScale:o.getYScale;return function(t,e){var n=h.call(o,t.id)(0),i=l(t,e)||n,
// offset is for stacked area chart
r=u(t),a=c(t);
// fix posY not to overflow opposite quadrant
// 1 point that marks the line position
return s.axis_rotated&&(0<t.value&&a<n||t.value<0&&n<a)&&(a=n),[[r,a-(n-i)],[r,a-(n-i)],// needed for compatibility
[r,a-(n-i)],// needed for compatibility
[r,a-(n-i)]]}},S.lineWithRegions=function(t,l,h,e){function n(t,e){var n;for(n=0;n<e.length;n++)if(e[n].start<t&&t<=e[n].end)return!0;return!1}
// Check start/end of regions
// Define svg generator function for region
function d(t){return"M"+t[0][0]+" "+t[0][1]+" "+t[1][0]+" "+t[1][1]}var i=this,f=i.config,r=-1,a,o,s="M",u,c,g,p,x,_,v,y,m=i.isCategorized()?.5:0,w,S,b=[];if(I(e))for(a=0;a<e.length;a++)b[a]={},A(e[a].start)?b[a].start=t[0].x:b[a].start=i.isTimeSeries()?i.parseDate(e[a].start):e[a].start,A(e[a].end)?b[a].end=t[t.length-1].x:b[a].end=i.isTimeSeries()?i.parseDate(e[a].end):e[a].end;
// Set scales
// Generate
for(w=f.axis_rotated?function(t){return h(t.value)}:function(t){return l(t.x)},S=f.axis_rotated?function(t){return l(t.x)}:function(t){return h(t.value)},u=i.isTimeSeries()?function t(e,n,i,r){var a=e.x.getTime(),o=n.x-e.x,s=new Date(a+o*i),u=new Date(a+o*(i+r)),c;return d(c=f.axis_rotated?[[h(g(i)),l(s)],[h(g(i+r)),l(u)]]:[[l(s),h(g(i))],[l(u),h(g(i+r))]])}:function t(e,n,i,r){var a;return d(a=f.axis_rotated?[[h(g(i),!0),l(c(i))],[h(g(i+r),!0),l(c(i+r))]]:[[l(c(i),!0),h(g(i))],[l(c(i+r),!0),h(g(i+r))]])},a=0;a<t.length;a++){
// Draw as normal
if(A(b)||!n(t[a].x,b))s+=" "+w(t[a])+" "+S(t[a]);else for(c=i.getScale(t[a-1].x+m,t[a].x+m,i.isTimeSeries()),g=i.getScale(t[a-1].value,t[a].value),p=l(t[a].x)-l(t[a-1].x),x=h(t[a].value)-h(t[a-1].value),y=2*(v=2/(_=Math.sqrt(Math.pow(p,2)+Math.pow(x,2)))),o=v;o<=1;o+=y)s+=u(t[a-1],t[a],o,v);r=t[a].x}return s},S.updateArea=function(t){var e=this,n=e.d3;e.mainArea=e.main.selectAll("."+X.areas).selectAll("."+X.area).data(e.lineData.bind(e)),e.mainArea.enter().append("path").attr("class",e.classArea.bind(e)).style("fill",e.color).style("opacity",function(){return e.orgAreaOpacity=+n.select(this).style("opacity"),0}),e.mainArea.style("opacity",e.orgAreaOpacity),e.mainArea.exit().transition().duration(t).style("opacity",0).remove()},S.redrawArea=function(t,e){return[(e?this.mainArea.transition(Math.random().toString()):this.mainArea).attr("d",t).style("fill",this.color).style("opacity",this.orgAreaOpacity)]},S.generateDrawArea=function(t,n){var a=this,o=a.config,s=a.d3.svg.area(),i=a.generateGetAreaPoints(t,n),r=n?a.getSubYScale:a.getYScale,e=function t(e){return(n?a.subxx:a.xx).call(a,e)},u=function t(e,n){return 0<o.data_groups.length?i(e,n)[0][1]:r.call(a,e.id)(a.getAreaBaseValue(e.id))},c=function t(e,n){return 0<o.data_groups.length?i(e,n)[1][1]:r.call(a,e.id)(e.value)};return s=o.axis_rotated?s.x0(u).x1(c).y(e):s.x(e).y0(o.area_above?0:u).y1(c),o.line_connectNull||(s=s.defined(function(t){return null!==t.value})),function(t){var e=o.line_connectNull?a.filterRemoveNull(t.values):t.values,n=0,i=0,r;return(r=a.isAreaType(t)?(a.isStepType(t)&&(e=a.convertValuesToStep(e)),s.interpolate(a.getInterpolate(t))(e)):(e[0]&&(n=a.x(e[0].x),i=a.getYScale(t.id)(e[0].value)),o.axis_rotated?"M "+i+" "+n:"M "+n+" "+i))||"M 0 0"}},S.getAreaBaseValue=function(){return 0},S.generateGetAreaPoints=function(t,e){
// partial duplication of generateGetBarPoints
var o=this,s=o.config,n=t.__max__+1,u=o.getShapeX(0,n,t,!!e),c=o.getShapeY(!!e),l=o.getShapeOffset(o.isAreaType,t,!!e),h=e?o.getSubYScale:o.getYScale;return function(t,e){var n=h.call(o,t.id)(0),i=l(t,e)||n,
// offset is for stacked area chart
r=u(t),a=c(t);
// fix posY not to overflow opposite quadrant
// 1 point that marks the area position
return s.axis_rotated&&(0<t.value&&a<n||t.value<0&&n<a)&&(a=n),[[r,i],[r,a-(n-i)],[r,a-(n-i)],// needed for compatibility
[r,i]]}},S.updateCircle=function(){var t=this;t.mainCircle=t.main.selectAll("."+X.circles).selectAll("."+X.circle).data(t.lineOrScatterData.bind(t)),t.mainCircle.enter().append("circle").attr("class",t.classCircle.bind(t)).attr("r",t.pointR.bind(t)).style("fill",t.color),t.mainCircle.style("opacity",t.initialOpacityForCircle.bind(t)),t.mainCircle.exit().remove()},S.redrawCircle=function(t,e,n){var i=this.main.selectAll("."+X.selectedCircle);return[(n?this.mainCircle.transition(Math.random().toString()):this.mainCircle).style("opacity",this.opacityForCircle.bind(this)).style("fill",this.color).attr("cx",t).attr("cy",e),(n?i.transition(Math.random().toString()):i).attr("cx",t).attr("cy",e)]},S.circleX=function(t){return t.x||0===t.x?this.x(t.x):null},S.updateCircleY=function(){var e=this,t,n;0<e.config.data_groups.length?(t=e.getShapeIndices(e.isLineType),n=e.generateGetLinePoints(t),e.circleY=function(t,e){return n(t,e)[0][1]}):e.circleY=function(t){return e.getYScale(t.id)(t.value)}},S.getCircles=function(t,e){var n=this;return(e?n.main.selectAll("."+X.circles+n.getTargetSelectorSuffix(e)):n.main).selectAll("."+X.circle+(C(t)?"-"+t:""))},S.expandCircles=function(t,e,n){var i=this,r=i.pointExpandedR.bind(i);n&&i.unexpandCircles(),i.getCircles(t,e).classed(X.EXPANDED,!0).attr("r",r)},S.unexpandCircles=function(t){var e=this,n=e.pointR.bind(e);e.getCircles(t).filter(function(){return e.d3.select(this).classed(X.EXPANDED)}).classed(X.EXPANDED,!1).attr("r",n)},S.pointR=function(t){var e=this,n=e.config;return e.isStepType(t)?0:d(n.point_r)?n.point_r(t):n.point_r},S.pointExpandedR=function(t){var e=this,n=e.config;return n.point_focus_expand_enabled?d(n.point_focus_expand_r)?n.point_focus_expand_r(t):n.point_focus_expand_r?n.point_focus_expand_r:1.75*e.pointR(t):e.pointR(t)},S.pointSelectR=function(t){var e=this,n=e.config;return d(n.point_select_r)?n.point_select_r(t):n.point_select_r?n.point_select_r:4*e.pointR(t)},S.isWithinCircle=function(t,e){var n=this.d3,i=n.mouse(t),r=n.select(t),a=+r.attr("cx"),o=+r.attr("cy");return Math.sqrt(Math.pow(a-i[0],2)+Math.pow(o-i[1],2))<e},S.isWithinStep=function(t,e){return Math.abs(e-this.d3.mouse(t)[1])<30},S.getCurrentWidth=function(){var t=this,e=t.config;return e.size_width?e.size_width:t.getParentWidth()},S.getCurrentHeight=function(){var t=this,e=t.config,n=e.size_height?e.size_height:t.getParentHeight();return 0<n?n:320/(t.hasType("gauge")&&!e.gauge_fullCircle?2:1)},S.getCurrentPaddingTop=function(){var t=this,e=t.config,n=C(e.padding_top)?e.padding_top:0;return t.title&&t.title.node()&&(n+=t.getTitlePadding()),n},S.getCurrentPaddingBottom=function(){var t=this.config;return C(t.padding_bottom)?t.padding_bottom:0},S.getCurrentPaddingLeft=function(t){var e=this,n=e.config;return C(n.padding_left)?n.padding_left:n.axis_rotated?n.axis_x_show?Math.max(h(e.getAxisWidthByAxisId("x",t)),40):1:!n.axis_y_show||n.axis_y_inner?e.axis.getYAxisLabelPosition().isOuter?30:1:h(e.getAxisWidthByAxisId("y",t))},S.getCurrentPaddingRight=function(){var t=this,e=t.config,n=10,i=t.isLegendRight?t.getLegendWidth()+20:0;return C(e.padding_right)?e.padding_right+1:e.axis_rotated?10+i:!e.axis_y2_show||e.axis_y2_inner?2+i+(t.axis.getY2AxisLabelPosition().isOuter?20:0):h(t.getAxisWidthByAxisId("y2"))+i},S.getParentRectValue=function(e){for(var n=this.selectChart.node(),i;n&&"BODY"!==n.tagName;){try{i=n.getBoundingClientRect()[e]}catch(t){"width"===e&&(
// In IE in certain cases getBoundingClientRect
// will cause an "unspecified error"
i=n.offsetWidth)}if(i)break;n=n.parentNode}return i},S.getParentWidth=function(){return this.getParentRectValue("width")},S.getParentHeight=function(){var t=this.selectChart.style("height");return 0<t.indexOf("px")?+t.replace("px",""):0},S.getSvgLeft=function(t){var e=this,n=e.config,i=n.axis_rotated||!n.axis_rotated&&!n.axis_y_inner,r=n.axis_rotated?X.axisX:X.axisY,a=e.main.select("."+r).node(),o=a&&i?a.getBoundingClientRect():{right:0},s=e.selectChart.node().getBoundingClientRect(),u=e.hasArcType(),c=o.right-s.left-(u?0:e.getCurrentPaddingLeft(t));return 0<c?c:0},S.getAxisWidthByAxisId=function(t,e){var n=this,i=n.axis.getLabelPositionById(t);return n.axis.getMaxTickWidth(t,e)+(i.isInner?20:40)},S.getHorizontalAxisHeight=function(t){var e=this,n=e.config,i=30;return"x"!==t||n.axis_x_show?"x"===t&&n.axis_x_height?n.axis_x_height:"y"!==t||n.axis_y_show?"y2"!==t||n.axis_y2_show?(
// Calculate x axis height when tick rotated
"x"===t&&!n.axis_rotated&&n.axis_x_tick_rotate&&(i=30+e.axis.getMaxTickWidth(t)*Math.cos(Math.PI*(90-n.axis_x_tick_rotate)/180)),
// Calculate y axis height when tick rotated
"y"===t&&n.axis_rotated&&n.axis_y_tick_rotate&&(i=30+e.axis.getMaxTickWidth(t)*Math.cos(Math.PI*(90-n.axis_y_tick_rotate)/180)),i+(e.axis.getLabelPositionById(t).isInner?0:10)+("y2"===t?-10:0)):e.rotated_padding_top:!n.legend_show||e.isLegendRight||e.isLegendInset?1:10:8},S.getEventRectWidth=function(){return Math.max(0,this.xAxis.tickInterval())},S.initBrush=function(){var e=this,t=e.d3;e.brush=t.svg.brush().on("brush",function(){e.redrawForBrush()}),e.brush.update=function(){return e.context&&e.context.select("."+X.brush).call(this),this},e.brush.scale=function(t){return e.config.axis_rotated?this.y(t):this.x(t)}},S.initSubchart=function(){var t=this,e=t.config,n=t.context=t.svg.append("g").attr("transform",t.getTranslate("context")),i=e.subchart_show?"visible":"hidden";n.style("visibility",i),
// Define g for chart area
n.append("g").attr("clip-path",t.clipPathForSubchart).attr("class",X.chart),
// Define g for bar chart area
n.select("."+X.chart).append("g").attr("class",X.chartBars),
// Define g for line chart area
n.select("."+X.chart).append("g").attr("class",X.chartLines),
// Add extent rect for Brush
n.append("g").attr("clip-path",t.clipPath).attr("class",X.brush).call(t.brush),
// ATTENTION: This must be called AFTER chart added
// Add Axis
t.axes.subx=n.append("g").attr("class",X.axisX).attr("transform",t.getTranslate("subx")).attr("clip-path",e.axis_rotated?"":t.clipPathForXAxis).style("visibility",e.subchart_axis_x_show?i:"hidden")},S.updateTargetsForSubchart=function(t){var e=this,n=e.context,i=e.config,r,a,o,s,u=e.classChartBar.bind(e),c=e.classBars.bind(e),l=e.classChartLine.bind(e),h=e.classLines.bind(e),d=e.classAreas.bind(e);i.subchart_show&&(
//-- Bar --//
// Bars for each data
(o=(s=n.select("."+X.chartBars).selectAll("."+X.chartBar).data(t).attr("class",u)).enter().append("g").style("opacity",0).attr("class",u)).append("g").attr("class",c),
// Lines for each data
(r=(
//-- Line --//
a=n.select("."+X.chartLines).selectAll("."+X.chartLine).data(t).attr("class",l)).enter().append("g").style("opacity",0).attr("class",l)).append("g").attr("class",h),
// Area
r.append("g").attr("class",d),
//-- Brush --//
n.selectAll("."+X.brush+" rect").attr(i.axis_rotated?"width":"height",i.axis_rotated?e.width2:e.height2))},S.updateBarForSubchart=function(t){var e=this;e.contextBar=e.context.selectAll("."+X.bars).selectAll("."+X.bar).data(e.barData.bind(e)),e.contextBar.enter().append("path").attr("class",e.classBar.bind(e)).style("stroke","none").style("fill",e.color),e.contextBar.style("opacity",e.initialOpacity.bind(e)),e.contextBar.exit().transition().duration(t).style("opacity",0).remove()},S.redrawBarForSubchart=function(t,e,n){(e?this.contextBar.transition(Math.random().toString()).duration(n):this.contextBar).attr("d",t).style("opacity",1)},S.updateLineForSubchart=function(t){var e=this;e.contextLine=e.context.selectAll("."+X.lines).selectAll("."+X.line).data(e.lineData.bind(e)),e.contextLine.enter().append("path").attr("class",e.classLine.bind(e)).style("stroke",e.color),e.contextLine.style("opacity",e.initialOpacity.bind(e)),e.contextLine.exit().transition().duration(t).style("opacity",0).remove()},S.redrawLineForSubchart=function(t,e,n){(e?this.contextLine.transition(Math.random().toString()).duration(n):this.contextLine).attr("d",t).style("opacity",1)},S.updateAreaForSubchart=function(t){var e=this,n=e.d3;e.contextArea=e.context.selectAll("."+X.areas).selectAll("."+X.area).data(e.lineData.bind(e)),e.contextArea.enter().append("path").attr("class",e.classArea.bind(e)).style("fill",e.color).style("opacity",function(){return e.orgAreaOpacity=+n.select(this).style("opacity"),0}),e.contextArea.style("opacity",0),e.contextArea.exit().transition().duration(t).style("opacity",0).remove()},S.redrawAreaForSubchart=function(t,e,n){(e?this.contextArea.transition(Math.random().toString()).duration(n):this.contextArea).attr("d",t).style("fill",this.color).style("opacity",this.orgAreaOpacity)},S.redrawSubchart=function(t,e,n,i,r,a,o){var s=this,u=s.d3,c=s.config,l,h,d;s.context.style("visibility",c.subchart_show?"visible":"hidden"),
// subchart
c.subchart_show&&(
// reflect main chart to extent on subchart if zoomed
u.event&&"zoom"===u.event.type&&s.brush.extent(s.x.orgDomain()).update(),
// update subchart elements if needed
t&&(
// extent rect
s.brush.empty()||s.brush.extent(s.x.orgDomain()).update(),
// setup drawer - MEMO: this must be called after axis updated
l=s.generateDrawArea(r,!0),h=s.generateDrawBar(a,!0),d=s.generateDrawLine(o,!0),s.updateBarForSubchart(n),s.updateLineForSubchart(n),s.updateAreaForSubchart(n),s.redrawBarForSubchart(h,n,n),s.redrawLineForSubchart(d,n,n),s.redrawAreaForSubchart(l,n,n)))},S.redrawForBrush=function(){var t=this,e=t.x;t.redraw({withTransition:!1,withY:t.config.zoom_rescale,withSubchart:!1,withUpdateXDomain:!0,withDimension:!1}),t.config.subchart_onbrush.call(t.api,e.orgDomain())},S.transformContext=function(t,e){var n=this,i;e&&e.axisSubX?i=e.axisSubX:(i=n.context.select("."+X.axisX),t&&(i=i.transition())),n.context.attr("transform",n.getTranslate("context")),i.attr("transform",n.getTranslate("subx"))},S.getDefaultExtent=function(){var t=this,e=t.config,n=d(e.axis_x_extent)?e.axis_x_extent(t.getXDomain(t.data.targets)):e.axis_x_extent;return t.isTimeSeries()&&(n=[t.parseDate(n[0]),t.parseDate(n[1])]),n},S.initText=function(){var t=this;t.main.select("."+X.chart).append("g").attr("class",X.chartTexts),t.mainText=t.d3.selectAll([])},S.updateTargetsForText=function(t){var e=this,n,i,r=e.classChartText.bind(e),a=e.classTexts.bind(e),o=e.classFocus.bind(e);(i=(n=e.main.select("."+X.chartTexts).selectAll("."+X.chartText).data(t).attr("class",function(t){return r(t)+o(t)})).enter().append("g").attr("class",r).style("opacity",0).style("pointer-events","none")).append("g").attr("class",a)},S.updateText=function(t){var i=this,e=i.config,n=i.barOrLineData.bind(i),r=i.classText.bind(i);i.mainText=i.main.selectAll("."+X.texts).selectAll("."+X.text).data(n),i.mainText.enter().append("text").attr("class",r).attr("text-anchor",function(t){return e.axis_rotated?t.value<0?"end":"start":"middle"}).style("stroke","none").style("fill",function(t){return i.color(t)}).style("fill-opacity",0),i.mainText.text(function(t,e,n){return i.dataLabelFormat(t.id)(t.value,t.id,e,n)}),i.mainText.exit().transition().duration(t).style("fill-opacity",0).remove()},S.redrawText=function(t,e,n,i){return[(i?this.mainText.transition():this.mainText).attr("x",t).attr("y",e).style("fill",this.color).style("fill-opacity",n?0:this.opacityForText.bind(this))]},S.getTextRect=function(t,e,n){var i=this.d3.select("body").append("div").classed("c3",!0),r=i.append("svg").style("visibility","hidden").style("position","fixed").style("top",0).style("left",0),a=this.d3.select(n).style("font"),o;return r.selectAll(".dummy").data([t]).enter().append("text").classed(e||"",!0).style("font",a).text(t).each(function(){o=this.getBoundingClientRect()}),i.remove(),o},S.generateXYForText=function(t,e,n,i){var r=this,a=r.generateGetAreaPoints(t,!1),o=r.generateGetBarPoints(e,!1),s=r.generateGetLinePoints(n,!1),u=i?r.getXForText:r.getYForText;return function(t,e){var n=r.isAreaType(t)?a:r.isBarType(t)?o:s;return u.call(r,n(t,e),t,this)}},S.getXForText=function(t,e,n){var i=this,r=n.getBoundingClientRect(),a,o;return a=i.config.axis_rotated?(o=i.isBarType(e)?4:6,t[2][1]+o*(e.value<0?-1:1)):i.hasType("bar")?(t[2][0]+t[0][0])/2:t[0][0],
// show labels regardless of the domain if value is null
null===e.value&&(a>i.width?a=i.width-r.width:a<0&&(a=4)),a},S.getYForText=function(t,e,n){var i=this,r=n.getBoundingClientRect(),a;return i.config.axis_rotated?a=(t[0][0]+t[2][0]+.6*r.height)/2:(a=t[2][1],e.value<0||0===e.value&&!i.hasPositiveValue?(a+=r.height,i.isBarType(e)&&i.isSafari()?a-=3:!i.isBarType(e)&&i.isChrome()&&(a+=3)):a+=i.isBarType(e)?-3:-6),
// show labels regardless of the domain if value is null
null!==e.value||i.config.axis_rotated||(a<r.height?a=r.height:a>this.height&&(a=this.height-4)),a},S.initTitle=function(){var t=this;t.title=t.svg.append("text").text(t.config.title_text).attr("class",t.CLASS.title)},S.redrawTitle=function(){var t=this;t.title.attr("x",t.xForTitle.bind(t)).attr("y",t.yForTitle.bind(t))},S.xForTitle=function(){var t=this,e=t.config,n=e.title_position||"left",i;return i=0<=n.indexOf("right")?t.currentWidth-t.getTextRect(t.title.node().textContent,t.CLASS.title,t.title.node()).width-e.title_padding.right:0<=n.indexOf("center")?(t.currentWidth-t.getTextRect(t.title.node().textContent,t.CLASS.title,t.title.node()).width)/2:e.title_padding.left},S.yForTitle=function(){var t=this;return t.config.title_padding.top+t.getTextRect(t.title.node().textContent,t.CLASS.title,t.title.node()).height},S.getTitlePadding=function(){var t=this;return t.yForTitle()+t.config.title_padding.bottom},S.initTooltip=function(){var e=this,n=e.config,t;
// Show tooltip if needed
if(e.tooltip=e.selectChart.style("position","relative").append("div").attr("class",X.tooltipContainer).style("position","absolute").style("pointer-events","none").style("display","none"),n.tooltip_init_show){if(e.isTimeSeries()&&l(n.tooltip_init_x)){for(n.tooltip_init_x=e.parseDate(n.tooltip_init_x),t=0;t<e.data.targets[0].values.length&&e.data.targets[0].values[t].x-n.tooltip_init_x!=0;t++);n.tooltip_init_x=t}e.tooltip.html(n.tooltip_contents.call(e,e.data.targets.map(function(t){return e.addName(t.values[n.tooltip_init_x])}),e.axis.getXAxisTickFormat(),e.getYFormat(e.hasArcType()),e.color)),e.tooltip.style("top",n.tooltip_init_position.top).style("left",n.tooltip_init_position.left).style("display","block")}},S.getTooltipSortFunction=function(){var t=this,e=t.config;if(0!==e.data_groups.length&&void 0===e.tooltip_order){
// if data are grouped, we follow the order of grouped targets
var n=t.orderTargets(t.data.targets).map(function(t){return t.id});
// if it was either asc or desc we need to invert the order
// returned by orderTargets
return(t.isOrderAsc()||t.isOrderDesc())&&(n=n.reverse()),function(t,e){return n.indexOf(t.id)-n.indexOf(e.id)}}
// if data are not grouped or if an order is specified
// for the tooltip values we sort them by their values
var i=e.tooltip_order;void 0===i&&(i=e.data_order);var r=function t(e){return e?e.value:null};
// if data are not grouped, we sort them by their value
if(l(i)&&"asc"===i.toLowerCase())return function(t,e){return r(t)-r(e)};if(l(i)&&"desc"===i.toLowerCase())return function(t,e){return r(e)-r(t)};if(d(i)){
// if the function is from data_order we need
// to wrap the returned function in order to format
// the sorted value to the expected format
var a=i;return void 0===e.tooltip_order&&(a=function t(e,n){return i(e?{id:e.id,values:[e]}:null,n?{id:n.id,values:[n]}:null)}),a}return c(i)?function(t,e){return i.indexOf(t.id)-i.indexOf(e.id)}:void 0},S.getTooltipContent=function(t,e,n,i){var r=this,a=r.config,o=a.tooltip_format_title||e,s=a.tooltip_format_name||function(t){return t},u=a.tooltip_format_value||n,c,l,h,d,f,g,p=this.getTooltipSortFunction();for(p&&t.sort(p),l=0;l<t.length;l++)if(t[l]&&(t[l].value||0===t[l].value)&&(c||(h=x(o?o(t[l].x):t[l].x),c="<table class='"+r.CLASS.tooltip+"'>"+(h||0===h?"<tr><th colspan='2'>"+h+"</th></tr>":"")),void 0!==(d=x(u(t[l].value,t[l].ratio,t[l].id,t[l].index,t))))){
// Skip elements when their name is set to null
if(null===t[l].name)continue;f=x(s(t[l].name,t[l].ratio,t[l].id,t[l].index)),g=r.levelColor?r.levelColor(t[l].value):i(t[l].id),c+="<tr class='"+r.CLASS.tooltipName+"-"+r.getTargetSelectorSuffix(t[l].id)+"'>",c+="<td class='name'><span style='background-color:"+g+"'></span>"+f+"</td>",c+="<td class='value'>"+d+"</td>",c+="</tr>"}return c+"</table>"},S.tooltipPosition=function(t,e,n,i){var r=this,a=r.config,o=r.d3,s,u,c,l,h,d=r.hasArcType(),f=o.mouse(i);
// Determin tooltip position
return d?(u=(r.width-(r.isLegendRight?r.getLegendWidth():0))/2+f[0],l=(r.hasType("gauge")?r.height:r.height/2)+f[1]+20):(s=r.getSvgLeft(!0),l=a.axis_rotated?(c=(u=s+f[0]+100)+e,h=r.currentWidth-r.getCurrentPaddingRight(),r.x(t[0].x)+20):(c=(u=s+r.getCurrentPaddingLeft(!0)+r.x(t[0].x)+20)+e,h=s+r.currentWidth-r.getCurrentPaddingRight(),f[1]+15),h<c&&(
// 20 is needed for Firefox to keep tooltip width
u-=c-h+20),l+n>r.currentHeight&&(l-=n+30)),l<0&&(l=0),{top:l,left:u}},S.showTooltip=function(t,e){var n=this,i=n.config,r,a,o,s=n.hasArcType(),u=t.filter(function(t){return t&&C(t.value)}),c=i.tooltip_position||S.tooltipPosition;0!==u.length&&i.tooltip_show&&(n.tooltip.html(i.tooltip_contents.call(n,t,n.axis.getXAxisTickFormat(),n.getYFormat(s),n.color)).style("display","block"),
// Get tooltip dimensions
r=n.tooltip.property("offsetWidth"),a=n.tooltip.property("offsetHeight"),o=c.call(this,u,r,a,e),
// Set tooltip
n.tooltip.style("top",o.top+"px").style("left",o.left+"px"))},S.hideTooltip=function(){this.tooltip.style("display","none")},S.setTargetType=function(t,e){var n=this,i=n.config;n.mapToTargetIds(t).forEach(function(t){n.withoutFadeIn[t]=e===i.data_types[t],i.data_types[t]=e}),t||(i.data_type=e)},S.hasType=function(n,t){var e=this,i=e.config.data_types,r=!1;return(t=t||e.data.targets)&&t.length?t.forEach(function(t){var e=i[t.id];(e&&0<=e.indexOf(n)||!e&&"line"===n)&&(r=!0)}):Object.keys(i).length?Object.keys(i).forEach(function(t){i[t]===n&&(r=!0)}):r=e.config.data_type===n,r},S.hasArcType=function(t){return this.hasType("pie",t)||this.hasType("donut",t)||this.hasType("gauge",t)},S.isLineType=function(t){var e=this.config,n=l(t)?t:t.id;return!e.data_types[n]||0<=["line","spline","area","area-spline","step","area-step"].indexOf(e.data_types[n])},S.isStepType=function(t){var e=l(t)?t:t.id;return 0<=["step","area-step"].indexOf(this.config.data_types[e])},S.isSplineType=function(t){var e=l(t)?t:t.id;return 0<=["spline","area-spline"].indexOf(this.config.data_types[e])},S.isAreaType=function(t){var e=l(t)?t:t.id;return 0<=["area","area-spline","area-step"].indexOf(this.config.data_types[e])},S.isBarType=function(t){var e=l(t)?t:t.id;return"bar"===this.config.data_types[e]},S.isScatterType=function(t){var e=l(t)?t:t.id;return"scatter"===this.config.data_types[e]},S.isPieType=function(t){var e=l(t)?t:t.id;return"pie"===this.config.data_types[e]},S.isGaugeType=function(t){var e=l(t)?t:t.id;return"gauge"===this.config.data_types[e]},S.isDonutType=function(t){var e=l(t)?t:t.id;return"donut"===this.config.data_types[e]},S.isArcType=function(t){return this.isPieType(t)||this.isDonutType(t)||this.isGaugeType(t)},S.lineData=function(t){return this.isLineType(t)?[t]:[]},S.arcData=function(t){return this.isArcType(t.data)?[t]:[]},
/* not used
 function scatterData(d) {
 return isScatterType(d) ? d.values : [];
 }
 */
S.barData=function(t){return this.isBarType(t)?t.values:[]},S.lineOrScatterData=function(t){return this.isLineType(t)||this.isScatterType(t)?t.values:[]},S.barOrLineData=function(t){return this.isBarType(t)||this.isLineType(t)?t.values:[]},S.isInterpolationType=function(t){return 0<=["linear","linear-closed","basis","basis-open","basis-closed","bundle","cardinal","cardinal-open","cardinal-closed","monotone"].indexOf(t)},S.isSafari=function(){var t=window.navigator.userAgent;return 0<=t.indexOf("Safari")&&t.indexOf("Chrome")<0},S.isChrome=function(){var t;return 0<=window.navigator.userAgent.indexOf("Chrome")},S.initZoom=function(){var n=this,e=n.d3,i=n.config,r;n.zoom=e.behavior.zoom().on("zoomstart",function(){r=e.event.sourceEvent,n.zoom.altDomain=e.event.sourceEvent.altKey?n.x.orgDomain():null,i.zoom_onzoomstart.call(n.api,e.event.sourceEvent)}).on("zoom",function(){n.redrawForZoom.call(n)}).on("zoomend",function(){var t=e.event.sourceEvent;
// if click, do nothing. otherwise, click interaction will be canceled.
t&&r.clientX===t.clientX&&r.clientY===t.clientY||(n.redrawEventRect(),n.updateZoom(),i.zoom_onzoomend.call(n.api,n.x.orgDomain()))}),n.zoom.scale=function(t){return i.axis_rotated?this.y(t):this.x(t)},n.zoom.orgScaleExtent=function(){var t=i.zoom_extent?i.zoom_extent:[1,10];return[t[0],Math.max(n.getMaxDataCount()/t[1],t[1])]},n.zoom.updateScaleExtent=function(){var t=O(n.x.orgDomain())/O(n.getZoomDomain()),e=this.orgScaleExtent();return this.scaleExtent([e[0]*t,e[1]*t]),this}},S.getZoomDomain=function(){var t=this,e=t.config,n=t.d3,i,r;return[n.min([t.orgXDomain[0],e.zoom_x_min]),n.max([t.orgXDomain[1],e.zoom_x_max])]},S.updateZoom=function(){var t=this,e=t.config.zoom_enabled?t.zoom:function(){};t.main.select("."+X.zoomRect).call(e).on("dblclick.zoom",null),t.main.selectAll("."+X.eventRect).call(e).on("dblclick.zoom",null)},S.redrawForZoom=function(){var t=this,e=t.d3,n=t.config,i=t.zoom,r=t.x;if(n.zoom_enabled&&0!==t.filterTargetsToShow(t.data.targets).length){if("mousemove"===e.event.sourceEvent.type&&i.altDomain)return r.domain(i.altDomain),void i.scale(r).updateScaleExtent();t.isCategorized()&&r.orgDomain()[0]===t.orgXDomain[0]&&r.domain([t.orgXDomain[0]-1e-10,r.orgDomain()[1]]),t.redraw({withTransition:!1,withY:n.zoom_rescale,withSubchart:!1,withEventRect:!1,withDimension:!1}),"mousemove"===e.event.sourceEvent.type&&(t.cancelClick=!0),n.zoom_onzoom.call(t.api,r.orgDomain())}},m});// Adjust this object to adjust the grade categories to plot and manipulate
var syllabus={Book_problems:10,Problem_sets:15,Lab:20,Midterms:45,Final:10},categories=Object.keys(syllabus),theData=[],groups=[];
// List grade categories
addGroup("Total possible",1);
//Plotting parameters
var chart=c3.generate({bindto:"#chartContainer",data:{json:theData,keys:{value:categories},type:"bar",groups:[categories],order:function(t,e){return t.id<e.id}},grid:{lines:{front:!1},y:{front:!0,lines:[{value:0},{value:60,class:"dotted-line",text:"D"},{value:70,class:"dotted-line",text:"C"},{value:80,class:"dotted-line",text:"B"},{value:90,class:"dotted-line",text:"A"},{value:100}]}},axis:{x:{type:"category",categories:groups},y:{max:100,min:0,padding:{top:15,bottom:0}}},tooltip:{order:function(t,e){return t.id>e.id}}});
// Button to add hypothetical grade breakdowns
hypoCount=0,d3.select("#adder").on("click",function(){addGroup("Hypothetical "+ ++hypoCount,.75),chart.load({json:theData,keys:{value:categories}}),addSliders(hypoCount),categories.forEach(function(t){updateComponent(hypoCount,t,theData[hypoCount][t])})}),d3.select("#remover").on("click",function(){1<theData.length&&(removeGroup(),chart.load({json:theData,keys:{value:categories}}),removeSliders(hypoCount--))});